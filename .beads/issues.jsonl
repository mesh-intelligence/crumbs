{"id":"generation-2026-02-13-07-56-44-01h","title":"Validate self-hosting workflow end-to-end (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (all flows, S1-S7)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (validation scenarios)\n- scripts/do-work.sh (agent workflow script)\n- scripts/make-work.sh (issue creation script)\n- .claude/rules/cupboard-workflow.md (agent instructions)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc003_self_hosting_test.go (create) — self-hosting validation\n\n## Requirements\n- Test S1: cupboard ready returns available tasks as JSON\n- Test S2: cupboard create creates task with type, title, description\n- Test S3: cupboard update transitions state to in_progress\n- Test S4: cupboard close marks task as closed\n- Test S5: cupboard list --json returns all crumbs\n- Test S6: do-work.sh completes full cycle (pick, worktree, close)\n- Test S7: make-work.sh creates issues and commits JSONL\n- Use real scripts in test (not mocked)\n- Verify JSONL files committed to git\n- Verify worktree cleanup\n\n## Design Decisions\n- Integration test runs real scripts as subprocess\n- Test uses temp git repository for isolation\n- Test validates both script exit codes and side effects\n- Agent invocation in do-work.sh can be no-op for test\n\n## Acceptance Criteria\n- [ ] All S1-S7 success criteria validated\n- [ ] do-work.sh picks task, creates worktree, closes task\n- [ ] make-work.sh creates issues from JSON file\n- [ ] JSONL files committed to git after operations\n- [ ] Worktrees cleaned up after do-work.sh\n- [ ] Tests pass with go test ./tests/integration/... -run TestSelfHosting\n- [ ] Tests use temp directories and clean up","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.844324-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:02:08.25734-05:00","closed_at":"2026-02-13T01:02:08.25734-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-01h","depends_on_id":"generation-2026-02-13-07-56-44-rh1","type":"blocks","created_at":"2026-02-12T22:15:48.795655-05:00","created_by":"petardjukic"}],"comments":[{"id":106,"issue_id":"generation-2026-02-13-07-56-44-01h","author":"petardjukic","text":"duration: 6m35s | tokens: in=91 out=17362 | loc: +351 -1 files=2","created_at":"2026-02-13T06:02:08Z"}]}
{"id":"generation-2026-02-13-07-56-44-06z","title":"Add integration tests for configuration loading (rel01.1-uc003)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test default config: cupboard uses CWD/.crumbs and CWD/.crumbs-db\n- Test --config-dir flag overrides default\n- Test --data-dir flag overrides default\n- Test env var overrides (CRUMBS_CONFIG_DIR, CRUMBS_DATA_DIR)\n- Test config.yaml: data_dir setting read from config file\n- Test precedence: flag \u003e env \u003e config.yaml \u003e default\n\n## Design Decisions\n- Use t.Setenv for environment variable tests\n- Create config.yaml in temp dirs for config file tests\n\n## Acceptance Criteria\n- [ ] Default paths tested\n- [ ] Flag overrides tested\n- [ ] Env var overrides tested\n- [ ] Config file overrides tested\n- [ ] Precedence order verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.468098-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:30:19.176663-05:00","closed_at":"2026-02-13T18:30:19.176663-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-06z","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.339733-05:00","created_by":"petardjukic"}],"comments":[{"id":61,"issue_id":"generation-2026-02-13-07-56-44-06z","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":99,"issue_id":"generation-2026-02-13-07-56-44-06z","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:27:33Z\",\"duration_s\":166,\"tokens\":{\"input\":18,\"output\":8336},\"loc_before\":{\"production\":6101,\"test\":10737},\"loc_after\":{\"production\":6101,\"test\":11101},\"diff\":{\"files\":2,\"insertions\":365,\"deletions\":1}}","created_at":"2026-02-13T23:30:19Z"}]}
{"id":"generation-2026-02-13-07-56-44-0bz","title":"Define Cupboard and Table interfaces in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1 Config, R2 Cupboard interface, R2 Table interface)\n- docs/ARCHITECTURE.md § Main Interfaces (Cupboard, Table contracts)\n- pkg/types/errors.go (from task 0)\n- pkg/types/constants.go (from task 0)\n\n## Files to Create/Modify\n- pkg/types/config.go (create) - Config struct with Backend and DataDir fields, Validate method\n- pkg/types/cupboard.go (create) - Cupboard interface with GetTable, Attach, Detach\n- pkg/types/table.go (create) - Table interface with Get, Set, Delete, Fetch\n\n## Requirements\n- Config struct per prd001 R1: Backend (string), DataDir (string)\n- Config.Validate() returns ErrBackendEmpty if Backend is empty, ErrBackendUnknown if not \"sqlite\", returns nil for valid config\n- Cupboard interface per prd001 R2: Attach(config Config) error, Detach() error, GetTable(name string) (Table, error)\n- Table interface per prd001 R2: Get(id string) (any, error), Set(id string, data any) (string, error), Delete(id string) error, Fetch(filter map[string]any) ([]any, error)\n- Set returns the actual ID (generated UUID v7 for new entities, or the provided ID)\n- Add SPDX copyright headers\n\n## Design Decisions\n- Table uses any for data parameter to support all entity types uniformly\n- Filter uses map[string]any per prd001 R2\n- Config validation is a method on the struct, not a standalone function\n\n## Acceptance Criteria\n- [ ] Config struct with Backend and DataDir fields\n- [ ] Config.Validate() returns correct errors\n- [ ] Cupboard interface defined with Attach, Detach, GetTable\n- [ ] Table interface defined with Get, Set, Delete, Fetch\n- [ ] Copyright headers present\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.397567-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:05:56.248741-05:00","closed_at":"2026-02-13T08:05:56.248741-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-0bz","depends_on_id":"generation-2026-02-13-07-56-44-0g8","type":"blocks","created_at":"2026-02-13T08:02:21.607186-05:00","created_by":"petardjukic"}],"comments":[{"id":2,"issue_id":"generation-2026-02-13-07-56-44-0bz","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":12,"issue_id":"generation-2026-02-13-07-56-44-0bz","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:04:04Z\",\"duration_s\":112,\"tokens\":{\"input\":18,\"output\":5963},\"loc_before\":{\"production\":129,\"test\":0},\"loc_after\":{\"production\":220,\"test\":0},\"diff\":{\"files\":4,\"insertions\":92,\"deletions\":1}}","created_at":"2026-02-13T13:05:56Z"}]}
{"id":"generation-2026-02-13-07-56-44-0c8","title":"Implement issue-tracking CLI create command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.344972-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:13:12.052468-05:00","closed_at":"2026-02-12T23:13:12.052468-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-0c8","depends_on_id":"generation-2026-02-13-07-56-44-10x","type":"blocks","created_at":"2026-02-12T14:57:08.283924-05:00","created_by":"petardjukic"}],"comments":[{"id":107,"issue_id":"generation-2026-02-13-07-56-44-0c8","author":"petardjukic","text":"duration: 3m45s | tokens: in=80 out=8906 | loc: +0 -0 files=0","created_at":"2026-02-13T04:13:11Z"}]}
{"id":"generation-2026-02-13-07-56-44-0g8","title":"Define error sentinels and constants in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 error types, R4 standard table names)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R2 state constants)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (trail states)\n- docs/specs/product-requirements/prd007-links-interface.yaml (link types)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (stash types)\n- docs/ARCHITECTURE.md § System Overview (entity lifecycle, relationship semantics)\n\n## Files to Create/Modify\n- pkg/types/errors.go (create) - All sentinel errors from prd001 R3 and entity-specific errors\n- pkg/types/constants.go (create) - Standard table names, crumb states, trail states, link types, stash types, property value types\n\n## Requirements\n- Define all sentinel errors as package-level vars using errors.New per prd001-cupboard-core R3: ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound, ErrNotFound, ErrInvalidID, ErrInvalidData, ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, ErrInvalidStashType, ErrLockHeld, ErrNotLockHolder, ErrInvalidHolder, ErrAlreadyInTrail, ErrNotInTrail, ErrSchemaNotFound, ErrInvalidContent, ErrInvalidFilter, ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid\n- Define string constants for standard table names per prd001 R4: crumbs, trails, properties, metadata, links, stashes\n- Define string constants for crumb states per prd003 R2: draft, pending, ready, taken, pebble, dust\n- Define string constants for trail states per prd006: draft, pending, active, completed, abandoned\n- Define string constants for link types per prd007: belongs_to, child_of, branches_from, scoped_to\n- Define string constants for stash types per prd008: resource, artifact, context, counter, lock\n- Define string constants for property value types per prd004: categorical, text, integer, boolean, timestamp, list\n- Add SPDX copyright headers to all files\n\n## Design Decisions\n- Use errors.New for all sentinels (enables errors.Is matching)\n- Group constants by domain (table names, crumb states, trail states, etc.)\n- No validation functions in this task; just the raw constants and errors\n\n## Acceptance Criteria\n- [ ] All sentinel errors from prd001 R3 defined\n- [ ] All standard table names from prd001 R4 defined\n- [ ] All crumb states from prd003 R2 defined\n- [ ] All trail states, link types, stash types, property value types defined\n- [ ] Copyright headers present\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.254782-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:04:03.593021-05:00","closed_at":"2026-02-13T08:04:03.593021-05:00","close_reason":"Closed","comments":[{"id":1,"issue_id":"generation-2026-02-13-07-56-44-0g8","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:22Z"},{"id":11,"issue_id":"generation-2026-02-13-07-56-44-0g8","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:02:24Z\",\"duration_s\":99,\"tokens\":{\"input\":13,\"output\":4058},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":129,\"test\":0},\"diff\":{\"files\":3,\"insertions\":125,\"deletions\":10}}","created_at":"2026-02-13T13:04:03Z"}]}
{"id":"generation-2026-02-13-07-56-44-106","title":"Implement CLI root command, version, and init with cobra","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R1 root command, R2 version, R3 init, R10 exit codes, R11 output modes)\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R4 directory resolution, config.yaml)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (build and version flow)\n- docs/engineering/eng03-cupboard-cli.md (CLI usage guide)\n- cmd/cupboard/main.go (existing stub from task 0)\n- pkg/crumbs/version.go (existing version constant)\n\n## Files to Create/Modify\n- cmd/cupboard/main.go (modify) - Wire cobra root command\n- cmd/cupboard/root.go (create) - Root command with global flags (--config-dir, --data-dir, --json)\n- cmd/cupboard/version.go (create) - Version command printing version string\n- cmd/cupboard/init_cmd.go (create) - Init command creating config directory and config.yaml\n- pkg/config/loader.go (create) - Configuration loading: resolve config dir, load config.yaml, resolve data dir\n- pkg/config/defaults.go (create) - Default config values, directory names\n\n## Requirements\n- Root command: \"cupboard\" with description, PersistentPreRun that resolves config and data directories per prd010 precedence: flag \u003e env (CRUMBS_CONFIG_DIR, CRUMBS_DATA_DIR) \u003e defaults (.crumbs, .crumbs-db in CWD).\n- Version command: prints \"cupboard \u003cversion\u003e\" and exits 0.\n- Init command: creates .crumbs/ directory and config.yaml with defaults (backend: sqlite, sync_strategy: immediate). Idempotent (no error if already exists).\n- Config loader per prd010: ResolveConfigDir(flagValue string) string, LoadConfig(configDir string) (Config, error), ResolveDataDir(flagValue string, config Config) string.\n- Exit codes per prd009 R10: 0 success, 1 user error, 2 system error.\n- Global --json flag for JSON output mode.\n- Add SPDX copyright headers\n\n## Design Decisions\n- Use cobra for CLI framework, viper for config loading per go-style.md\n- Config.yaml uses YAML format per prd010\n- PersistentPreRun loads config so all subcommands have access\n- Store resolved config in cobra command context or package-level var\n\n## Acceptance Criteria\n- [ ] cupboard version prints version and exits 0\n- [ ] cupboard init creates .crumbs/config.yaml\n- [ ] Config resolution follows precedence: flag \u003e env \u003e default\n- [ ] Exit codes 0/1/2 per prd009 R10\n- [ ] --json flag available on all commands\n- [ ] Copyright headers present\n- [ ] go build ./cmd/cupboard succeeds\n- [ ] cupboard version runs successfully","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:21.37613-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:30:10.385045-05:00","closed_at":"2026-02-13T08:30:10.385045-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-106","depends_on_id":"generation-2026-02-13-07-56-44-yj0","type":"blocks","created_at":"2026-02-13T08:02:22.291617-05:00","created_by":"petardjukic"}],"comments":[{"id":9,"issue_id":"generation-2026-02-13-07-56-44-106","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":19,"issue_id":"generation-2026-02-13-07-56-44-106","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:25:19Z\",\"duration_s\":290,\"tokens\":{\"input\":48,\"output\":14117},\"loc_before\":{\"production\":2435,\"test\":0},\"loc_after\":{\"production\":2709,\"test\":0},\"diff\":{\"files\":10,\"insertions\":382,\"deletions\":10}}","created_at":"2026-02-13T13:30:10Z"}]}
{"id":"generation-2026-02-13-07-56-44-10x","title":"Add property enforcement CLI validation (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: set categories, list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001-property-enforcement as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.942087-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:09:25.823651-05:00","closed_at":"2026-02-12T23:09:25.823651-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-10x","depends_on_id":"generation-2026-02-13-07-56-44-90v","type":"blocks","created_at":"2026-02-12T14:57:07.981662-05:00","created_by":"petardjukic"}],"comments":[{"id":108,"issue_id":"generation-2026-02-13-07-56-44-10x","author":"petardjukic","text":"duration: 5m13s | tokens: in=62 out=13572 | loc: +196 -91 files=3","created_at":"2026-02-13T04:09:25Z"}]}
{"id":"generation-2026-02-13-07-56-44-14s","title":"Add integration tests for flat self-hosting (rel01.1-uc005)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test: create crumbs without trails (flat mode)\n- Test: manage crumbs through state transitions\n- Test: list and filter crumbs\n- Test: close crumbs\n- Test: verify no trails or links created\n\n## Design Decisions\n- Use issue-tracking CLI commands only\n- Verify absence of trails and links\n\n## Acceptance Criteria\n- [ ] Flat workflow (no trails) works end-to-end\n- [ ] No trails or links created\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:42.282048-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:42.282048-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-14s","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.656976-05:00","created_by":"petardjukic"}],"comments":[{"id":74,"issue_id":"generation-2026-02-13-07-56-44-14s","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:50Z"}]}
{"id":"generation-2026-02-13-07-56-44-16k","title":"Implement issue-tracking CLI create command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.1 create command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1 create, S1-S2)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 1-3)\n- cmd/cupboard/set.go (generic set command for reference)\n- cmd/cupboard/helpers.go (attachBackend helper)\n- pkg/types/crumb.go (Crumb struct, SetProperty)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — issue-tracking create command\n- cmd/cupboard/root.go (modify) — register create command\n\n## Requirements\n- Implement `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n- Create a crumb with properties set: type, description, owner, labels\n- Set initial state to draft\n- Output created crumb ID (or full JSON with --json)\n- Validate --type against known categories (task, epic, bug, chore)\n- Exit 1 if --title is missing\n\n## Design Decisions\n- create is a convenience wrapper around set + property operations\n- Uses attachBackend helper from existing commands\n- Sets properties via Crumb.SetProperty before Table.Set\n\n## Acceptance Criteria\n- [ ] `cupboard create --type task --title \"Test\"` creates crumb with type=task, exit 0\n- [ ] `cupboard create` without --title exits 1 with error\n- [ ] `cupboard create --type task --title \"T\" --json` outputs JSON with crumb details\n- [ ] Created crumb has all built-in properties initialized\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:33.055686-05:00","created_by":"petardjukic","updated_at":"2026-02-12T19:14:37.7473-05:00","closed_at":"2026-02-12T19:14:37.7473-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-16k","depends_on_id":"generation-2026-02-13-07-56-44-40r","type":"blocks","created_at":"2026-02-12T17:46:33.552069-05:00","created_by":"petardjukic"}],"comments":[{"id":109,"issue_id":"generation-2026-02-13-07-56-44-16k","author":"petardjukic","text":"duration: 3m43s | tokens: in=75 out=10124 | loc: +177 -1 files=4","created_at":"2026-02-13T00:14:37Z"}]}
{"id":"generation-2026-02-13-07-56-44-1e2","title":"Implement MetadataTable for SQLite backend","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata entity, schemas, cascade)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (Table interface contract)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (JSONL sync)\n- internal/sqlite/table_crumb.go (reference implementation)\n- internal/sqlite/schema.go (metadata table schema)\n- pkg/types/metadata.go (Metadata entity struct)\n\n## Files to Create/Modify\n- internal/sqlite/table_metadata.go (create) — MetadataTable implementation\n- internal/sqlite/backend.go (modify) — Wire MetadataTable in GetTable map\n\n## Requirements\n- Implement MetadataTable satisfying types.Table (Get, Set, Delete, Fetch)\n- Get: retrieve metadata entry by ID\n- Set: create (UUID v7) or update metadata entry, sync to metadata.jsonl\n- Delete: remove metadata entry\n- Fetch: filter by crumb_id, table_name, property_id\n- Wire into Backend.tables map\n\n## Design Decisions\n- Append-only convention: Set always creates new entries (no updates by convention, but the Table interface allows it)\n- Cascade delete handled by CrumbTable.Delete (when crumb is deleted, all its metadata is deleted)\n\n## Acceptance Criteria\n- [ ] MetadataTable implements types.Table\n- [ ] Get, Set, Delete, Fetch work correctly\n- [ ] Backend.GetTable(\"metadata\") returns MetadataTable\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:33.575997-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:54:30.009005-05:00","closed_at":"2026-02-13T08:54:30.009005-05:00","close_reason":"Closed","comments":[{"id":23,"issue_id":"generation-2026-02-13-07-56-44-1e2","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":33,"issue_id":"generation-2026-02-13-07-56-44-1e2","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:51:32Z\",\"duration_s\":177,\"tokens\":{\"input\":24,\"output\":9737},\"loc_before\":{\"production\":4305,\"test\":0},\"loc_after\":{\"production\":4665,\"test\":0},\"diff\":{\"files\":4,\"insertions\":361,\"deletions\":63}}","created_at":"2026-02-13T13:54:29Z"}]}
{"id":"generation-2026-02-13-07-56-44-1p5","title":"Define Trail, Link, Property, Category, Metadata, Stash entities in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd006-trails-interface.yaml (R1 Trail struct, state transitions)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R1 Link struct)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R1 Property struct, R2 Category struct, value types)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1 Metadata struct)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R1 Stash struct)\n- docs/ARCHITECTURE.md § Main Interfaces (entity types)\n- pkg/types/constants.go (state and type constants from task 0)\n- pkg/types/errors.go (errors from task 0)\n\n## Files to Create/Modify\n- pkg/types/trail.go (create) - Trail struct with Complete/Abandon methods\n- pkg/types/link.go (create) - Link struct\n- pkg/types/property.go (create) - Property struct\n- pkg/types/category.go (create) - Category struct\n- pkg/types/metadata.go (create) - Metadata struct\n- pkg/types/stash.go (create) - Stash struct with value/counter/lock methods\n\n## Requirements\n- Trail struct per prd006 R1: TrailID, State, CreatedAt, CompletedAt (*time.Time nullable). Trail.Complete() error: only from active state, sets completed + CompletedAt. Trail.Abandon() error: only from active state, sets abandoned + CompletedAt.\n- Link struct per prd007 R1: LinkID, LinkType, FromID, ToID, CreatedAt. ValidLinkType(t string) bool helper.\n- Property struct per prd004 R1: PropertyID, Name, Description, ValueType, CreatedAt. ValidValueType(t string) bool helper.\n- Category struct per prd004 R2: CategoryID, PropertyID, Name, Ordinal.\n- Metadata struct per prd005 R1: MetadataID, TableName, CrumbID, PropertyID (*string nullable), Content, CreatedAt.\n- Stash struct per prd008 R1: StashID, Name, StashType, Value (any), Version (int), CreatedAt, UpdatedAt. Stash.SetValue, Stash.GetValue, Stash.Increment (counter type), Stash.Acquire/Release (lock type) methods.\n- Add SPDX copyright headers to all files\n\n## Design Decisions\n- Trail CompletedAt is a pointer to time.Time (nil when not completed)\n- Metadata PropertyID is a pointer to string (nil when not scoped to a property)\n- Stash.Value is any (JSON-serializable); type-specific methods validate StashType before operating\n- Entity methods modify structs in memory; persistence via Table.Set (per ARCHITECTURE ORM pattern)\n\n## Acceptance Criteria\n- [ ] All six entity structs defined with correct fields\n- [ ] Trail Complete/Abandon methods validate state\n- [ ] Stash methods validate stash type\n- [ ] Link and Property type validation helpers present\n- [ ] Copyright headers present\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.669159-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:09:07.42705-05:00","closed_at":"2026-02-13T08:09:07.42705-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-1p5","depends_on_id":"generation-2026-02-13-07-56-44-0g8","type":"blocks","created_at":"2026-02-13T08:02:21.802675-05:00","created_by":"petardjukic"}],"comments":[{"id":4,"issue_id":"generation-2026-02-13-07-56-44-1p5","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":14,"issue_id":"generation-2026-02-13-07-56-44-1p5","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:07:06Z\",\"duration_s\":121,\"tokens\":{\"input\":13,\"output\":7837},\"loc_before\":{\"production\":367,\"test\":0},\"loc_after\":{\"production\":688,\"test\":0},\"diff\":{\"files\":7,\"insertions\":322,\"deletions\":1}}","created_at":"2026-02-13T13:09:07Z"}]}
{"id":"generation-2026-02-13-07-56-44-21h","title":"Implement generic table CLI commands (get, set, list, delete)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4 generic table commands, R11 output modes)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (generic table CLI flow)\n- docs/engineering/eng03-cupboard-cli.md § Generic Table Operations\n- cmd/cupboard/root.go (root command from task 8)\n- internal/sqlite/backend.go (Backend from task 7)\n- internal/sqlite/table_crumb.go (CrumbTable from task 6)\n\n## Files to Create/Modify\n- cmd/cupboard/table_get.go (create) - \"cupboard get \u003ctable\u003e \u003cid\u003e\" command\n- cmd/cupboard/table_set.go (create) - \"cupboard set \u003ctable\u003e \u003cid\u003e \u003cjson\u003e\" command\n- cmd/cupboard/table_list.go (create) - \"cupboard list \u003ctable\u003e [key=value...]\" command\n- cmd/cupboard/table_delete.go (create) - \"cupboard delete \u003ctable\u003e \u003cid\u003e\" command\n- cmd/cupboard/format.go (create) - Output formatting helpers (JSON pretty-print, human-readable table)\n\n## Requirements\n- get command per prd009 R4: takes table name and entity ID, calls Table.Get, prints result in human-readable or JSON format.\n- set command per prd009 R4: takes table name, ID (empty string for new), and JSON data on stdin or as argument. Calls Table.Set. Prints created/updated entity.\n- list command per prd009 R4: takes table name and optional key=value filter pairs. Calls Table.Fetch. Prints results as table or JSON array.\n- delete command per prd009 R4: takes table name and entity ID. Calls Table.Delete. Prints confirmation.\n- format.go: FormatJSON(data any) string (pretty-print with 2-space indent), FormatTable(headers []string, rows [][]string) string (tabwriter), FormatEntity(entity any, jsonMode bool) string.\n- Commands must open Cupboard (Attach), perform operation, then Detach.\n- Error handling: exit 1 for user errors (not found, invalid args), exit 2 for system errors.\n\n## Design Decisions\n- Each command creates a Backend, Attaches, performs operation, Detaches\n- Use a shared helper function for the Attach/operation/Detach lifecycle\n- Filter key=value pairs parsed from positional args in list command\n- JSON output uses encoding/json with MarshalIndent\n\n## Acceptance Criteria\n- [ ] cupboard get crumbs \u003cid\u003e retrieves and prints a crumb\n- [ ] cupboard set crumbs \"\" '{...}' creates a new crumb\n- [ ] cupboard list crumbs prints all crumbs\n- [ ] cupboard delete crumbs \u003cid\u003e removes a crumb\n- [ ] --json flag produces JSON output\n- [ ] Correct exit codes for errors\n- [ ] Copyright headers present\n- [ ] go build ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:21.509309-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:35:59.713626-05:00","closed_at":"2026-02-13T08:35:59.713626-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-21h","depends_on_id":"generation-2026-02-13-07-56-44-106","type":"blocks","created_at":"2026-02-13T08:02:22.527238-05:00","created_by":"petardjukic"}],"comments":[{"id":10,"issue_id":"generation-2026-02-13-07-56-44-21h","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":20,"issue_id":"generation-2026-02-13-07-56-44-21h","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:30:11Z\",\"duration_s\":348,\"tokens\":{\"input\":31,\"output\":11766},\"loc_before\":{\"production\":2709,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":8,\"insertions\":397,\"deletions\":1}}","created_at":"2026-02-13T13:35:59Z"}]}
{"id":"generation-2026-02-13-07-56-44-26r","title":"Add integration tests for property enforcement (rel02.0-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test: fresh cupboard has 5 built-in properties (priority, type, description, owner, labels)\n- Test: creating a crumb auto-initializes all properties with defaults\n- Test: defining a new property backfills default value to all existing crumbs\n- Test: property values persist through JSONL roundtrip\n- Test: categorical properties have correct categories\n\n## Design Decisions\n- Use generic table CLI to inspect properties and crumb_properties\n- Create crumbs before and after property definition to test both paths\n\n## Acceptance Criteria\n- [ ] Built-in properties present after init\n- [ ] Auto-initialization on crumb creation verified\n- [ ] Backfill on property definition verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.79319-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:44:22.604794-05:00","closed_at":"2026-02-13T18:44:22.604794-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-26r","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.530896-05:00","created_by":"petardjukic"}],"comments":[{"id":63,"issue_id":"generation-2026-02-13-07-56-44-26r","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"},{"id":101,"issue_id":"generation-2026-02-13-07-56-44-26r","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:35:36Z\",\"duration_s\":525,\"tokens\":{\"input\":12684,\"output\":20431},\"loc_before\":{\"production\":6101,\"test\":11537},\"loc_after\":{\"production\":6108,\"test\":12356},\"diff\":{\"files\":3,\"insertions\":828,\"deletions\":2}}","created_at":"2026-02-13T23:44:22Z"}]}
{"id":"generation-2026-02-13-07-56-44-2ej","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 2 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create -\u003e list draft -\u003e claim (taken) -\u003e close (pebble) (S8)\n  - Make-work cycle: list existing -\u003e create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n- Reuse runCupboard helper from generic table CLI tests if in same package\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create -\u003e claim -\u003e close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.350884-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:07:37.954017-05:00","closed_at":"2026-02-12T15:07:37.954017-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-2ej","depends_on_id":"generation-2026-02-13-07-56-44-l8y","type":"blocks","created_at":"2026-02-12T12:08:19.225646-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-2j0","title":"Implement JSONL forward-compatibility for regeneration use case","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — ensure unknown JSON fields are tolerated during JSONL loading\n- internal/sqlite/loader_test.go (modify or create) — tests for forward compatibility\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (forward compatibility)\n- Unknown fields must be preserved through read-write cycle (round-trip fidelity)\n- Verify that generation N+1 can read generation N's JSONL files\n- Verify that adding new entity fields does not break existing JSONL files\n\n## Design Decisions\n- Use json.Decoder with DisallowUnknownFields disabled (Go default behavior)\n- For round-trip preservation, consider storing raw JSON alongside typed struct\n- If round-trip preservation is too complex, at minimum ensure unknown fields do not cause errors\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Entity structs can be loaded from JSONL with extra fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.074809-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:50:52.154559-05:00","closed_at":"2026-02-12T17:50:52.154559-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-2j0","depends_on_id":"generation-2026-02-13-07-56-44-2ys","type":"blocks","created_at":"2026-02-12T14:57:08.081754-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-2ra","title":"Implement TrailTable for SQLite backend","description":"## Required Reading\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity, states, methods)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (Table interface contract R2, R3)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (JSONL sync, write patterns)\n- internal/sqlite/table_crumb.go (reference implementation for Table pattern)\n- internal/sqlite/backend.go (table wiring in Attach)\n- internal/sqlite/schema.go (trails table schema)\n- pkg/types/trail.go (Trail entity struct and methods)\n- pkg/types/table.go (Table interface)\n\n## Files to Create/Modify\n- internal/sqlite/table_trail.go (create) — TrailTable implementation\n- internal/sqlite/backend.go (modify) — Wire TrailTable in GetTable map\n\n## Requirements\n- Implement TrailTable satisfying types.Table interface (Get, Set, Delete, Fetch)\n- Get: retrieve trail by ID from SQLite\n- Set: create (UUID v7 generation) or update trail, sync to trails.jsonl\n- Delete: remove trail and cascade (delete belongs_to links, handle crumb cleanup per prd006 R4)\n- Fetch: filter by states, limit, offset\n- Wire TrailTable into Backend.tables map in Attach method\n\n## Design Decisions\n- Follow the same pattern as CrumbTable (constructor takes *sql.DB and *SyncManager)\n- Use immediate JSONL sync after every write (same as CrumbTable)\n- Compile-time interface assertion: var _ types.Table = (*TrailTable)(nil)\n\n## Acceptance Criteria\n- [ ] TrailTable implements types.Table\n- [ ] Get retrieves trail by ID\n- [ ] Set creates new trail with UUID v7 when ID is empty\n- [ ] Set updates existing trail when ID is provided\n- [ ] Delete removes trail from SQLite and syncs JSONL\n- [ ] Fetch returns trails filtered by state\n- [ ] Backend.GetTable(\"trails\") returns TrailTable\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:33.269914-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:46:58.423769-05:00","closed_at":"2026-02-13T08:46:58.423769-05:00","close_reason":"Closed","comments":[{"id":21,"issue_id":"generation-2026-02-13-07-56-44-2ra","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:35Z"},{"id":31,"issue_id":"generation-2026-02-13-07-56-44-2ra","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:43:37Z\",\"duration_s\":200,\"tokens\":{\"input\":24,\"output\":11695},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3697,\"test\":0},\"diff\":{\"files\":4,\"insertions\":602,\"deletions\":72}}","created_at":"2026-02-13T13:46:58Z"}]}
{"id":"generation-2026-02-13-07-56-44-2ys","title":"Close stale issues and update road-map.yaml statuses","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All open beads issues (bd list --status open)\n- All in-progress beads issues (bd list --status in_progress)\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (confirms flat self-hosting is done)\n- cmd/cupboard/delete.go (confirms delete command is done)\n- cmd/cupboard/config.go (confirms config loading is done)\n- internal/paths/paths.go (confirms paths package is done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel01.1-uc005-flat-self-hosting status to done\n\n## Requirements\n- Update rel01.1-uc005-flat-self-hosting status to done in road-map.yaml (code and tests exist and pass)\n- Close stale beads issues that duplicate already-completed work:\n  - generation-...-uss (delete command) — already implemented, close it\n  - generation-...-2ej (flat self-hosting tests) — already implemented, close it\n  - generation-...-3st (config.yaml with Viper) — already implemented, close it\n  - generation-...-9yb (init --config-dir) — already implemented, close it\n  - generation-...-b17 (config loading tests) — already implemented, close it\n  - generation-...-adl (road-map update) — will be addressed by this task, close it\n- Verify rel01.1-uc003-configuration-loading and rel01.1-uc004-generic-table-cli remain correctly marked done\n- Verify no other road-map statuses need correction\n\n## Acceptance Criteria\n- [ ] road-map.yaml shows rel01.1-uc005-flat-self-hosting as done\n- [ ] All stale duplicate issues closed with explanatory comments\n- [ ] road-map.yaml statuses match actual implementation state\n- [ ] Release 01.1 shows 4/5 done (only go-install remains)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.261251-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:20:08.299294-05:00","closed_at":"2026-02-12T15:20:08.299294-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-3cu","title":"Add benchmark suite for crumbs table operations (rel02.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (F1-F9 benchmark flows, S1-S9)\n- docs/specs/test-suites/test-rel02.1-uc002-table-benchmarks.yaml (all test cases)\n- tests/integration/test_rel01_0_uc005_crumbs_table_benchmarks_test.go (existing benchmark reference if exists)\n- internal/sqlite/crumbs_table.go (implementation to benchmark)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_bench_test.go (create) — benchmark suite for crumbs table\n\n## Requirements\n- Implement Get benchmarks: BenchmarkCrumbsGet10, Get100, Get1000, Get10000\n- Implement Set benchmarks for create: BenchmarkCrumbsSetCreate10, SetCreate1000\n- Implement Set benchmarks for update: BenchmarkCrumbsSetUpdate10, SetUpdate1000\n- Implement Delete benchmarks: BenchmarkCrumbsDelete10, Delete1000\n- Implement Fetch benchmarks: BenchmarkFetchAll, FetchState, FetchProperties, FetchLimit\n- Implement property benchmarks: BenchmarkCrumbSetProperty10, SetProperty1000\n- Each benchmark seeds data before b.ResetTimer()\n- Get operations use random selection from seeded IDs\n- Set create measures empty ID path (UUID v7 generation)\n- Set update measures existing ID path\n- Delete measures cascade including properties, metadata, links\n- Fetch benchmarks measure different filter types and index usage\n- Use -benchmem flag to capture allocations\n\n## Design Decisions\n- Follow Go benchmark conventions (func Benchmark*, *testing.B, b.N iterations)\n- Seed data outside timer to measure only the operation under test\n- Use temp directories for each benchmark suite run\n- JSONL sync cost included (immediate strategy per prd002 R16.2)\n- Random selection for Get to avoid cache effects\n\n## Acceptance Criteria\n- [ ] go test -bench=BenchmarkCrumbsGet -benchmem ./internal/sqlite/... runs without error\n- [ ] go test -bench=BenchmarkCrumbsSet -benchmem ./internal/sqlite/... completes for create and update\n- [ ] go test -bench=BenchmarkCrumbsFetch -benchmem ./internal/sqlite/... completes for all filter types\n- [ ] go test -bench=. -benchmem ./internal/sqlite/... \u003e baseline.txt captures full suite\n- [ ] baseline.txt contains ns/op, B/op, allocs/op for all benchmarks\n- [ ] All benchmarks execute without error\n- [ ] Variance under 10% across multiple runs\n- [ ] Baseline file committed to repository","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.208119-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:59:00.862367-05:00","closed_at":"2026-02-12T22:59:00.862367-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-3fc","title":"Update SPECIFICATIONS.md roadmap summary for completed release 03.0","description":"## Required Reading\n- docs/SPECIFICATIONS.md (specifications document)\n- docs/road-map.yaml (updated roadmap, dependency)\n- .claude/rules/specification-format.md (specification format rule)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (update)\n\n## Requirements\nRegenerate the Roadmap Summary table in SPECIFICATIONS.md to reflect the completed release 03.0. Update the table row for release 03.0 from \"2 / 4\" use cases and \"in progress\" status to \"4 / 4\" use cases and \"done\" status.\n\n## Design Decisions\n- Follow specification-format rule for table structure\n- Only update the Roadmap Summary table; do not modify other sections unless they reference release status\n\n## Acceptance Criteria\n- [ ] Roadmap Summary table updated with release 03.0 showing 4/4 use cases done\n- [ ] Release 03.0 status changed to \"done\"\n- [ ] Table formatting preserved (markdown table with headers)\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.45279-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:25:27.037956-05:00","closed_at":"2026-02-13T01:25:27.037956-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-3fc","depends_on_id":"generation-2026-02-13-07-56-44-ukh","type":"blocks","created_at":"2026-02-13T01:09:08.318779-05:00","created_by":"petardjukic"}],"comments":[{"id":110,"issue_id":"generation-2026-02-13-07-56-44-3fc","author":"petardjukic","text":"duration: 1m14s | tokens: in=27 out=3579 | loc: +4 -4 files=2","created_at":"2026-02-13T06:25:26Z"}]}
{"id":"generation-2026-02-13-07-56-44-3st","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 3 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.089282-05:00","created_by":"petardjukic","updated_at":"2026-02-12T14:58:24.741554-05:00","closed_at":"2026-02-12T14:58:24.741554-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-3st","depends_on_id":"generation-2026-02-13-07-56-44-a31","type":"blocks","created_at":"2026-02-12T12:08:19.032953-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-3yy","title":"Add integration tests for generic table CLI (rel01.1-uc004)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create)\n\n## Requirements\n- Test `cupboard set \u003ctable\u003e \"\" \u003cjson\u003e`: creates entity on crumbs, trails, links, properties\n- Test `cupboard get \u003ctable\u003e \u003cid\u003e`: retrieves entity by ID\n- Test `cupboard list \u003ctable\u003e`: lists all entities in table\n- Test `cupboard delete \u003ctable\u003e \u003cid\u003e`: removes entity\n- Test unknown table name returns error\n- Test --json flag on all commands\n- Test invalid JSON input returns user error (exit code 1)\n\n## Design Decisions\n- Table-driven tests: one row per (table, operation) combination\n- Test both human-readable and JSON output modes\n\n## Acceptance Criteria\n- [ ] All four generic commands tested on multiple tables\n- [ ] JSON output mode verified\n- [ ] Error cases tested\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.602527-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:35:36.222707-05:00","closed_at":"2026-02-13T18:35:36.222707-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-3yy","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.435467-05:00","created_by":"petardjukic"}],"comments":[{"id":62,"issue_id":"generation-2026-02-13-07-56-44-3yy","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":100,"issue_id":"generation-2026-02-13-07-56-44-3yy","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:30:19Z\",\"duration_s\":316,\"tokens\":{\"input\":29,\"output\":15172},\"loc_before\":{\"production\":6101,\"test\":11101},\"loc_after\":{\"production\":6101,\"test\":11537},\"diff\":{\"files\":2,\"insertions\":437,\"deletions\":1}}","created_at":"2026-02-13T23:35:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-40r","title":"Add property enforcement CLI validation tests (S10-S15)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S10-S15 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 10-15)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3 generic table commands)\n- cmd/cupboard/set.go (set command patterns)\n- cmd/cupboard/list.go (list command patterns)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (modify) — add CLI-based tests\n- docs/road-map.yaml (modify) — mark rel02.0-uc001-property-enforcement as done\n\n## Requirements\n- Test creating property via CLI: cupboard set properties (S10)\n- Test listing properties via CLI: cupboard list properties (S11)\n- Test creating crumb via CLI shows auto-initialized properties (S12)\n- Test defining new property via CLI backfills existing crumbs (S13)\n- Test category operations via CLI: cupboard set categories, cupboard list categories (S14-S15)\n- Use os/exec to run cupboard binary, parse JSON output\n\n## Design Decisions\n- Extend the existing property enforcement test file with CLI test functions\n- Use --json flag for machine-readable output verification\n- Build cupboard binary once per test suite, reuse across test cases\n\n## Acceptance Criteria\n- [ ] CLI tests cover S10-S15 from the use case\n- [ ] Tests verify JSON output contains expected property values\n- [ ] Tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] road-map.yaml updated to mark rel02.0-uc001 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.918917-05:00","created_by":"petardjukic","updated_at":"2026-02-12T19:06:45.009236-05:00","closed_at":"2026-02-12T19:06:45.009236-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-40r","depends_on_id":"generation-2026-02-13-07-56-44-p57","type":"blocks","created_at":"2026-02-12T17:46:33.45282-05:00","created_by":"petardjukic"}],"comments":[{"id":111,"issue_id":"generation-2026-02-13-07-56-44-40r","author":"petardjukic","text":"duration: 6m54s | tokens: in=51 out=20146 | loc: +363 -6 files=3","created_at":"2026-02-13T00:06:44Z"}]}
{"id":"generation-2026-02-13-07-56-44-4ie","title":"Implement CrumbTable accessor (Get, Set, Delete, Fetch with JSONL)","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R2 Table interface)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R1-R4 Crumb operations, R5 filter)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R7-R10 hydration/dehydration, R15 write pattern)\n- docs/specs/use-cases/rel01.0-uc002-table-crud.yaml (Table CRUD flow)\n- docs/specs/use-cases/rel01.0-uc003-crumb-lifecycle.yaml (crumb state machine)\n- internal/sqlite/backend.go (Backend from task 4)\n- internal/sqlite/jsonl.go (JSONL persistence from task 5)\n- pkg/types/crumb.go (Crumb struct from task 2)\n\n## Files to Create/Modify\n- internal/sqlite/table_crumb.go (create) - CrumbTable implementing Table interface for crumbs\n\n## Requirements\n- CrumbTable struct holds reference to *sql.DB and SyncManager\n- Implements Table interface (Get, Set, Delete, Fetch)\n- Get(id string): query crumbs table by crumb_id, hydrate Crumb struct, load properties from crumb_properties join. Return ErrNotFound if missing, ErrInvalidID if empty.\n- Set(id string, data any): type-assert data to *Crumb. If id is empty, generate UUID v7, set State to draft, set CreatedAt/UpdatedAt to now, initialize properties with defaults. If id exists, update row. Persist to SQLite then sync JSONL. Return actual ID. Validate Name is non-empty (ErrInvalidName).\n- Delete(id string): delete from crumbs and crumb_properties. Sync JSONL. Return ErrNotFound if missing.\n- Fetch(filter map[string]any): support filter keys per prd003 R5: \"states\" ([]string), \"trail_id\" (string), \"parent_id\" (string), \"properties\" (map[string]any), \"limit\" (int), \"offset\" (int). Build SQL WHERE clause dynamically. Return []any (each element is *Crumb).\n- Hydration: SQL row → Crumb struct with time.Parse RFC3339.\n- Dehydration: Crumb struct → SQL parameters.\n\n## Design Decisions\n- UUID v7 generation using google/uuid package\n- Properties loaded via JOIN with crumb_properties table on Get\n- Fetch builds parameterized SQL to prevent injection\n- CrumbTable registered in Backend.GetTable for \"crumbs\" table name\n\n## Acceptance Criteria\n- [ ] Get returns hydrated Crumb with properties\n- [ ] Set creates new crumb with UUID v7 when id is empty\n- [ ] Set updates existing crumb when id is provided\n- [ ] Delete removes crumb and its properties\n- [ ] Fetch supports all filter keys from prd003 R5\n- [ ] JSONL sync occurs after write operations\n- [ ] Copyright header present\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:21.07015-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:20:00.335072-05:00","closed_at":"2026-02-13T08:20:00.335072-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-4ie","depends_on_id":"generation-2026-02-13-07-56-44-b8m","type":"blocks","created_at":"2026-02-13T08:02:22.094921-05:00","created_by":"petardjukic"}],"comments":[{"id":7,"issue_id":"generation-2026-02-13-07-56-44-4ie","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":17,"issue_id":"generation-2026-02-13-07-56-44-4ie","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:15:04Z\",\"duration_s\":295,\"tokens\":{\"input\":26,\"output\":12943},\"loc_before\":{\"production\":1349,\"test\":0},\"loc_after\":{\"production\":1920,\"test\":0},\"diff\":{\"files\":3,\"insertions\":574,\"deletions\":3}}","created_at":"2026-02-13T13:20:00Z"}]}
{"id":"generation-2026-02-13-07-56-44-57l","title":"Define Config struct, Cupboard interface, and Table interface in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1-R3, R7-R8)\n- docs/ARCHITECTURE.md § Main Interface, § Design Decisions\n\n## Files to Create/Modify\n- pkg/types/config.go (create) - Config struct with Backend, DataDir fields; config validation errors (ErrBackendEmpty, ErrBackendUnknown, ErrSyncStrategyUnknown, ErrBatchSizeInvalid, ErrBatchIntervalInvalid); Validate() method\n- pkg/types/cupboard.go (create) - Cupboard interface with GetTable, Attach, Detach; standard table name constants; cupboard lifecycle errors (ErrCupboardDetached, ErrAlreadyAttached, ErrTableNotFound)\n- pkg/types/table.go (create) - Table interface with Get, Set, Delete, Fetch; table operation errors (ErrNotFound, ErrInvalidID, ErrInvalidData, ErrInvalidFilter); Filter type alias\n\n## Requirements\n- Config struct with Backend (string) and DataDir (string) fields per prd001 R1\n- Config.Validate() checks Backend not empty, Backend recognized, DataDir not empty when Backend is \"sqlite\"\n- Cupboard interface: GetTable(name string) (Table, error), Attach(config Config) error, Detach() error\n- Table interface: Get(id string) (any, error), Set(id string, data any) (string, error), Delete(id string) error, Fetch(filter map[string]any) ([]any, error)\n- Standard table name constants: crumbs, trails, properties, metadata, links, stashes\n- All sentinel errors defined per prd001 R7 with errors.New\n- Filter type alias: type Filter = map[string]any\n\n## Design Decisions\n- Interfaces in pkg/types (shared contract layer); implementations in internal/\n- Config struct, not interface, for serialization compatibility\n- Sentinel errors for errors.Is compatibility\n\n## Acceptance Criteria\n- [ ] Config struct compiles with Backend and DataDir fields\n- [ ] Config.Validate() returns correct errors for empty/unknown backend, empty DataDir\n- [ ] Cupboard interface compiles with GetTable, Attach, Detach\n- [ ] Table interface compiles with Get, Set, Delete, Fetch\n- [ ] All 6 standard table name constants defined\n- [ ] All sentinel errors from prd001 R7.1-R7.3 defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.592955-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:21:38.136407-05:00","closed_at":"2026-02-12T07:21:38.136407-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-58c","title":"Implement integration tests for rel03.1-uc001-self-hosting-with-epics","description":"## Required Reading\n- docs/specs/use-cases/rel03.1-uc001-self-hosting-with-epics.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.1-uc001-self-hosting-with-epics.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail lifecycle)\n- docs/specs/product-requirements/prd007-links-interface.yaml (belongs_to links)\n- tests/integration/test_rel02_1_uc003_self_hosting_test.go (flat self-hosting pattern)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (trail usage pattern, dependency)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_1_uc001_self_hosting_with_epics_test.go (create)\n\n## Requirements\nImplement the 24 test cases from test-rel03.1-uc001-self-hosting-with-epics.yaml that validate:\n- Create trail as epic container (TC01-TC03)\n- Associate task crumbs with epic trail via belongs_to links (TC04-TC06)\n- Query epic membership using links table (TC07-TC09)\n- Move tasks between epics by updating belongs_to links (TC10-TC12)\n- Complete epic and verify tasks become permanent (TC13-TC15)\n- Abandon epic and verify cascade deletion of tasks (TC16-TC18)\n- Verify epic lifecycle matches trail lifecycle semantics (TC19-TC21)\n- End-to-end epic workflow (TC22-TC24)\n\n## Design Decisions\n- Use table-driven test pattern with subtests\n- Model epics as trails in active state with belongs_to links to task crumbs\n- Validate epic-as-container semantics: trail lifecycle controls grouped tasks\n- Follow self-hosting test pattern from test_rel02_1_uc003_self_hosting_test.go for realistic workflow\n\n## Acceptance Criteria\n- [ ] All 24 test cases from test-rel03.1-uc001-self-hosting-with-epics.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestSelfHostingWithEpics\n- [ ] Test file saved as test_rel03_1_uc001_self_hosting_with_epics_test.go\n- [ ] Assertions verify success criteria from use case\n- [ ] Realistic workflow demonstrated: create epic, add tasks, complete/abandon epic","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.582098-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:30:13.476126-05:00","closed_at":"2026-02-13T01:30:13.476126-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-58c","depends_on_id":"generation-2026-02-13-07-56-44-bul","type":"blocks","created_at":"2026-02-13T01:09:08.438375-05:00","created_by":"petardjukic"}],"comments":[{"id":112,"issue_id":"generation-2026-02-13-07-56-44-58c","author":"petardjukic","text":"duration: 4m46s | tokens: in=59 out=17684 | loc: +645 -1 files=2","created_at":"2026-02-13T06:30:13Z"}]}
{"id":"generation-2026-02-13-07-56-44-5mn","title":"Implement cupboard close command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.6 close command)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R4.3 Pebble method)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F12-F13 close)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test case 9)\n- cmd/cupboard/create.go (command pattern reference)\n- pkg/types/crumb.go (Crumb.Pebble method)\n\n## Files to Create/Modify\n- cmd/cupboard/close.go (create) — close command implementation\n- cmd/cupboard/root.go (modify) — register close command\n\n## Requirements\n- Implement `cupboard close \u003cid\u003e [--json]` command\n- Retrieve crumb via Table.Get, type-assert to *Crumb\n- Call crumb.Pebble() to transition to pebble state (requires taken state)\n- Persist via Table.Set with the crumb's ID\n- Human-readable output: \"Closed \u003cid\u003e\"\n- JSON output (with --json flag): full crumb object\n- Exit 0 on success\n- Exit 1 if crumb not found or invalid state transition\n- Error messages follow prd009 R9 format\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Get-modify-set pattern: retrieve entity, call entity method, persist\n- Pebble() enforces state transition rules (must be in taken state)\n- Human-readable output by default, JSON with --json flag\n\n## Acceptance Criteria\n- [ ] `cupboard close \u003cid\u003e` sets state to pebble and exits 0\n- [ ] `cupboard close \u003cid\u003e --json` outputs JSON with pebble state\n- [ ] `cupboard close \u003cnonexistent-id\u003e` exits 1 with \"not found\" error\n- [ ] `cupboard close \u003cid\u003e` from non-taken state exits 1 with state transition error\n- [ ] Human-readable output prints \"Closed \u003cid\u003e\"\n- [ ] Command registered in root.go init()\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.765269-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:28:04.59578-05:00","closed_at":"2026-02-12T22:28:04.59578-05:00","close_reason":"Closed","comments":[{"id":113,"issue_id":"generation-2026-02-13-07-56-44-5mn","author":"petardjukic","text":"duration: 2m5s | tokens: in=60 out=5491 | loc: +84 -1 files=3","created_at":"2026-02-13T03:28:04Z"}]}
{"id":"generation-2026-02-13-07-56-44-5n8","title":"Complete link filtering and query test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC11-TC14)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R4: Filter keys, R3.6: Fetch)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F11-F14)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (Fetch implementation)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S6, S7, S8)\n\n## Requirements\nImplement integration test cases validating:\n1. Fetch by link_type filter (success criterion S6)\n   - Create links of multiple types (belongs_to, child_of, branches_from)\n   - Fetch with filter: {\"link_type\": \"belongs_to\"}\n   - Verify only belongs_to links returned\n2. Fetch by from_id filter (success criterion S7)\n   - Create multiple links originating from same entity\n   - Fetch with filter: {\"from_id\": \u003centity_id\u003e}\n   - Verify all links from that entity returned\n3. Fetch by to_id filter (success criterion S8)\n   - Create multiple links targeting same entity\n   - Fetch with filter: {\"to_id\": \u003centity_id\u003e}\n   - Verify all links to that entity returned\n4. Fetch with combined filters\n   - Create links with various combinations\n   - Fetch with filter: {\"link_type\": \"child_of\", \"from_id\": \u003ccrumb_id\u003e}\n   - Verify only links matching all criteria returned (AND semantics)\n\nTest cases must validate prd007-links-interface R4 (filter keys and AND semantics).\n\n## Design Decisions\n- Use table-driven tests to cover multiple filter combinations\n- Create a diverse set of links (different types, from/to IDs) as test fixtures\n- Validate filter results by checking length and verifying each returned link matches criteria\n- Test empty filter (returns all links) and unknown filter keys (ignored per R4.4)\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_FetchByLinkTypeReturnsOnlyMatchingLinks passes\n- [ ] TestLinkManagement_FetchByFromIDReturnsLinksFromEntity passes\n- [ ] TestLinkManagement_FetchByToIDReturnsLinksToEntity passes\n- [ ] TestLinkManagement_FetchWithCombinedFiltersUsesAND passes\n- [ ] Tests validate prd007-links-interface R4.2 (AND semantics for multiple keys)\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.133364-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:57:04.258444-05:00","closed_at":"2026-02-13T01:57:04.258444-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-5n8","depends_on_id":"generation-2026-02-13-07-56-44-dtl","type":"blocks","created_at":"2026-02-13T01:50:43.689628-05:00","created_by":"petardjukic"}],"comments":[{"id":114,"issue_id":"generation-2026-02-13-07-56-44-5n8","author":"petardjukic","text":"duration: 2m47s | tokens: in=31 out=9386 | loc: +242 -1 files=2","created_at":"2026-02-13T06:57:04Z"}]}
{"id":"generation-2026-02-13-07-56-44-5ry","title":"Add Mage target for running cobbler regression test suite","description":"## Required Reading\n- magefiles/test.go (existing test targets)\n- magefiles/cobbler.go (existing cobbler targets)\n- docs/specs/test-suites/ (all test suite YAML files)\n\n## Files to Create/Modify\n- magefiles/test.go (modify) - Add or verify Test.Integration target runs tests/integration/\n\n## Requirements\n- Verify `mage test:integration` runs all tests in tests/integration/\n- Verify `mage test:unit` runs unit tests in pkg/ and internal/\n- Verify `mage test:all` runs both\n- Add test count reporting to output\n\n## Design Decisions\n- Keep existing mage target structure\n- Integration tests in tests/integration/, unit tests alongside source\n\n## Acceptance Criteria\n- [ ] `mage test:unit` runs pkg/ and internal/ tests\n- [ ] `mage test:integration` runs tests/integration/ tests\n- [ ] `mage test:all` runs both\n- [ ] All existing tests pass","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:42.547905-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:42.547905-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-5ry","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.927072-05:00","created_by":"petardjukic"}],"comments":[{"id":76,"issue_id":"generation-2026-02-13-07-56-44-5ry","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:50Z"}]}
{"id":"generation-2026-02-13-07-56-44-5w8","title":"Unit tests for pkg/types: Config, Crumb, Trail entity methods","description":"## Required Reading\n- pkg/types/config.go (Config struct, Validate)\n- pkg/types/crumb.go (Crumb struct, state methods, property methods)\n- pkg/types/trail.go (Trail struct, Complete, Abandon)\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (config validation test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (state transition test cases)\n\n## Files to Create/Modify\n- pkg/types/config_test.go (create) - Table-driven tests for Config.Validate: valid config, empty backend, unknown backend, empty DataDir for sqlite\n- pkg/types/crumb_test.go (create) - Table-driven tests for SetState (valid states, invalid state, idempotent), Pebble (from taken OK, from other states fails), Dust (from any state OK, idempotent), property methods (SetProperty, GetProperty, ClearProperty)\n- pkg/types/trail_test.go (create) - Table-driven tests for Complete (from active OK, from other states fails), Abandon (from active OK, from other states fails)\n\n## Requirements\n- Use testify/assert for assertions\n- Table-driven tests: each YAML test case maps to one row\n- Test edge cases: zero values, nil Properties map, empty strings\n- Test all error conditions return correct sentinel errors\n\n## Design Decisions\n- Tests in pkg/types package (white-box testing of entity methods)\n- Use testify for readable assertions\n\n## Acceptance Criteria\n- [ ] Config validation tests cover all error paths\n- [ ] Crumb state transition tests cover all valid/invalid transitions\n- [ ] Crumb property method tests cover set/get/clear/not-found\n- [ ] Trail lifecycle tests cover Complete and Abandon\n- [ ] All tests pass: go test ./pkg/types/...\n- [ ] No test uses hardcoded UUIDs (generate or use constants)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.54853-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:50:06.634981-05:00","closed_at":"2026-02-12T07:50:06.634981-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-5w8","depends_on_id":"generation-2026-02-13-07-56-44-eow","type":"blocks","created_at":"2026-02-12T07:18:37.516488-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-68l","title":"Define SQLite backend configuration and constructor in internal/sqlite","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R1 directory layout, R4 startup, R16 sync strategy)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R1 Config, R4 Attach)\n- pkg/types/config.go (Config struct)\n- pkg/types/cupboard.go (Cupboard interface)\n\n## Files to Create/Modify\n- internal/sqlite/backend.go (create) - SQLiteBackend struct implementing Cupboard interface; SQLiteConfig struct with SyncStrategy, BatchSize, BatchInterval; NewBackend() constructor; GetTable, Attach, Detach method stubs; attached/detached state tracking\n- internal/sqlite/schema.go (create) - SQL schema DDL strings (all 9 CREATE TABLE statements, all 12 CREATE INDEX statements from prd002 R3)\n\n## Requirements\n- SQLiteBackend struct with: db connection, attached flag, mutex for state, map of table accessors, config\n- NewBackend() returns *SQLiteBackend (not attached)\n- Attach(config): validate config, create DataDir if needed, create empty JSONL files if needed, delete existing cupboard.db, create new cupboard.db with schema, mark as attached; return ErrAlreadyAttached if already attached\n- Detach(): mark as detached, close db; idempotent\n- GetTable(name): return table accessor from map or ErrTableNotFound; return ErrCupboardDetached if detached\n- Schema DDL as const strings per prd002 R3.2 and R3.3\n\n## Design Decisions\n- Use modernc.org/sqlite (pure Go, no CGO) per architecture doc\n- Single backend.go for the struct and lifecycle; schema.go for DDL constants\n- Table accessors created during Attach and cached\n\n## Acceptance Criteria\n- [ ] SQLiteBackend implements Cupboard interface (compile check)\n- [ ] NewBackend returns unattached backend\n- [ ] Attach creates DataDir and JSONL files\n- [ ] Attach creates cupboard.db with correct schema\n- [ ] Detach closes connection and marks detached\n- [ ] GetTable returns ErrTableNotFound for unknown names\n- [ ] GetTable returns ErrCupboardDetached after Detach\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.991338-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:30:16.365319-05:00","closed_at":"2026-02-12T07:30:16.365319-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-68l","depends_on_id":"generation-2026-02-13-07-56-44-eow","type":"blocks","created_at":"2026-02-12T07:18:37.109887-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-6dx","title":"Implement metadata, stashes table accessors and JSONL loading","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata entity, schemas)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash entity, history, operations)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup sequence, R9 built-in properties seeding)\n- internal/sqlite/backend.go (Attach method)\n\n## Files to Create/Modify\n- internal/sqlite/metadata_table.go (create) - metadataTable implementing Table; Fetch supports filter by table_name, crumb_id, property_id, content_contains, limit, offset\n- internal/sqlite/stashes_table.go (create) - stashesTable implementing Table; Set handles version increment and history append to stash_history; stash_history JSONL persistence\n- internal/sqlite/loader.go (create) - JSONL loading functions for startup: loadAllJSONL reads each JSONL file and inserts into SQLite tables; seedBuiltInProperties creates priority/type/description/owner/labels properties and categories if properties.jsonl is empty per prd002 R9\n- internal/sqlite/backend.go (modify) - Wire Attach to call loader, create all 6 table accessors, store in map\n\n## Requirements\n- metadataTable: hydrate/dehydrate Metadata per prd002 R14.5; Fetch with schema name, crumb_id, content_contains filters\n- stashesTable: hydrate/dehydrate Stash per prd002 R14.7; Set increments Version, records StashHistoryEntry, persists to stashes.jsonl and stash_history.jsonl\n- Loader: read each JSONL file line by line, parse JSON, insert into SQLite; skip malformed lines with warning; seed built-in properties per prd002 R9\n- Wire all 6 table accessors into backend.Attach\n\n## Design Decisions\n- Stash history append-only: never rewrite stash_history.jsonl, only append\n- Built-in properties seeded only if properties.jsonl is empty (first run)\n- Loader is transactional per prd002 R4.4\n\n## Acceptance Criteria\n- [ ] metadataTable implements Table with filtering\n- [ ] stashesTable implements Table with version/history tracking\n- [ ] Loader reads JSONL files into SQLite on Attach\n- [ ] Built-in properties seeded on first startup\n- [ ] Attach creates all 6 table accessors\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.409817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:47:31.443682-05:00","closed_at":"2026-02-12T07:47:31.443682-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-6dx","depends_on_id":"generation-2026-02-13-07-56-44-ny9","type":"blocks","created_at":"2026-02-12T07:18:37.415895-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-6ep","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with t.Setenv for automatic cleanup\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.813863-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:28:59.606714-05:00","closed_at":"2026-02-12T12:28:59.606714-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-6ep","depends_on_id":"generation-2026-02-13-07-56-44-6y0","type":"blocks","created_at":"2026-02-12T08:33:20.64595-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-6k4","title":"Add unit tests for LinkTable CRUD and uniqueness","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (link test cases)\n- internal/sqlite/table_link.go (implementation under test)\n- docs/specs/product-requirements/prd007-links-interface.yaml R1, R3-R5\n\n## Files to Create/Modify\n- internal/sqlite/table_link_test.go (create)\n\n## Requirements\n- Test Get: existing link, non-existent link returns ErrNotFound\n- Test Set (create): generates UUID v7, validates LinkType, FromID, ToID\n- Test Set: invalid link type returns error\n- Test Set: empty FromID or ToID returns error\n- Test Set: duplicate (link_type, from_id, to_id) returns uniqueness error\n- Test Delete: existing link, non-existent link\n- Test Fetch: filter by link_type, from_id, to_id\n- Test links are immutable (update with existing ID uses delete+create pattern)\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Reuse testutil_test.go helpers for crumb/trail creation\n\n## Acceptance Criteria\n- [ ] CRUD operations tested\n- [ ] Uniqueness constraint enforced\n- [ ] All four link types tested\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.667538-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:34:03.470262-05:00","closed_at":"2026-02-13T17:34:03.470262-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-6k4","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.377591-05:00","created_by":"petardjukic"}],"comments":[{"id":49,"issue_id":"generation-2026-02-13-07-56-44-6k4","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":87,"issue_id":"generation-2026-02-13-07-56-44-6k4","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:31:01Z\",\"duration_s\":181,\"tokens\":{\"input\":16,\"output\":13454},\"loc_before\":{\"production\":6101,\"test\":3660},\"loc_after\":{\"production\":6101,\"test\":4511},\"diff\":{\"files\":2,\"insertions\":852,\"deletions\":1}}","created_at":"2026-02-13T22:34:03Z"}]}
{"id":"generation-2026-02-13-07-56-44-6rc","title":"Extract shared CLI helpers: parseEntityJSON to helpers.go","description":"## Required Reading\n- cmd/cupboard/helpers.go (existing attachBackend, validTableNames, error checkers)\n- cmd/cupboard/set.go (parseEntityJSON currently lives here)\n- cmd/cupboard/get.go, list.go, delete.go (verify no other duplicated patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (modify) — move parseEntityJSON here\n- cmd/cupboard/set.go (modify) — remove parseEntityJSON, use from helpers\n\n## Requirements\n- Move `parseEntityJSON(tableName string, data []byte) (any, error)` from set.go to helpers.go\n- Verify no other duplicated logic exists across the four command files (get, set, list, delete)\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Design Decisions\n- helpers.go already contains attachBackend, validTableNames, and error checkers\n- parseEntityJSON is only used by set.go today but belongs in shared helpers for future reuse\n\n## Acceptance Criteria\n- [ ] parseEntityJSON lives in helpers.go\n- [ ] set.go imports it from helpers (same package, no import needed)\n- [ ] All four commands (get, set, list, delete) use shared helpers where applicable\n- [ ] `go build ./cmd/cupboard` succeeds\n- [ ] All existing tests still pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.69291-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:35:18.404296-05:00","closed_at":"2026-02-12T12:35:18.404296-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-6rc","depends_on_id":"generation-2026-02-13-07-56-44-dc3","type":"blocks","created_at":"2026-02-12T12:08:18.839964-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-6y0","title":"Implement config.yaml loading with Viper","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R7 config.yaml, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F4 load config.yaml, F6 create on first run, S6-S8)\n- cmd/cupboard/root.go (existing flag handling)\n- internal/paths/paths.go (after task 6 — ResolveConfigDir)\n\n## Files to Create/Modify\n- cmd/cupboard/config.go (create) — Viper-based config loading\n- cmd/cupboard/root.go (modify) — integrate config loading into PersistentPreRunE\n\n## Requirements\n- Load config.yaml from resolved config directory using Viper\n- Config file fields: backend (string, default \"sqlite\"), data_dir (string, optional)\n- Create config directory on first run if it does not exist\n- Create default config.yaml on first run if config dir exists but file does not\n- Missing config.yaml is not an error (use defaults)\n- Integrate into root command's PersistentPreRunE so all subcommands benefit\n- Pass resolved data_dir from config.yaml to resolveDataDir pipeline\n\n## Design Decisions\n- Use spf13/viper for config file parsing (per go-style standard ecosystem)\n- Config loading happens once in PersistentPreRunE, not per-command\n- Keep it minimal: only load data_dir and backend from config.yaml\n\n## Acceptance Criteria\n- [ ] config.yaml is loaded from resolved config directory\n- [ ] data_dir from config.yaml is respected when no --data-dir flag provided\n- [ ] Missing config.yaml uses defaults without error\n- [ ] Config directory created on first run if absent\n- [ ] Default config.yaml created on first run if absent\n- [ ] PersistentPreRunE integrates config loading for all commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.675509-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:23:52.543312-05:00","closed_at":"2026-02-12T12:23:52.543312-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-6y0","depends_on_id":"generation-2026-02-13-07-56-44-rpi","type":"blocks","created_at":"2026-02-12T08:33:20.548002-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-748","title":"Add integration tests for metadata table CRUD (rel02.1-uc004)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (F1-F14 flows, S1-S12)\n- docs/specs/test-suites/test-rel02.1-uc004-metadata-lifecycle.yaml (all test cases)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R10)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test pattern)\n- internal/sqlite/metadata_table.go (metadata table implementation)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc004_metadata_lifecycle_test.go (create)\n\n## Requirements\n- Test metadata creation via Table.Set with empty ID (S1)\n- Test multiple metadata entries accumulate for same crumb (S2)\n- Test comments schema stores plain text (S3)\n- Test attachments schema stores JSON (S4)\n- Test metadata retrieval via Table.Get (S5)\n- Test filter by schema (S6)\n- Test filter by crumb_id (S7)\n- Test combining filters (S8)\n- Test ErrNotFound for nonexistent ID (S9)\n- Test ErrInvalidID for empty ID (S10)\n- Test cascade delete when parent crumb deleted (S11-S12)\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch), not CLI\n\n## Design Decisions\n- Integration tests use real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify metadata content and fields match what was created\n- Test both built-in schemas (comments, attachments)\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S12 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestMetadataLifecycle\n- [ ] Tests verify UUID v7 generation for metadata\n- [ ] Tests verify multiple entries for same crumb\n- [ ] Tests verify cascade delete removes all metadata\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.912046-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:31:10.035145-05:00","closed_at":"2026-02-12T22:31:10.035145-05:00","close_reason":"Closed","comments":[{"id":115,"issue_id":"generation-2026-02-13-07-56-44-748","author":"petardjukic","text":"duration: 3m4s | tokens: in=31 out=11616 | loc: +683 -1 files=2","created_at":"2026-02-13T03:31:09Z"}]}
{"id":"generation-2026-02-13-07-56-44-755","title":"Wire CLI with cobra: init and version commands using Cupboard","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (init, version commands)\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (config/data directory defaults)\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (CLI version, tables accessible)\n- cmd/cupboard/main.go (existing entry point)\n- pkg/crumbs/version.go (version constant)\n\n## Files to Create/Modify\n- cmd/cupboard/main.go (modify) - Replace print-only main with cobra root command\n- cmd/cupboard/root.go (create) - Root cobra command with --config-dir, --data-dir, --json global flags\n- cmd/cupboard/init.go (create) - Init command: creates data directory, initializes backend (Attach + Detach), seeds built-in properties\n- cmd/cupboard/version.go (create) - Version command: prints version string\n\n## Requirements\n- Root command \"cupboard\" with persistent flags: --config-dir, --data-dir, --json, --help, --version\n- \"cupboard init\" creates .crumbs-db directory (or custom data-dir), calls Attach to initialize backend and JSONL files, then Detach\n- \"cupboard version\" prints version string from pkg/crumbs/version.go\n- Exit codes: 0 success, 1 user error, 2 system error per prd009\n- Config/data directory defaults per prd010: $(CWD)/.crumbs for config, $(CWD)/.crumbs-db for data\n\n## Design Decisions\n- Use cobra for CLI framework per go-style rule\n- Minimal CLI: only init and version for release 01.0\n- Wire real SQLiteBackend in init command\n\n## Acceptance Criteria\n- [ ] cupboard version prints version and exits 0\n- [ ] cupboard init creates data directory with JSONL files\n- [ ] cupboard init seeds built-in properties\n- [ ] cupboard --help shows available commands\n- [ ] go build ./cmd/cupboard succeeds\n- [ ] go install ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.814753-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:01:19.208259-05:00","closed_at":"2026-02-12T08:01:19.208259-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-755","depends_on_id":"generation-2026-02-13-07-56-44-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.712143-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-7bk","title":"Add FetchStashHistory method to stashes table","description":"## Required Reading\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R7.6: backend must provide method to query history by stash ID)\n- internal/sqlite/stashes_table.go (existing implementation)\n- pkg/types/stash.go (StashHistoryEntry struct)\n\n## Files to Create/Modify\n- internal/sqlite/stashes_table.go (modify: add FetchStashHistory method)\n\n## Requirements\n- Add FetchStashHistory(stashID string) method to stashesTable struct\n- Method must:\n  - Return ([]types.StashHistoryEntry, error)\n  - Return ErrInvalidID if stashID is empty\n  - Return ErrCupboardDetached if backend not attached\n  - Query stash_history table WHERE stash_id = ? ORDER BY version ASC\n  - Hydrate rows into []types.StashHistoryEntry\n  - Return empty slice (not nil) if no history entries exist\n- Method signature matches prd008-stash-interface R7.6 example\n\n## Design Decisions\n- Implement as a method on stashesTable (not exported through Table interface)\n- Tests will type-assert to *sqlite.Table to call this method\n- Order by version ASC per R7.6 to show mutation sequence\n- Use same hydration pattern as other table Get/Fetch methods\n\n## Acceptance Criteria\n- [ ] FetchStashHistory method exists in internal/sqlite/stashes_table.go\n- [ ] Method signature: func (st *stashesTable) FetchStashHistory(stashID string) ([]types.StashHistoryEntry, error)\n- [ ] Returns ErrInvalidID for empty stashID\n- [ ] Returns ErrCupboardDetached if backend detached\n- [ ] Returns entries ordered by version ASC\n- [ ] Returns empty slice if no entries found\n- [ ] Builds without errors\n- [ ] Code follows go-style: no duplication, clear variable names, proper error wrapping","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.943946-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:47:06.278001-05:00","closed_at":"2026-02-13T01:47:06.278001-05:00","close_reason":"Closed","comments":[{"id":116,"issue_id":"generation-2026-02-13-07-56-44-7bk","author":"petardjukic","text":"duration: 54s | tokens: in=24 out=2429 | loc: +47 -1 files=2","created_at":"2026-02-13T06:47:06Z"}]}
{"id":"generation-2026-02-13-07-56-44-7gs","title":"Implement JSONL forward-compatibility for regeneration (rel02.0-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S4 forward compatibility)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases 1-4)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2 JSONL format)\n- internal/sqlite/loader.go (JSONL parsing)\n- pkg/types/ (entity struct definitions)\n\n## Files to Create/Modify\n- internal/sqlite/loader.go (modify) — verify unknown JSON fields are tolerated\n- internal/sqlite/loader_test.go (modify or create) — forward compatibility tests\n\n## Requirements\n- JSONL loader must tolerate unknown fields in entity JSON (Go default json.Unmarshal behavior)\n- Verify that entity structs can be loaded from JSONL with extra fields\n- Verify that adding new fields to entity structs does not break loading old JSONL\n- Unit tests with JSONL containing future fields that don't exist in current structs\n\n## Design Decisions\n- Go's json.Unmarshal silently ignores unknown fields by default (verify this is the case)\n- Write explicit tests confirming this behavior to prevent regressions\n- Test both direct unmarshaling and through the loader pipeline\n\n## Acceptance Criteria\n- [ ] JSONL loader does not error on unknown fields\n- [ ] Unit tests verify loading JSONL with future fields\n- [ ] Existing JSONL round-trip tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.649173-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:29:54.37002-05:00","closed_at":"2026-02-12T18:29:54.37002-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-7ow","title":"Implement metadata table in SQLite backend (rel02.1-uc004)","description":"## Required Reading\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R10)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R2.8 metadata table schema)\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (touchpoints T1-T9)\n- internal/sqlite/properties_table.go (table accessor pattern reference)\n- internal/sqlite/schema.go (DDL patterns)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- internal/sqlite/metadata_table.go (create) — metadata table accessor implementing Table interface\n- internal/sqlite/backend.go (modify) — register metadata table in buildTables\n- pkg/types/cupboard.go (modify) — add TableMetadata constant\n\n## Requirements\n- Add `TableMetadata = \"metadata\"` constant to pkg/types/cupboard.go\n- Create metadataTable implementing types.Table for metadata\n  - Get: retrieve metadata by ID, hydrate to *types.Metadata\n  - Set: create (empty ID) or update metadata; generate UUID v7; validate CrumbID exists; validate TableName is registered schema\n  - Delete: metadata is append-only per prd005 R8, return ErrOperationNotSupported\n  - Fetch: query metadata with optional filters (schema, crumb_id); combine filters with AND\n  - Persist to metadata.jsonl after mutations\n- Implement cascade delete trigger: when crumb deleted, delete all its metadata\n- Register metadataTable in buildTables map in backend.go\n- Seed built-in schemas (comments, attachments) per prd005 R3\n\n## Design Decisions\n- Follow the same table accessor pattern as propertiesTable and crumbsTable\n- Set validates CrumbID exists by querying crumbs table\n- Set validates TableName against registered schemas table\n- Fetch supports schema and crumb_id filters, ANDed together\n- Delete returns ErrOperationNotSupported (append-only)\n- Cascade delete uses ON DELETE CASCADE in schema or manual trigger\n\n## Acceptance Criteria\n- [ ] TableMetadata constant exists in pkg/types/cupboard.go\n- [ ] metadataTable implements types.Table with Get, Set, Delete, Fetch\n- [ ] Set generates UUID v7 for new metadata entries\n- [ ] Set validates CrumbID exists and returns ErrNotFound if crumb missing\n- [ ] Set validates TableName against schemas table\n- [ ] Fetch filters by schema and crumb_id with AND logic\n- [ ] Delete returns ErrOperationNotSupported\n- [ ] Cascade delete removes all metadata when parent crumb deleted\n- [ ] Built-in schemas (comments, attachments) seeded on attach\n- [ ] Existing tests continue to pass (go test ./...)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.057373-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:34:52.929854-05:00","closed_at":"2026-02-12T22:34:52.929854-05:00","close_reason":"Closed","comments":[{"id":117,"issue_id":"generation-2026-02-13-07-56-44-7ow","author":"petardjukic","text":"duration: 3m42s | tokens: in=98 out=7546 | loc: +2 -2 files=2","created_at":"2026-02-13T03:34:52Z"}]}
{"id":"generation-2026-02-13-07-56-44-7up","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create) — CLI integration tests\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.392357-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:17:14.794723-05:00","closed_at":"2026-02-12T12:17:14.794723-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-7up","depends_on_id":"generation-2026-02-13-07-56-44-qg7","type":"blocks","created_at":"2026-02-12T08:33:20.45016-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-8dk","title":"Add integration tests for trail-crumb lifecycle (rel03.0-uc004)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc004-trail-crumb-lifecycle.yaml (test cases)\n- docs/specs/use-cases/rel03.0-uc004-trail-crumb-lifecycle.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc004_trail_crumb_lifecycle_test.go (create)\n\n## Requirements\n- Test: create trail, add multiple crumbs, complete trail → crumbs become permanent (no belongs_to links)\n- Test: create trail, add crumbs, abandon trail → crumbs deleted\n- Test: mixed scenario (complete one trail, abandon another)\n- Test: crumb with child_of links survives trail completion\n- Test: abandoned crumb's child_of links also removed\n\n## Design Decisions\n- End-to-end CLI tests using generic table commands\n- Verify by listing crumbs and links after cascade operations\n\n## Acceptance Criteria\n- [ ] Complete makes crumbs permanent\n- [ ] Abandon deletes crumbs and their links\n- [ ] Mixed scenarios work correctly\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.576801-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:41.576801-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-8dk","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.173639-05:00","created_by":"petardjukic"}],"comments":[{"id":69,"issue_id":"generation-2026-02-13-07-56-44-8dk","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-8fc","title":"Implement SQLite schema creation and backend skeleton","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R1 schema, R2 indexes, R3 startup sequence)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R2 Cupboard interface)\n- docs/ARCHITECTURE.md § System Components (SQLite Backend)\n- pkg/types/cupboard.go (Cupboard and Table interfaces from task 1)\n- pkg/types/config.go (Config struct from task 1)\n\n## Files to Create/Modify\n- internal/sqlite/schema.go (create) - SQL schema constants, CreateSchema function\n- internal/sqlite/backend.go (create) - Backend struct skeleton implementing Cupboard, Attach/Detach lifecycle, GetTable dispatch\n- internal/sqlite/config.go (create) - SQLiteConfig struct with SyncStrategy, BatchSize, BatchInterval and Validate method\n\n## Requirements\n- schema.go: Define SQL CREATE TABLE statements as string constants for all 9 tables (crumbs, trails, links, properties, categories, crumb_properties, metadata, stashes, stash_history) per prd002 R1. Define CREATE INDEX statements per prd002 R2. CreateSchema(db *sql.DB) error function that executes all DDL.\n- backend.go: Backend struct with db (*sql.DB), config (Config), attached (bool), mu (sync.RWMutex). NewBackend() *Backend constructor. Implement Cupboard interface: Attach opens/creates DataDir, deletes stale cupboard.db, creates fresh DB with schema. Detach closes DB, deletes cupboard.db. GetTable dispatches by name to table accessors (stubs for now, returns ErrTableNotFound for unimplemented).\n- config.go: SQLiteConfig with SyncStrategy (default \"immediate\"), BatchSize (default 100), BatchInterval (default 5). Validate method returns appropriate errors.\n- Use modernc.org/sqlite (pure Go, no CGO) per ARCHITECTURE technology choices\n- Add SPDX copyright headers\n\n## Design Decisions\n- Backend owns the sql.DB connection and manages its lifecycle\n- Attach creates DataDir if it does not exist (os.MkdirAll)\n- Detach is idempotent (no error if already detached)\n- All operations after Detach return ErrCupboardDetached\n- GetTable returns concrete table accessors (to be implemented in subsequent tasks)\n- Use modernc.org/sqlite instead of mattn/go-sqlite3 (pure Go, no CGO dependency)\n\n## Acceptance Criteria\n- [ ] All 9 CREATE TABLE statements match prd002 R1 schema\n- [ ] All indexes match prd002 R2\n- [ ] Backend.Attach creates directory, DB, and schema\n- [ ] Backend.Detach closes DB and cleans up\n- [ ] Backend.GetTable returns ErrTableNotFound for unknown tables\n- [ ] Operations after Detach return ErrCupboardDetached\n- [ ] Copyright headers present\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.80132-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:12:24.451112-05:00","closed_at":"2026-02-13T08:12:24.451112-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-8fc","depends_on_id":"generation-2026-02-13-07-56-44-0bz","type":"blocks","created_at":"2026-02-13T08:02:21.900329-05:00","created_by":"petardjukic"}],"comments":[{"id":5,"issue_id":"generation-2026-02-13-07-56-44-8fc","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":15,"issue_id":"generation-2026-02-13-07-56-44-8fc","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:09:08Z\",\"duration_s\":196,\"tokens\":{\"input\":32,\"output\":10174},\"loc_before\":{\"production\":688,\"test\":0},\"loc_after\":{\"production\":1064,\"test\":0},\"diff\":{\"files\":6,\"insertions\":414,\"deletions\":1}}","created_at":"2026-02-13T13:12:24Z"}]}
{"id":"generation-2026-02-13-07-56-44-8ku","title":"Complete stash creation and value operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC2-TC7)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R1-R4: Stash struct, types, creation, value methods)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F2-F7)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- internal/sqlite/stashes_table.go (implementation to test)\n- pkg/types/stash.go (Stash entity methods)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S2, S3, S4)\n\n## Requirements\nImplement integration test cases validating:\n1. Create all five stash types (success criterion S2)\n   - Create resource stash with {\"uri\": string, \"kind\": string}\n   - Create artifact stash with {\"path\": string, \"producer\": string}\n   - Create context stash with arbitrary key-value pairs\n   - Create counter stash with {\"value\": 0}\n   - Create lock stash with nil value\n   - Verify each stash has correct type, Version=1, CreatedAt set\n2. SetValue and GetValue operations (success criteria S3, S4)\n   - Create context stash\n   - Call SetValue with new value\n   - Verify Version increments\n   - Call GetValue and verify value matches\n   - Verify SetValue on lock type returns ErrInvalidStashType\n\nTest cases must validate prd008-stash-interface R2 (stash types), R3 (creation), and R4 (value methods).\n\n## Design Decisions\n- Use table-driven tests for creating all five stash types\n- Validate Version starts at 1 and increments on SetValue (prd008-stash-interface R1.6)\n- Test SetValue error handling for lock type (prd008-stash-interface R4.2)\n- Verify CreatedAt, LastOperation fields populated correctly\n\n## Acceptance Criteria\n- [ ] TestStashOperations_CreateAllStashTypes passes (validates S2)\n- [ ] TestStashOperations_SetValueUpdatesValueAndVersion passes (validates S3)\n- [ ] TestStashOperations_GetValueReturnsCurrentValue passes (validates S4)\n- [ ] TestStashOperations_SetValueOnLockTypeReturnsError passes\n- [ ] Tests validate prd008-stash-interface R2.1 (all five types)\n- [ ] Tests validate prd008-stash-interface R4.2 (SetValue increments Version)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.391149-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:59:56.618788-05:00","closed_at":"2026-02-13T01:59:56.618788-05:00","close_reason":"Closed","comments":[{"id":118,"issue_id":"generation-2026-02-13-07-56-44-8ku","author":"petardjukic","text":"duration: 1m4s | tokens: in=30 out=2629 | loc: +1 -1 files=1","created_at":"2026-02-13T06:59:56Z"}]}
{"id":"generation-2026-02-13-07-56-44-8rm","title":"Implement issue-tracking CLI update command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.5 update command)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F8 update, S5)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases for update)\n- cmd/cupboard/get.go (get command for reference)\n- cmd/cupboard/set.go (set command for reference)\n- cmd/cupboard/helpers.go (attachBackend helper)\n- pkg/types/crumb.go (Crumb struct, SetState method)\n\n## Files to Create/Modify\n- cmd/cupboard/update.go (create) — update command implementation\n- cmd/cupboard/root.go (modify) — register update command\n\n## Requirements\n- Implement `cupboard update \u003cid\u003e [--status \u003cstate\u003e] [--title \u003ctitle\u003e] [--json]`\n- Retrieve crumb via Table.Get, apply field changes, persist with Table.Set\n- --status flag sets crumb state using crumb.SetState method\n- --title flag updates crumb.Name field\n- --json flag outputs JSON representation of updated crumb\n- Exit 0 on success with confirmation message (\"Updated \u003cid\u003e\")\n- Exit 1 if crumb not found or invalid state value\n- Validate --status against valid states (draft, pending, ready, taken, pebble, dust)\n- Error messages follow prd009 R9 format (\"context: details\")\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Get-modify-set pattern: retrieve entity, call entity methods, persist\n- Validation happens before calling entity methods\n- Human-readable output by default, JSON with --json flag\n\n## Acceptance Criteria\n- [ ] `cupboard update \u003cid\u003e --status in_progress` updates state and exits 0\n- [ ] `cupboard update \u003cid\u003e --title \"New name\"` updates name and exits 0\n- [ ] `cupboard update \u003cid\u003e --status in_progress --json` outputs JSON with updated state\n- [ ] `cupboard update \u003cnonexistent-id\u003e` exits 1 with \"not found\" error\n- [ ] `cupboard update \u003cid\u003e --status invalid` exits 1 with validation error listing valid states\n- [ ] Human-readable output prints \"Updated \u003cid\u003e\"\n- [ ] Command registered in root.go init()\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T19:10:53.775284-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:23:03.382846-05:00","closed_at":"2026-02-12T22:23:03.382846-05:00","close_reason":"Closed","comments":[{"id":119,"issue_id":"generation-2026-02-13-07-56-44-8rm","author":"petardjukic","text":"duration: 1m41s | tokens: in=62 out=4371 | loc: +113 -1 files=3","created_at":"2026-02-13T03:23:03Z"}]}
{"id":"generation-2026-02-13-07-56-44-8uy","title":"Add integration tests for self-hosting with epics (rel03.1-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.1-uc001-self-hosting-with-epics.yaml (test cases)\n- docs/specs/use-cases/rel03.1-uc001-self-hosting-with-epics.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_1_uc001_self_hosting_with_epics_test.go (create)\n\n## Requirements\n- Test: create trail as epic\n- Test: create crumbs as tasks, link to trail via belongs_to\n- Test: manage tasks through state transitions\n- Test: complete trail (epic) → tasks become permanent\n- Test: abandon trail (epic) → tasks deleted\n- Test: mixed scenario with multiple epics\n\n## Design Decisions\n- Combine generic table CLI (for trails and links) with issue-tracking CLI (for crumbs)\n- Verify cascade effects\n\n## Acceptance Criteria\n- [ ] Trail-as-epic workflow works end-to-end\n- [ ] Complete and abandon cascades verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:42.41955-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:42.41955-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-8uy","depends_on_id":"generation-2026-02-13-07-56-44-ni2","type":"blocks","created_at":"2026-02-13T13:54:45.805421-05:00","created_by":"petardjukic"}],"comments":[{"id":75,"issue_id":"generation-2026-02-13-07-56-44-8uy","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:50Z"}]}
{"id":"generation-2026-02-13-07-56-44-8xg","title":"Add integration tests for stash operations (rel03.0-uc003)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (create)\n\n## Requirements\n- Test: create stash of each type (resource, artifact, context, counter, lock)\n- Test: set and get stash value\n- Test: counter increment\n- Test: lock acquire and release\n- Test: stash history records operations\n- Test: name uniqueness enforced\n- Test: delete stash cascades history\n- Test: delete held lock rejected\n\n## Design Decisions\n- Use generic table CLI for stash operations\n- Parse JSON output for value assertions\n\n## Acceptance Criteria\n- [ ] All 5 stash types tested\n- [ ] Value, counter, and lock operations tested\n- [ ] History recording verified\n- [ ] Cascade and constraint tests pass\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"in_progress","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.447936-05:00","created_by":"petardjukic","updated_at":"2026-02-13T19:13:38.360419-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-8xg","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.07877-05:00","created_by":"petardjukic"}],"comments":[{"id":68,"issue_id":"generation-2026-02-13-07-56-44-8xg","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-90v","title":"Add integration tests for property enforcement use case (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3)\n- Test auto-initialization on crumb creation (S4-S6)\n- Test backfill on property definition (S7-S9)\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch), not CLI\n\n## Design Decisions\n- Integration tests use the real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.806531-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:04:12.015156-05:00","closed_at":"2026-02-12T23:04:12.015156-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-90v","depends_on_id":"generation-2026-02-13-07-56-44-yzx","type":"blocks","created_at":"2026-02-12T14:57:07.879642-05:00","created_by":"petardjukic"}],"comments":[{"id":120,"issue_id":"generation-2026-02-13-07-56-44-90v","author":"petardjukic","text":"duration: 1m46s | tokens: in=34 out=3754 | loc: +1 -1 files=1","created_at":"2026-02-13T04:04:11Z"}]}
{"id":"generation-2026-02-13-07-56-44-92w","title":"Run mage stats and commit rel03.0 completion","description":"## Required Reading\n- .claude/rules/cupboard-workflow.md (commit message format with stats)\n- .claude/rules/beads-workflow.md (LOC and documentation tracking)\n- docs/road-map.yaml (release 03.0 now complete)\n\n## Files to Create/Modify\n- All modified files from tasks 0-11 (tests, docs)\n\n## Requirements\n1. Run mage stats to capture final LOC and documentation word counts\n2. Calculate delta from baseline (provided in summary: prod=5709, test=17819, docs=~68000 words)\n3. Create git commit with descriptive message and full stats block\n4. Verify all changes committed (git status clean)\n\n## Design Decisions\n- Use multi-line commit message with Stats block per memory/MEMORY.md format\n- Include both totals and deltas in stats\n- Commit message format:\n  ```\n  Complete release 03.0: link management and stash operations\n\n  - Add integration tests for link CRUD (belongs_to, child_of, branches_from, scoped_to)\n  - Add integration tests for stash operations (all five types, value/counter/lock ops, history)\n  - Add test helper createTestStash\n  - Update SPECIFICATIONS.md and road-map.yaml to mark rel03.0 complete\n\n  Stats:\n    go_production_loc: \u003ctotal\u003e (+\u003cdelta\u003e)\n    go_test_loc:       \u003ctotal\u003e (+\u003cdelta\u003e)\n    documentation_words: \u003ctotal\u003e (+\u003cdelta\u003e)\n  ```\n- Do NOT use condensed delta format\n\n## Acceptance Criteria\n- [ ] mage stats run and output captured\n- [ ] Stats block calculated with totals and deltas\n- [ ] Git commit created with descriptive message and stats\n- [ ] All modified files staged and committed\n- [ ] git status shows clean working tree\n- [ ] Commit message follows memory/MEMORY.md format (full Stats block)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.459469-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:14:07.433845-05:00","closed_at":"2026-02-13T02:14:07.433845-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-92w","depends_on_id":"generation-2026-02-13-07-56-44-r5w","type":"blocks","created_at":"2026-02-13T01:50:44.454145-05:00","created_by":"petardjukic"}],"comments":[{"id":121,"issue_id":"generation-2026-02-13-07-56-44-92w","author":"petardjukic","text":"duration: 40s | tokens: in=16 out=1562 | loc: +1 -1 files=1","created_at":"2026-02-13T07:14:07Z"}]}
{"id":"generation-2026-02-13-07-56-44-9eh","title":"Implement generic table CLI get command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.1 get command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R2 Cupboard interface, R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S1-S3 success criteria for get)\n- cmd/cupboard/root.go (existing CLI structure, global flags, resolveDataDir helper)\n- cmd/cupboard/init.go (pattern for backend initialization)\n- internal/sqlite/backend.go (NewBackend, Attach, GetTable)\n\n## Files to Create/Modify\n- cmd/cupboard/get.go (create) — get command implementation\n- cmd/cupboard/root.go (modify) — register get command\n\n## Requirements\n- Implement `cupboard get \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.1\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Resolve data dir, create backend, attach, get table, call Table.Get(id)\n- Output JSON object with 2-space indentation per R7.3\n- Exit 1 with \"unknown table\" message listing valid names if table not found\n- Exit 1 with \"entity not found\" message if entity not found\n- Exit 2 for system errors (backend initialization failures)\n- Error messages to stderr per R7.4\n\n## Design Decisions\n- Extract a shared helper function `attachBackend()` that resolves data dir, creates backend, and attaches — reuse across get/set/list/delete commands. Place in cmd/cupboard/helpers.go or inline in a shared file.\n- Use json.MarshalIndent for output formatting\n- Entity returned as `any` from Table.Get — marshal directly to JSON\n\n## Acceptance Criteria\n- [ ] `cupboard get crumbs \u003cvalid-id\u003e` returns JSON with exit 0\n- [ ] `cupboard get crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard get unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Error messages written to stderr\n- [ ] JSON output uses 2-space indentation\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.715736-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:36:36.326814-05:00","closed_at":"2026-02-12T08:36:36.326814-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-9fj","title":"Implement issue-tracking CLI commands (ready, comments)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4: issue-tracking commands)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (flow, success criteria)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (comments as metadata)\n- cmd/cupboard/root.go (existing CLI structure)\n- cmd/cupboard/create.go (from task 8, for pattern reference)\n- .claude/rules/cupboard-workflow.md (expected command interface)\n\n## Files to Create/Modify\n- cmd/cupboard/ready.go (create) — `cupboard ready` command\n- cmd/cupboard/comments.go (create) — `cupboard comments add/list` commands\n- cmd/cupboard/root.go (modify) — Register new subcommands\n\n## Requirements\n- `cupboard ready [-n \u003ccount\u003e] [--type \u003ctype\u003e] [--json]`\n  - Fetches crumbs with state=ready, optionally filtered by type property\n  - Displays list (limited to N if specified)\n- `cupboard comments add \u003cid\u003e \u003ctext\u003e`\n  - Creates metadata entry with schema \"comments\" linked to crumb ID\n  - Requires MetadataTable to be wired (dependency on task 2)\n- `cupboard comments list \u003cid\u003e [--json]`\n  - Fetches metadata entries for crumb ID with schema \"comments\"\n\n## Design Decisions\n- `ready` command uses Fetch with states=[\"ready\"] filter\n- Comments stored as metadata entries per prd005\n- Comments subcommand uses cobra subcommand grouping\n\n## Acceptance Criteria\n- [ ] `cupboard ready` lists crumbs in ready state\n- [ ] `cupboard ready -n 5` limits output\n- [ ] `cupboard comments add` creates a comment metadata entry\n- [ ] `cupboard comments list` shows comments for a crumb\n- [ ] All commands support --json flag\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:34.643117-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:43:02.051008-05:00","closed_at":"2026-02-13T13:43:02.051008-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-9fj","depends_on_id":"generation-2026-02-13-07-56-44-kot","type":"blocks","created_at":"2026-02-13T08:43:35.409015-05:00","created_by":"petardjukic"}],"comments":[{"id":30,"issue_id":"generation-2026-02-13-07-56-44-9fj","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":37,"issue_id":"generation-2026-02-13-07-56-44-9fj","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:37:33Z\",\"duration_s\":328,\"tokens\":{\"input\":42,\"output\":12060},\"loc_before\":{\"production\":5867,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":3,\"insertions\":206,\"deletions\":1}}","created_at":"2026-02-13T18:43:01Z"}]}
{"id":"generation-2026-02-13-07-56-44-9yb","title":"Add init command --config-dir support and config directory creation","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1.2, R1.6 config directory creation)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (F6 create on first run, S8)\n- cmd/cupboard/init.go (existing init command)\n- cmd/cupboard/root.go (global flags)\n- internal/paths/paths.go (after task 3 — path resolution)\n\n## Files to Create/Modify\n- cmd/cupboard/init.go (modify) — create config directory alongside data directory\n\n## Requirements\n- When `cupboard init` runs, also create the config directory (resolved via --config-dir \u003e env \u003e default)\n- Create default config.yaml in config directory if it does not exist\n- Print both config and data directory paths on successful init\n- Integrate with internal/paths.ResolveConfigDir\n\n## Design Decisions\n- init already creates the data directory; extend it to also create config directory\n- Use os.MkdirAll for idempotent directory creation\n- Default config.yaml contains only backend: sqlite\n\n## Acceptance Criteria\n- [ ] `cupboard init` creates config directory\n- [ ] `cupboard init` creates default config.yaml with backend: sqlite\n- [ ] `cupboard init --config-dir=/tmp/cfg` uses specified config directory\n- [ ] Existing data directory creation still works\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.612596-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:11:48.742575-05:00","closed_at":"2026-02-12T15:11:48.742575-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-9yb","depends_on_id":"generation-2026-02-13-07-56-44-3st","type":"blocks","created_at":"2026-02-12T12:08:19.320851-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-a1t","title":"Implement crumbs table accessor with Get, Set, Delete, Fetch","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R12-R15 table routing, interface impl, hydration, persistence)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R3 creation, R6-R10 retrieval/update/delete/filter/query)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, R8 UUID v7)\n- internal/sqlite/backend.go (SQLiteBackend, schema)\n- pkg/types/crumb.go (Crumb struct)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (create) - crumbsTable struct implementing Table interface; Get (query by ID, hydrate to *Crumb), Set (create with UUID v7 if empty ID, update if exists; validate Name non-empty; dehydrate to SQL), Delete (remove crumb + cascade property values/metadata/links), Fetch (build WHERE from filter map, hydrate results)\n- internal/sqlite/jsonl.go (create) - JSONL read/write helpers: readJSONL(path) ([]json.RawMessage, error), writeJSONL(path, records) with atomic write pattern (temp file, fsync, rename); loadCrumbsJSONL, persistCrumbsJSONL\n\n## Requirements\n- crumbsTable.Get: query crumbs table by crumb_id, hydrate row to *Crumb per prd002 R14.2, return ErrNotFound/ErrInvalidID\n- crumbsTable.Set: type-assert data to *Crumb, validate Name non-empty (ErrInvalidName), generate UUID v7 if CrumbID empty, set CreatedAt/UpdatedAt/State=draft on create, INSERT or UPDATE, persist to crumbs.jsonl atomically\n- crumbsTable.Delete: delete from crumbs table + cascade (crumb_properties, metadata, links where from_id or to_id), persist affected JSONL files, return ErrNotFound/ErrInvalidID\n- crumbsTable.Fetch: support filters (states, trail_id, parent_id, limit, offset), order by created_at DESC, return []any of *Crumb\n- JSONL helpers: atomic write (write temp, fsync, rename), read line-by-line skipping empty/malformed\n- UUID v7 generation using google/uuid package\n\n## Design Decisions\n- Each table accessor owns its JSONL persistence\n- Atomic write pattern per prd002 R5.2\n- Filter keys map to SQL WHERE clauses; trail_id and parent_id require JOIN on links table\n\n## Acceptance Criteria\n- [ ] crumbsTable implements Table interface\n- [ ] Get returns hydrated *Crumb or ErrNotFound\n- [ ] Set creates crumb with UUID v7 and correct defaults\n- [ ] Set updates existing crumb\n- [ ] Delete cascades to properties, metadata, links\n- [ ] Fetch with empty filter returns all crumbs\n- [ ] Fetch respects states, limit, offset filters\n- [ ] JSONL atomic write pattern works (temp, fsync, rename)\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.124514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:33:42.169793-05:00","closed_at":"2026-02-12T07:33:42.169793-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-a1t","depends_on_id":"generation-2026-02-13-07-56-44-68l","type":"blocks","created_at":"2026-02-12T07:18:37.208079-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-a31","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior)\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.95817-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:38:03.114987-05:00","closed_at":"2026-02-12T12:38:03.114987-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-a4s","title":"Implement generic table CLI list command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.4 list command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface, Filter type)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S7-S9 success criteria for list)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Fetch filter keys: states, trail_id, parent_id, limit, offset)\n\n## Files to Create/Modify\n- cmd/cupboard/list.go (create) — list command implementation\n- cmd/cupboard/root.go (modify) — register list command\n\n## Requirements\n- Implement `cupboard list \u003ctable\u003e [key=value...]` per prd009-cupboard-cli R3.4\n- Accept table name as first arg, remaining args as key=value filter pairs\n- Parse filters: split on '=' to get key and value; exit 1 for malformed filters\n- Special handling: if key is \"states\" or \"State\", wrap value in []string for the filter map\n- Call Table.Fetch(filter) and output JSON array with 2-space indentation\n- Empty results output `[]` (not null)\n- Exit 1 with \"unknown table\" for invalid table, exit 1 with \"invalid filter\" for bad syntax\n\n## Design Decisions\n- Filters passed as positional args after table name (not flags) for simplicity\n- The filter map is passed directly to Table.Fetch — each table implementation handles its own filter keys\n\n## Acceptance Criteria\n- [ ] `cupboard list crumbs` returns JSON array of all crumbs\n- [ ] `cupboard list crumbs State=draft` returns filtered results\n- [ ] `cupboard list crumbs` on empty table returns `[]`\n- [ ] `cupboard list crumbs bad-filter` returns exit 1 with expected format message\n- [ ] `cupboard list unknown-table` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.992567-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:40:58.649132-05:00","closed_at":"2026-02-12T08:40:58.649132-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-a4s","depends_on_id":"generation-2026-02-13-07-56-44-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.155811-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-a7y","title":"Add integration tests for flat self-hosting workflow","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc005-flat-self-hosting.yaml (test cases: init, create, list, get, update, delete, end-to-end workflows, persistence)\n- docs/specs/use-cases/rel01.1-uc005-flat-self-hosting.yaml (S1-S10 success criteria)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (after task 5 — CLI test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc005_flat_self_hosting_test.go (create)\n\n## Requirements\n- Test full issue-tracking workflow using only generic table commands:\n  - Initialize cupboard (S1)\n  - Create crumb with set (S2)\n  - List all crumbs (S3)\n  - List with State=draft filter (S4)\n  - Update state to taken (S5)\n  - Update state to pebble/close (S6)\n  - Get crumb details (S7)\n  - Do-work cycle: create → list draft → claim (taken) → close (pebble) (S8)\n  - Make-work cycle: list existing → create multiple new crumbs (S9)\n  - JSONL persistence survives database deletion (S10)\n- Use os/exec to run cupboard binary\n- Parse JSON output to extract CrumbIDs for subsequent operations\n\n## Design Decisions\n- Tests mirror the do-work.sh and make-work.sh workflow patterns\n- Each end-to-end test runs the full sequence in a single temp directory\n- JSON parsing with encoding/json for output verification\n\n## Acceptance Criteria\n- [ ] All 10 success criteria (S1-S10) have test coverage\n- [ ] Do-work cycle test runs full create → claim → close workflow\n- [ ] Make-work cycle test creates multiple crumbs and verifies count\n- [ ] JSONL persistence test deletes .db file and verifies data survives\n- [ ] Tests pass with `go test ./tests/integration/... -run TestFlatSelfHosting`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.957723-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:33:33.395426-05:00","closed_at":"2026-02-12T12:33:33.395426-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-a7y","depends_on_id":"generation-2026-02-13-07-56-44-7up","type":"blocks","created_at":"2026-02-12T08:33:20.748175-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-a85","title":"Add unit tests for StashTable CRUD and history","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (stash test cases)\n- internal/sqlite/table_stash.go (implementation under test)\n- docs/specs/product-requirements/prd008-stash-interface.yaml R3, R7-R12\n\n## Files to Create/Modify\n- internal/sqlite/table_stash_test.go (create)\n\n## Requirements\n- Test Get: existing stash, non-existent returns ErrNotFound\n- Test Set (create): generates UUID v7, validates StashType, name uniqueness, version=1\n- Test Set (update): increments version, records history entry\n- Test Set: duplicate name returns error\n- Test Delete: existing stash, cascade deletes history\n- Test Delete: rejects deletion of held locks\n- Test Fetch: filter by stash_type, name\n- Test FetchStashHistory: returns history ordered by version ASC\n- Test counter operations: Increment via Set\n- Test lock operations: Acquire/Release via Set\n\n## Design Decisions\n- Table-driven tests\n- Reuse testutil_test.go helpers\n\n## Acceptance Criteria\n- [ ] CRUD operations tested\n- [ ] Version history recorded and queryable\n- [ ] Lock deletion rejection tested\n- [ ] Counter and lock operations tested\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.204451-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:47:49.568985-05:00","closed_at":"2026-02-13T17:47:49.568985-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-a85","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.662619-05:00","created_by":"petardjukic"}],"comments":[{"id":52,"issue_id":"generation-2026-02-13-07-56-44-a85","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":90,"issue_id":"generation-2026-02-13-07-56-44-a85","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:43:11Z\",\"duration_s\":277,\"tokens\":{\"input\":23,\"output\":17593},\"loc_before\":{\"production\":6101,\"test\":6382},\"loc_after\":{\"production\":6101,\"test\":7416},\"diff\":{\"files\":2,\"insertions\":1035,\"deletions\":1}}","created_at":"2026-02-13T22:47:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-adl","title":"Update road-map.yaml use case statuses to reflect actual implementation state","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- All existing issue descriptions (from beads)\n- cmd/cupboard/ directory (verify which commands exist)\n- internal/paths/ directory (verify if paths package exists)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — correct use case statuses\n\n## Requirements\n- Review each use case marked 'done' in road-map.yaml and verify that:\n  - The code is actually implemented and passes tests\n  - Integration tests exist\n- If a use case is marked 'done' but code or tests are missing, change status to appropriate value\n- Specifically verify:\n  - rel01.1-uc003-configuration-loading: marked 'done' but internal/paths does not exist and config.go not implemented\n  - rel01.1-uc004-generic-table-cli: marked 'done' but delete command not implemented\n- Update statuses to reflect ground truth\n\n## Acceptance Criteria\n- [ ] road-map.yaml use case statuses match actual implementation state\n- [ ] No use case marked 'done' that lacks implementation or tests","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.742837-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:17:26.762506-05:00","closed_at":"2026-02-12T15:17:26.762506-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-aem","title":"Implement DefineCategory and GetCategories with backend persistence (prd004 R7-R8)","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R7 DefineCategory, R8 GetCategories, R2 Category struct)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S12-S15, F15-F18)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases for S12-S15)\n- pkg/types/property.go (DefineCategory and GetCategories stubs, Category struct)\n- pkg/types/cupboard.go (Cupboard interface, table names)\n- internal/sqlite/backend.go (buildTables, categories table in schema)\n- internal/sqlite/schema.go (categories DDL)\n- internal/sqlite/seed.go (category seeding pattern)\n- internal/sqlite/properties_table.go (property table accessor pattern)\n\n## Files to Create/Modify\n- pkg/types/property.go (modify) — complete DefineCategory to persist via Cupboard.GetTable(\"categories\").Set and GetCategories to query via Cupboard.GetTable(\"categories\").Fetch\n- pkg/types/cupboard.go (modify) — add TableCategories constant\n- internal/sqlite/categories_table.go (create) — categories table accessor implementing Table interface (Get, Set, Delete, Fetch) with duplicate name checking, ordinal ordering\n- internal/sqlite/categories_table_test.go (create) — unit tests for categories table\n- internal/sqlite/backend.go (modify) — register categories table in buildTables\n\n## Requirements\n- Add `TableCategories = \"categories\"` constant to pkg/types/cupboard.go\n- Create categories_table.go implementing types.Table for categories\n  - Get: retrieve category by ID, hydrate to *types.Category\n  - Set: create (empty ID) or update category; generate UUID v7; validate PropertyID exists; validate name unique within property (ErrDuplicateName); validate property is categorical (ErrInvalidValueType)\n  - Delete: remove category by ID with ErrNotFound if absent\n  - Fetch: query categories with optional filters (property_id); order by ordinal ASC, name ASC\n  - Persist to categories.jsonl after mutations\n- Complete Property.DefineCategory: call Cupboard.GetTable(\"categories\").Set to persist; return populated Category with CategoryID\n- Complete Property.GetCategories: call Cupboard.GetTable(\"categories\").Fetch with property_id filter; convert to []*Category slice; return ordered results\n- Register categoriesTable in buildTables map in backend.go\n\n## Design Decisions\n- Follow the same table accessor pattern as propertiesTable (internal/sqlite/properties_table.go)\n- DefineCategory validates type and name, creates Category struct, delegates persistence to categories table via Cupboard\n- GetCategories delegates to categories table Fetch with property_id filter\n- Ordering (ordinal ASC, name ASC) is enforced in the SQL query in Fetch\n- Duplicate name check uses SQL query scoped to property_id\n\n## Acceptance Criteria\n- [ ] TableCategories constant exists in pkg/types/cupboard.go\n- [ ] categoriesTable implements types.Table with Get, Set, Delete, Fetch\n- [ ] DefineCategory persists category and returns *Category with populated CategoryID\n- [ ] GetCategories returns categories ordered by ordinal ASC, name ASC\n- [ ] DefineCategory returns ErrDuplicateName for duplicate name within property\n- [ ] DefineCategory returns ErrInvalidValueType for non-categorical property\n- [ ] GetCategories returns ErrInvalidValueType for non-categorical property\n- [ ] GetCategories returns empty slice for property with no categories\n- [ ] Unit tests pass for all category operations\n- [ ] Existing tests continue to pass (go test ./...)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T18:59:49.534894-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:21:21.79275-05:00","closed_at":"2026-02-12T22:21:21.79275-05:00","close_reason":"Closed","comments":[{"id":122,"issue_id":"generation-2026-02-13-07-56-44-aem","author":"petardjukic","text":"duration: 5m31s | tokens: in=44 out=19211 | loc: +861 -4 files=6","created_at":"2026-02-13T03:21:21Z"}]}
{"id":"generation-2026-02-13-07-56-44-ak3","title":"Add integration tests for benchmarks (rel01.0-uc005, rel02.1-uc002)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc005-crumbs-table-benchmarks.yaml (benchmark test cases)\n- docs/specs/test-suites/test-rel02.1-uc002-table-benchmarks.yaml (table benchmark test cases)\n- docs/specs/use-cases/rel01.0-uc005-crumbs-table-benchmarks.yaml\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml\n\n## Files to Create/Modify\n- tests/integration/test_benchmarks_test.go (create)\n\n## Requirements\n- Benchmark CrumbTable.Set: create 100, 1000 crumbs, measure time per operation\n- Benchmark CrumbTable.Get: get crumbs by ID at various scales\n- Benchmark CrumbTable.Fetch: filter by state at various scales\n- Benchmark CrumbTable.Delete: delete crumbs at various scales\n- Benchmark Table operations across all table types\n- Use Go testing.B for benchmarks\n\n## Design Decisions\n- Use Go benchmark framework (testing.B)\n- Use Backend directly (not CLI) for accurate timing\n- Scale factors: 10, 100, 1000\n\n## Acceptance Criteria\n- [ ] Benchmarks compile and run\n- [ ] Results printed per Go benchmark convention\n- [ ] Benchmarks run with `go test -bench=. ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.750697-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:41.750697-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ak3","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:45.269784-05:00","created_by":"petardjukic"}],"comments":[{"id":70,"issue_id":"generation-2026-02-13-07-56-44-ak3","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-b17","title":"Add integration tests for configuration loading precedence","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (S1-S9 success criteria)\n- internal/paths/paths.go (path resolution functions)\n- cmd/cupboard/config.go (config loading)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc003_configuration_loading_test.go (create)\n\n## Requirements\n- Test platform default paths return expected values (S1)\n- Test CRUMBS_CONFIG_DIR env overrides config directory (S2)\n- Test CRUMBS_DATA_DIR env overrides data directory (S3)\n- Test --config-dir flag overrides env and default (S4)\n- Test --data-dir flag overrides config.yaml and default (S5)\n- Test missing config.yaml uses defaults without error (S6)\n- Test config.yaml data_dir is respected when no flag (S7)\n- Test config directory created on first run (S8)\n- Test commands work with each override method (S9)\n- Use os/exec to run cupboard binary with various flag/env combinations\n- Use temp directories for isolation\n\n## Design Decisions\n- Set env vars with cmd.Env for subprocess isolation (not t.Setenv, which affects the test process)\n- Each test case creates its own temp directory\n- Write config.yaml to temp dir for config file tests\n\n## Acceptance Criteria\n- [ ] All 9 success criteria (S1-S9) have test coverage\n- [ ] Tests use table-driven pattern where applicable\n- [ ] Tests pass on macOS (current platform)\n- [ ] Each test is independent and uses isolated temp dirs","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.219391-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:03:28.49137-05:00","closed_at":"2026-02-12T15:03:28.49137-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-b17","depends_on_id":"generation-2026-02-13-07-56-44-3st","type":"blocks","created_at":"2026-02-12T12:08:19.129217-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-b31","title":"Add test helper for creating test stashes","description":"## Required Reading\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test helpers pattern)\n- pkg/types/stash.go (Stash entity)\n\n## Files to Create/Modify\n- tests/integration/helpers_test.go (add createTestStash function)\n\n## Requirements\nAdd a test helper function createTestStash to reduce boilerplate in stash tests:\n1. Accept testing.T, stashes table, stash type, and optional name\n2. Create a stash with generated or provided name\n3. Call Table.Set to persist\n4. Return the created *types.Stash\n5. Use require.NoError for all assertions (fail fast on error)\n\nPattern should match existing helpers (createTestCrumb, createTestTrail).\n\n## Design Decisions\n- Follow existing helper pattern in helpers_test.go\n- Accept stash type as parameter (resource, artifact, context, counter, lock)\n- Generate unique name if not provided (using test name + counter)\n- Initialize stash with appropriate default value based on type\n- Use require.NoError to fail fast on creation errors\n\n## Acceptance Criteria\n- [ ] createTestStash function added to helpers_test.go\n- [ ] Function signature: createTestStash(t *testing.T, table types.Table, stashType string, name ...string) *types.Stash\n- [ ] Function creates stash with correct type and default value\n- [ ] Function persists stash via Table.Set\n- [ ] Function returns populated *types.Stash with StashID, Version, CreatedAt\n- [ ] Function can be used in link and stash tests\n- [ ] All tests pass: go test -v ./tests/integration","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.94433-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:09:23.792483-05:00","closed_at":"2026-02-13T02:09:23.792483-05:00","close_reason":"Closed","comments":[{"id":123,"issue_id":"generation-2026-02-13-07-56-44-b31","author":"petardjukic","text":"duration: 5m14s | tokens: in=51 out=14583 | loc: +89 -35 files=3","created_at":"2026-02-13T07:09:23Z"}]}
{"id":"generation-2026-02-13-07-56-44-b3l","title":"Add unit tests for Config loading and resolution (pkg/config)","description":"## Required Reading\n- pkg/config/loader.go (CLIConfig, ResolveConfigDir, LoadConfig, ResolveDataDir)\n- pkg/config/defaults.go (default constants)\n- docs/specs/test-suites/test-rel01.1-uc003-configuration-loading.yaml\n- docs/specs/product-requirements/prd010-configuration-directories.yaml R1-R2, R8\n\n## Files to Create/Modify\n- pkg/config/loader_test.go (create)\n\n## Requirements\n- Test ResolveConfigDir: default is CWD/.crumbs, flag overrides, env overrides\n- Test ResolveDataDir: default is CWD/.crumbs-db, config file overrides, flag overrides\n- Test LoadConfig: reads config.yaml when present, returns defaults when absent\n- Test EnsureConfigDir: creates directory if missing, no-op if exists\n- Test precedence: flag \u003e env \u003e config.yaml \u003e default\n\n## Design Decisions\n- Use t.TempDir and t.Setenv for isolation\n- Table-driven tests for precedence matrix\n\n## Acceptance Criteria\n- [ ] Default resolution tested\n- [ ] Each override level tested\n- [ ] Precedence order verified\n- [ ] Tests pass with `go test ./pkg/config/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.59315-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:54:30.442086-05:00","closed_at":"2026-02-13T17:54:30.442086-05:00","close_reason":"Closed","comments":[{"id":55,"issue_id":"generation-2026-02-13-07-56-44-b3l","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":93,"issue_id":"generation-2026-02-13-07-56-44-b3l","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:52:17Z\",\"duration_s\":133,\"tokens\":{\"input\":16,\"output\":6502},\"loc_before\":{\"production\":6101,\"test\":7760},\"loc_after\":{\"production\":6101,\"test\":8037},\"diff\":{\"files\":2,\"insertions\":278,\"deletions\":1}}","created_at":"2026-02-13T22:54:30Z"}]}
{"id":"generation-2026-02-13-07-56-44-b6c","title":"Implement cupboard comments add command (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R5.7 comments add command)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (R1-R4 metadata structure)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F10-F11 comments)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases for comments)\n- cmd/cupboard/create.go (command pattern reference)\n- pkg/types/metadata.go (Metadata struct)\n\n## Files to Create/Modify\n- cmd/cupboard/comments.go (create) — comments add subcommand implementation\n- cmd/cupboard/root.go (modify) — register comments command\n\n## Requirements\n- Implement `cupboard comments add \u003cid\u003e \u003ctext\u003e` command\n- Retrieve crumb via Table.Get to validate it exists\n- Create Metadata entry with TableName=\"comments\", CrumbID=id, Content=text\n- Persist via GetTable(\"metadata\").Set with empty ID to generate UUID v7\n- Output \"Added comment to \u003cid\u003e\" on success\n- Exit 1 if crumb not found or other error\n- Error messages follow prd009 R9 format (\"context: details\")\n- Error output to stderr, success to stdout\n\n## Design Decisions\n- Use attachBackend helper from existing commands\n- Validate crumb exists before creating metadata entry\n- Follow cobra command pattern from other commands\n- Comments schema uses TableName=\"comments\" per prd005 R3\n\n## Acceptance Criteria\n- [ ] `cupboard comments add \u003cid\u003e \"text\"` creates metadata entry and exits 0\n- [ ] `cupboard comments add \u003cnonexistent-id\u003e \"text\"` exits 1 with \"crumb not found\" error\n- [ ] Error messages written to stderr\n- [ ] Success output written to stdout\n- [ ] Command registered in root.go init()\n- [ ] Metadata entry has correct CrumbID, TableName, Content, and generated UUID v7","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:45.617889-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:25:58.378583-05:00","closed_at":"2026-02-12T22:25:58.378583-05:00","close_reason":"Closed","comments":[{"id":124,"issue_id":"generation-2026-02-13-07-56-44-b6c","author":"petardjukic","text":"duration: 2m54s | tokens: in=44 out=6128 | loc: +84 -1 files=4","created_at":"2026-02-13T03:25:58Z"}]}
{"id":"generation-2026-02-13-07-56-44-b8m","title":"Implement JSONL persistence layer (read/write/atomic sync)","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 JSONL format, R5 atomic writes, R6 sync strategies, R15-R16 write pattern)\n- docs/engineering/eng01-git-integration.md (JSONL in git)\n- docs/ARCHITECTURE.md § Design Decisions (Decision 6: JSONL as source of truth)\n- internal/sqlite/backend.go (Backend struct from task 4)\n\n## Files to Create/Modify\n- internal/sqlite/jsonl.go (create) - JSONL read/write functions, atomic write, sync strategies\n\n## Requirements\n- ReadJSONL(path string, factory func() any) ([]any, error): Read JSONL file line by line, skip empty lines, unmarshal each line using factory function, return slice. Log warnings for malformed lines but continue (per prd002 R4).\n- WriteJSONL(path string, items []any) error: Write items to JSONL file using atomic write pattern (write to temp file, fsync, rename) per prd002 R5.\n- SyncManager struct with strategy field (immediate, on_close, batch). For \"immediate\": persist after every write operation. For \"on_close\": buffer writes, persist on Detach. For \"batch\": persist every N operations or M seconds (whichever comes first).\n- Each JSONL file maps to one table: crumbs.jsonl, trails.jsonl, links.jsonl, properties.jsonl, categories.jsonl, crumb_properties.jsonl, metadata.jsonl, stashes.jsonl, stash_history.jsonl.\n- Create empty JSONL files if they do not exist on startup.\n- JSONL file names as constants.\n\n## Design Decisions\n- Atomic write: write to .tmp suffix, fsync, os.Rename (per prd002 R5)\n- Factory function pattern for ReadJSONL allows type-safe unmarshalling per table\n- SyncManager is owned by Backend and called after each write operation\n- Batch strategy uses a goroutine with ticker; stopped on Detach\n\n## Acceptance Criteria\n- [ ] ReadJSONL correctly parses multi-line JSONL files\n- [ ] ReadJSONL skips empty lines and logs warnings for malformed lines\n- [ ] WriteJSONL uses atomic write pattern (temp + fsync + rename)\n- [ ] JSONL file name constants for all 9 files\n- [ ] SyncManager supports immediate, on_close, batch strategies\n- [ ] Copyright header present\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.935313-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:15:04.133765-05:00","closed_at":"2026-02-13T08:15:04.133765-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-b8m","depends_on_id":"generation-2026-02-13-07-56-44-8fc","type":"blocks","created_at":"2026-02-13T08:02:21.998552-05:00","created_by":"petardjukic"}],"comments":[{"id":6,"issue_id":"generation-2026-02-13-07-56-44-b8m","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":16,"issue_id":"generation-2026-02-13-07-56-44-b8m","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:12:25Z\",\"duration_s\":159,\"tokens\":{\"input\":18,\"output\":7262},\"loc_before\":{\"production\":1064,\"test\":0},\"loc_after\":{\"production\":1349,\"test\":0},\"diff\":{\"files\":2,\"insertions\":286,\"deletions\":1}}","created_at":"2026-02-13T13:15:04Z"}]}
{"id":"generation-2026-02-13-07-56-44-bfe","title":"Implement LinkTable for SQLite backend","description":"## Required Reading\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link types, uniqueness, graph audit)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (Table interface contract)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (JSONL sync)\n- internal/sqlite/table_crumb.go (reference implementation)\n- internal/sqlite/schema.go (links table schema with unique constraint)\n- pkg/types/link.go (Link entity struct)\n- pkg/types/constants.go (link type constants)\n\n## Files to Create/Modify\n- internal/sqlite/table_link.go (create) — LinkTable implementation\n- internal/sqlite/backend.go (modify) — Wire LinkTable in GetTable map\n\n## Requirements\n- Implement LinkTable satisfying types.Table (Get, Set, Delete, Fetch)\n- Get: retrieve link by ID\n- Set: create (UUID v7) or update link, enforce uniqueness (link_type, from_id, to_id), sync to links.jsonl\n- Delete: remove link\n- Fetch: filter by link_type, from_id, to_id\n- Wire into Backend.tables map\n\n## Design Decisions\n- Uniqueness constraint on (link_type, from_id, to_id) enforced at both SQLite level (schema) and application level\n- Links are immutable per prd007: update via delete and recreate\n\n## Acceptance Criteria\n- [ ] LinkTable implements types.Table\n- [ ] Set enforces uniqueness constraint\n- [ ] Fetch filters by link_type, from_id, to_id\n- [ ] Backend.GetTable(\"links\") returns LinkTable\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:33.712049-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:57:28.730326-05:00","closed_at":"2026-02-13T08:57:28.730326-05:00","close_reason":"Closed","comments":[{"id":24,"issue_id":"generation-2026-02-13-07-56-44-bfe","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":34,"issue_id":"generation-2026-02-13-07-56-44-bfe","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:54:30Z\",\"duration_s\":178,\"tokens\":{\"input\":25,\"output\":9429},\"loc_before\":{\"production\":4665,\"test\":0},\"loc_after\":{\"production\":4989,\"test\":0},\"diff\":{\"files\":5,\"insertions\":325,\"deletions\":63}}","created_at":"2026-02-13T13:57:28Z"}]}
{"id":"generation-2026-02-13-07-56-44-bo3","title":"Update road-map.yaml to mark rel02.1-uc002 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc002 status to done\n\n## Requirements\n- Change rel02.1-uc002-table-benchmarks status from \"not_started\" to \"done\"\n- Verify benchmark suite runs successfully\n- Verify baseline.txt committed to repository\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after all benchmarks implemented and baseline captured\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc002-table-benchmarks status is \"done\" in road-map.yaml\n- [ ] All benchmarks run without error\n- [ ] baseline.txt exists in repository with full benchmark results\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.69286-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:55:33.066536-05:00","closed_at":"2026-02-13T00:55:33.066536-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-bo3","depends_on_id":"generation-2026-02-13-07-56-44-c08","type":"blocks","created_at":"2026-02-12T22:15:48.683687-05:00","created_by":"petardjukic"}],"comments":[{"id":125,"issue_id":"generation-2026-02-13-07-56-44-bo3","author":"petardjukic","text":"duration: 50s | tokens: in=37 out=1815 | loc: +2 -2 files=2","created_at":"2026-02-13T05:55:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-bpu","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R2 creation)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-initialization)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-initialization in Set when creating new crumb\n- internal/sqlite/crumbs_table_test.go (modify or create) — tests for auto-init\n\n## Requirements\n- When Table.Set creates a new crumb (empty ID), auto-initialize all defined properties with their type defaults\n- Type defaults per prd004: categorical=first category or null, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Properties must be persisted to crumb_properties table\n- Crumb.Properties map must be populated after creation\n- If crumb already has a property value set explicitly, do not override with default\n\n## Design Decisions\n- Auto-init happens inside the Set transaction so it is atomic\n- Query properties table for all defined properties, compute defaults, insert into crumb_properties\n- Only on create (empty ID), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.53792-05:00","created_by":"petardjukic","updated_at":"2026-02-12T22:59:00.998206-05:00","closed_at":"2026-02-12T22:59:00.998206-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-bpu","depends_on_id":"generation-2026-02-13-07-56-44-mdx","type":"blocks","created_at":"2026-02-12T14:57:07.680208-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-bul","title":"Implement integration tests for rel03.0-uc004-trail-crumb-lifecycle","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc004-trail-crumb-lifecycle.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.0-uc004-trail-crumb-lifecycle.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail lifecycle semantics)\n- docs/specs/product-requirements/prd007-links-interface.yaml (belongs_to cardinality)\n- pkg/types/trail.go (Complete and Abandon methods)\n- internal/sqlite/trails_table.go (cascadeTrailCompleted, cascadeTrailAbandoned)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (related test pattern, dependency)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc004_trail_crumb_lifecycle_test.go (create)\n\n## Requirements\nImplement the 28 test cases from test-rel03.0-uc004-trail-crumb-lifecycle.yaml that validate:\n- Crumbs associate with trails via belongs_to links in the links table (TC01-TC03)\n- A crumb can belong to at most one trail at a time (cardinality enforced) (TC04-TC06)\n- Fetch with belongs_to filter returns all crumbs belonging to a trail (TC07-TC09)\n- Crumbs can be moved between trails by deleting and recreating belongs_to links (TC10-TC12)\n- trail.Complete() followed by Table.Set removes all belongs_to links for that trail (TC13-TC15)\n- After completion, crumbs persist and have no belongs_to links (they are permanent) (TC16-TC18)\n- trail.Abandon() followed by Table.Set deletes all crumbs that belong to the trail (TC19-TC21)\n- Cascade deletion removes crumb properties, metadata, and all links involving the crumb (TC22-TC24)\n- Trail remains in database after abandonment (for audit) but has no associated crumbs (TC25-TC26)\n- Complete and Abandon require trail to be in active state (ErrInvalidState otherwise) (TC27-TC28)\n\n## Design Decisions\n- Use table-driven test pattern: one TestTrailCrumbLifecycle function with subtests for each YAML test case\n- Test cardinality constraint by attempting to create duplicate belongs_to links and asserting unique constraint violation\n- Verify cascade deletion by querying crumb_properties, metadata, and links tables after trail abandonment\n- Use transactions for setup to ensure atomic test state initialization\n- Follow existing test patterns from test_rel03_0_uc001_trail_exploration_test.go\n\n## Acceptance Criteria\n- [ ] All 28 test cases from test-rel03.0-uc004-trail-crumb-lifecycle.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestTrailCrumbLifecycle\n- [ ] Test file saved as test_rel03_0_uc004_trail_crumb_lifecycle_test.go\n- [ ] Assertions verify success criteria S1-S10 from use case\n- [ ] Cascade deletion verified across all affected tables (crumbs, crumb_properties, metadata, links)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.06306-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:22:40.446883-05:00","closed_at":"2026-02-13T01:22:40.446883-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-bul","depends_on_id":"generation-2026-02-13-07-56-44-z5j","type":"blocks","created_at":"2026-02-13T01:09:07.942595-05:00","created_by":"petardjukic"}],"comments":[{"id":126,"issue_id":"generation-2026-02-13-07-56-44-bul","author":"petardjukic","text":"duration: 7m35s | tokens: in=49 out=32520 | loc: +1877 -1 files=2","created_at":"2026-02-13T06:22:40Z"}]}
{"id":"generation-2026-02-13-07-56-44-bw9","title":"Create test suite for rel03.0-uc003-stash-operations","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (use case spec with flow and success criteria)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash entity, types, methods, history)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (SQLite schema, stash_history table)\n- pkg/types/stash.go (Stash struct, methods: SetValue, GetValue, Increment, Acquire, Release)\n- internal/sqlite/stashes_table.go (existing implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (example table-driven test structure)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (create)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (create)\n\n## Requirements\n- Create YAML test suite spec per test-case-format rule with:\n  - id: test-rel03.0-uc003-stash-operations\n  - traces: [rel03.0-uc003-stash-operations]\n  - preconditions: Cupboard attached with SQLite backend, stashes table accessible\n  - test_cases covering all flow steps F1-F23 from the use case\n- Write Go integration test file with table-driven tests validating:\n  - Stash creation for all five types (resource, artifact, context, counter, lock) (S1-S2)\n  - SetValue updates value and increments Version, returns ErrInvalidStashType for lock (S3-S4)\n  - GetValue returns current value or nil (S4)\n  - Increment adds delta to counter, increments Version, returns ErrInvalidStashType for non-counter (S5-S6)\n  - Acquire sets holder and increments Version, returns ErrLockHeld if held by different holder (S7)\n  - Acquire by same holder succeeds (reentrant) (S8)\n  - Release clears lock and increments Version, returns ErrNotLockHolder if wrong holder (S9)\n  - Version starts at 1 and increments on every mutation (S10)\n  - Fetch with stash_type and name filters returns correct results (S11-S12)\n  - Delete removes stash and subsequent Get returns ErrNotFound (S13)\n  - History entries created for each mutation and queryable by stash ID (S14-S15)\n\n## Design Decisions\n- Use table-driven tests to avoid repeating setup/teardown logic\n- Each YAML test case maps to one row in the Go table\n- Test each stash type with concrete value examples from prd008-stash-interface R2.1\n- Test counter operations with both positive and negative deltas\n- Test lock contention and reentrant acquire\n- Validate history tracking by calling FetchStashHistory (backend method)\n\n## Acceptance Criteria\n- [ ] YAML test suite exists at docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml\n- [ ] Go test file exists at tests/integration/test_rel03_0_uc003_stash_operations_test.go\n- [ ] All success criteria S1-S15 from the use case have corresponding test cases\n- [ ] Tests pass: go test -v ./tests/integration -run TestStashOperations\n- [ ] Test file uses table-driven pattern per go-style rule\n- [ ] YAML traces field references rel03.0-uc003-stash-operations\n- [ ] History queries use FetchStashHistory method from internal/sqlite stashes table","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.814275-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:46:11.92997-05:00","closed_at":"2026-02-13T01:46:11.92997-05:00","close_reason":"Closed","comments":[{"id":127,"issue_id":"generation-2026-02-13-07-56-44-bw9","author":"petardjukic","text":"duration: 7m41s | tokens: in=44 out=34337 | loc: +1083 -1 files=3","created_at":"2026-02-13T06:46:11Z"}]}
{"id":"generation-2026-02-13-07-56-44-c08","title":"Add benchmark suite for properties table operations (rel02.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc002-table-benchmarks.yaml (property benchmark requirements)\n- docs/specs/test-suites/test-rel02.1-uc002-table-benchmarks.yaml (property test cases)\n- internal/sqlite/properties_table.go (implementation to benchmark)\n- internal/sqlite/crumbs_bench_test.go (benchmark pattern from crumbs suite)\n\n## Files to Create/Modify\n- internal/sqlite/properties_bench_test.go (create) — benchmark suite for properties table\n\n## Requirements\n- Implement property Get benchmarks at scale: BenchmarkPropertiesGet10, Get100, Get1000\n- Implement property Set benchmarks for create: BenchmarkPropertiesSetCreate10, SetCreate100\n- Implement property Fetch benchmarks: BenchmarkPropertiesFetchAll, FetchByValueType\n- Implement category Get benchmarks: BenchmarkCategoriesGet10, Get100\n- Implement category Fetch benchmarks: BenchmarkCategoriesFetchByProperty\n- Seed properties and categories before b.ResetTimer()\n- Measure JSONL sync overhead for properties.jsonl and categories.jsonl\n\n## Design Decisions\n- Follow same pattern as crumbs benchmarks\n- Properties have fewer expected than crumbs, so smaller scale (10, 100, 1000 vs 10000)\n- Categories benchmarks measure ordinal ordering performance\n- Use temp directories per benchmark suite\n\n## Acceptance Criteria\n- [ ] go test -bench=BenchmarkProperties -benchmem ./internal/sqlite/... runs without error\n- [ ] go test -bench=BenchmarkCategories -benchmem ./internal/sqlite/... runs without error\n- [ ] All benchmarks report ns/op, B/op, allocs/op\n- [ ] Benchmarks execute without error\n- [ ] Results appended to baseline.txt","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.353664-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:37:36.329322-05:00","closed_at":"2026-02-13T00:37:36.329322-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-c08","depends_on_id":"generation-2026-02-13-07-56-44-3cu","type":"blocks","created_at":"2026-02-12T22:15:48.245908-05:00","created_by":"petardjukic"}],"comments":[{"id":128,"issue_id":"generation-2026-02-13-07-56-44-c08","author":"petardjukic","text":"duration: 1h21m22s | tokens: in=38 out=7085 | loc: +285 -1 files=3","created_at":"2026-02-13T05:37:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-c14","title":"Update .claude/rules with cupboard workflow (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F8 agent workflow rule)\n- .claude/rules/beads-workflow.md (current workflow reference)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (CLI commands)\n\n## Files to Create/Modify\n- .claude/rules/cupboard-workflow.md (create) — cupboard workflow for agents\n- .claude/rules/beads-workflow.md (modify) — deprecate or reference cupboard\n\n## Requirements\n- Document cupboard commands for agent workflow:\n  - `cupboard ready` to find available work\n  - `cupboard show \u003cid\u003e` to view issue details\n  - `cupboard update \u003cid\u003e --status in_progress` to claim work\n  - `cupboard comments add \u003cid\u003e \"tokens: \u003ccount\u003e\"` to log token usage\n  - `cupboard close \u003cid\u003e` to close work\n- Document landing the plane workflow with cupboard\n- Document token tracking per issue\n- Document LOC and documentation tracking per issue\n- Document commit message format with stats block\n- Document offline workflow (no git push)\n- Include quick reference section\n\n## Design Decisions\n- New rule file instead of modifying beads-workflow to keep migration path clear\n- Examples use real cupboard CLI syntax\n- Workflow instructions match beads pattern for agent familiarity\n- Emphasize --json flag for machine-readable output\n\n## Acceptance Criteria\n- [ ] cupboard-workflow.md created with complete workflow instructions\n- [ ] Quick reference section lists all commands\n- [ ] Token tracking section explains comment format\n- [ ] Stats tracking section explains mage stats usage\n- [ ] Commit message format documented with examples\n- [ ] Offline workflow clarified (commit works, no push)\n- [ ] beads-workflow.md updated to reference cupboard as migration path","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.074544-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:45:32.099318-05:00","closed_at":"2026-02-13T00:45:32.099318-05:00","close_reason":"Closed","comments":[{"id":129,"issue_id":"generation-2026-02-13-07-56-44-c14","author":"petardjukic","text":"duration: 1m53s | tokens: in=32 out=4293 | loc: +224 -1 files=3","created_at":"2026-02-13T05:45:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-c5f","title":"Mark rel01.1-uc001-go-install as done and add JSONL roundtrip test (rel01.1-uc002)","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc002-jsonl-git-roundtrip.yaml (S1-S14 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc002-jsonl-git-roundtrip.yaml (28 test cases)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (already exists and passes)\n- internal/sqlite/backend.go (Attach/Detach, sync strategies)\n- internal/sqlite/jsonl.go (JSONL persistence)\n- internal/sqlite/loader.go (JSONL loading on startup)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R4 startup, R5 persistence, R14 sync)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.1-uc001 as done (tests already pass), mark rel01.1-uc002 as done after tests pass\n\n## Requirements\n- S1-S5: JSONL files created, content correct, committable to git, cupboard.db gitignored\n- S6-S9: Database deletion and rebuild (delete cupboard.db, re-attach, verify data intact)\n- S10-S11: State changes persist to JSONL and survive rebuild cycles\n- S12: on_close sync strategy defers writes until Detach\n- S13: batch sync strategy flushes at threshold\n- S14: immediate sync strategy (default) persists every write\n- Test via Go API (Cupboard.Attach, GetTable, Table.Set/Get/Fetch/Delete) with temp dirs\n- Simulate git roundtrip by creating data, deleting DB, and re-attaching\n\n## Design Decisions\n- Use Go API directly (not git CLI) for roundtrip simulation\n- Create JSONL data, delete cupboard.db file, re-Attach to verify reload\n- Test sync strategies by configuring Backend with different SyncStrategy values\n- Table-driven tests grouped by success criteria\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S14 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestJSONLGitRoundtrip\n- [ ] road-map.yaml marks rel01.1-uc001 as done and rel01.1-uc002 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.108552-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:10:48.471563-05:00","closed_at":"2026-02-12T18:10:48.471563-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-cc8","title":"Update road-map.yaml to mark rel02.1-uc001 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc001 status to done\n\n## Requirements\n- Change rel02.1-uc001-issue-tracking-cli status from \"not_started\" to \"done\"\n- Verify all success criteria from use case are implemented\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after all CLI commands implemented and tests pass\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc001-issue-tracking-cli status is \"done\" in road-map.yaml\n- [ ] All seven issue-tracking CLI commands implemented\n- [ ] Integration tests pass for the use case\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.361958-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:53:46.985928-05:00","closed_at":"2026-02-13T00:53:46.985928-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-cc8","depends_on_id":"generation-2026-02-13-07-56-44-di2","type":"blocks","created_at":"2026-02-12T22:15:48.447028-05:00","created_by":"petardjukic"}],"comments":[{"id":130,"issue_id":"generation-2026-02-13-07-56-44-cc8","author":"petardjukic","text":"duration: 1m35s | tokens: in=39 out=2322 | loc: +2 -2 files=2","created_at":"2026-02-13T05:53:46Z"}]}
{"id":"generation-2026-02-13-07-56-44-cpg","title":"Add unit tests for built-in property seeding","description":"## Required Reading\n- internal/sqlite/seed.go (SeedBuiltinProperties)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml R9\n- docs/specs/product-requirements/prd004-properties-interface.yaml R9\n\n## Files to Create/Modify\n- internal/sqlite/seed_test.go (create)\n\n## Requirements\n- Test SeedBuiltinProperties: on fresh attach, 5 built-in properties exist (priority, type, description, owner, labels)\n- Test property types: priority=categorical, type=categorical, description=text, owner=text, labels=list\n- Test categories: priority has 5 categories (highest, high, medium, low, lowest), type has 4 categories (task, epic, bug, chore)\n- Test idempotency: seeding on non-empty properties.jsonl is a no-op\n\n## Design Decisions\n- Use real Backend attach to trigger seeding\n- Verify via GetTable(\"properties\").Fetch and GetTable(\"categories\").Fetch\n\n## Acceptance Criteria\n- [ ] All 5 built-in properties exist after fresh attach\n- [ ] Correct value types for each property\n- [ ] Correct categories for categorical properties\n- [ ] Seeding idempotent\n- [ ] Tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.33415-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:50:01.004035-05:00","closed_at":"2026-02-13T17:50:01.004035-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-cpg","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.821366-05:00","created_by":"petardjukic"}],"comments":[{"id":53,"issue_id":"generation-2026-02-13-07-56-44-cpg","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":91,"issue_id":"generation-2026-02-13-07-56-44-cpg","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:47:50Z\",\"duration_s\":130,\"tokens\":{\"input\":17,\"output\":6195},\"loc_before\":{\"production\":6101,\"test\":7416},\"loc_after\":{\"production\":6101,\"test\":7610},\"diff\":{\"files\":2,\"insertions\":195,\"deletions\":1}}","created_at":"2026-02-13T22:50:00Z"}]}
{"id":"generation-2026-02-13-07-56-44-czg","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n\n## Requirements\n- Test that JSONL files with unknown fields load without error (S1-S2)\n- Test that crumb data survives a simulated regeneration cycle (S3-S4)\n- Test that adding a new property to existing JSONL data works (S5)\n- Test that removing a field from struct still loads old JSONL (S6)\n- Test concurrent JSONL access from two cupboard instances (S7, if applicable)\n- Test that JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via Cupboard.Attach\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002-regeneration-compatibility as done (after all tests pass)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.208654-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:56:20.66421-05:00","closed_at":"2026-02-12T17:56:20.66421-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-czg","depends_on_id":"generation-2026-02-13-07-56-44-2j0","type":"blocks","created_at":"2026-02-12T14:57:08.182681-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-dc3","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- cmd/cupboard/helpers.go (attachBackend, error checkers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from helpers.go\n- Reuse isTableNotFound() and isEntityNotFound() helpers\n- Follow the pattern established by get.go\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Command registered in root.go init()\n- [ ] `go build ./cmd/cupboard` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.556295-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:34:27.588474-05:00","closed_at":"2026-02-12T12:34:27.588474-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-di2","title":"Add integration test for issue-tracking CLI end-to-end flow (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F1-F14 flows, S1-S10)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (all test cases)\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (CLI test pattern)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc001_issue_tracking_cli_test.go (create)\n\n## Requirements\n- Build cupboard binary once for test suite\n- Test F1: Initialize cupboard with config.yaml and CUPBOARD_CONFIG env var\n- Test F2-F4: Create task, epic with various flags; verify JSON output\n- Test F5: List all crumbs via cupboard list --json\n- Test F6: Show specific crumb via cupboard show \u003cid\u003e\n- Test F7: Find available work via cupboard ready --json --type task\n- Test F8-F9: Update task status via cupboard update and verify with show\n- Test F10-F11: Add comment and verify it appears in show output\n- Test F12-F14: Close task and verify state change, exclusion from ready\n- Use os/exec to run cupboard binary\n- Parse JSON output to verify expected fields and values\n- Use temp directories for each test case\n\n## Design Decisions\n- Integration tests run real cupboard binary, not library calls\n- Each test case starts from fresh cupboard (temp data directory)\n- Tests verify both JSON output and human-readable output where applicable\n- Tests use table-driven pattern mapping to YAML test cases\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S10 from the use case\n- [ ] Tests build cupboard binary once per suite\n- [ ] Tests use temp directories and clean up\n- [ ] Tests verify JSON output structure and values\n- [ ] Tests verify state transitions (draft → ready → taken → pebble)\n- [ ] Tests verify filters (ready excludes closed, type filter works)\n- [ ] All tests pass with go test ./tests/integration/... -run TestIssueTrackingCLI\n- [ ] Tests are independent and can run in any order","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.221341-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:52:10.94139-05:00","closed_at":"2026-02-13T00:52:10.94139-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-di2","depends_on_id":"generation-2026-02-13-07-56-44-b6c","type":"blocks","created_at":"2026-02-12T22:15:48.347635-05:00","created_by":"petardjukic"}],"comments":[{"id":131,"issue_id":"generation-2026-02-13-07-56-44-di2","author":"petardjukic","text":"duration: 6m38s | tokens: in=50 out=23694 | loc: +718 -1 files=2","created_at":"2026-02-13T05:52:10Z"}]}
{"id":"generation-2026-02-13-07-56-44-dse","title":"Create test suite for rel03.0-uc002-link-management","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (use case spec with flow and success criteria)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link entity, CRUD, filter keys, uniqueness)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (SQLite schema, indexes)\n- pkg/types/link.go (Link struct and constants)\n- internal/sqlite/links_table.go (existing implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (example table-driven test structure)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (create)\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (create)\n\n## Requirements\n- Create YAML test suite spec per test-case-format rule with:\n  - id: test-rel03.0-uc002-link-management\n  - traces: [rel03.0-uc002-link-management]\n  - preconditions: Cupboard attached with SQLite backend, crumbs/trails/stashes tables accessible\n  - test_cases covering all flow steps F1-F19 from the use case\n- Write Go integration test file with table-driven tests validating:\n  - Link creation via Table.Set generates UUID v7 (S1)\n  - belongs_to, child_of, branches_from, scoped_to link types work correctly (S2-S5)\n  - Fetch with link_type, from_id, to_id filters returns correct results (S6-S8)\n  - Delete removes link and subsequent Get returns ErrNotFound (S9-S10)\n  - Uniqueness constraint enforced for (link_type, from_id, to_id)\n  - All link CRUD operations work through Table interface\n\n## Design Decisions\n- Use table-driven tests to avoid repeating setup/teardown logic\n- Each YAML test case maps to one row in the Go table\n- Create prerequisite entities (crumbs, trails, stashes) in test setup\n- Test all four link types with concrete examples\n- Validate filter combinations (single key, multiple keys ANDed)\n\n## Acceptance Criteria\n- [ ] YAML test suite exists at docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml\n- [ ] Go test file exists at tests/integration/test_rel03_0_uc002_link_management_test.go\n- [ ] All success criteria S1-S10 from the use case have corresponding test cases\n- [ ] Tests pass: go test -v ./tests/integration -run TestLinkManagement\n- [ ] Test file uses table-driven pattern per go-style rule\n- [ ] YAML traces field references rel03.0-uc002-link-management","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:33:39.685323-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:38:30.417519-05:00","closed_at":"2026-02-13T01:38:30.417519-05:00","close_reason":"Closed","comments":[{"id":132,"issue_id":"generation-2026-02-13-07-56-44-dse","author":"petardjukic","text":"duration: 4m50s | tokens: in=73 out=17825 | loc: +714 -1 files=2","created_at":"2026-02-13T06:38:30Z"}]}
{"id":"generation-2026-02-13-07-56-44-dtl","title":"Complete link CRUD test coverage (branches_from, scoped_to)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC7-TC10)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R2: Link types, R3: CRUD)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F7-F10)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (implementation to test)\n- pkg/types/stash.go (Stash entity for scoped_to tests)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S4, S5)\n\n## Requirements\nImplement integration test cases validating:\n1. branches_from link creation and verification (success criterion S4)\n   - Create trail and crumb\n   - Create branches_from link (from_id=trail_id, to_id=crumb_id)\n   - Verify link indicates trail branch point\n   - Verify link is retrievable via Table.Get\n2. scoped_to link creation and verification (success criterion S5)\n   - Create stash and trail\n   - Create scoped_to link (from_id=stash_id, to_id=trail_id)\n   - Verify link scopes stash to trail\n   - Verify link is retrievable via Table.Get\n\nTest cases must follow table-driven pattern and validate prd007-links-interface R2 (link types and semantics).\n\n## Design Decisions\n- Use existing test helpers plus createTestStash for scoped_to tests\n- Follow existing test naming: TestLinkManagement_\u003cScenario\u003e\n- Each test case creates its own prerequisite entities to ensure isolation\n- Validate both successful link creation and retrieval in each test\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_BranchesFromLinkIndicatesTrailBranchPoint passes\n- [ ] TestLinkManagement_ScopedToLinkScopesStashToTrail passes\n- [ ] Both test cases verify all Link struct fields (LinkID, LinkType, FromID, ToID, CreatedAt)\n- [ ] Test cases follow table-driven pattern per go-style rule\n- [ ] Tests validate prd007-links-interface R2.1 semantics for branches_from and scoped_to\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.003165-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:54:16.499561-05:00","closed_at":"2026-02-13T01:54:16.499561-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-dtl","depends_on_id":"generation-2026-02-13-07-56-44-gi1","type":"blocks","created_at":"2026-02-13T01:50:43.576449-05:00","created_by":"petardjukic"}],"comments":[{"id":133,"issue_id":"generation-2026-02-13-07-56-44-dtl","author":"petardjukic","text":"duration: 1m58s | tokens: in=33 out=5984 | loc: +77 -1 files=2","created_at":"2026-02-13T06:54:16Z"}]}
{"id":"generation-2026-02-13-07-56-44-e08","title":"Add integration tests for issue-tracking CLI (rel02.1-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (25+ test cases)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc001_issue_tracking_cli_test.go (create)\n\n## Requirements\n- Test `cupboard create`: with type, title, description; JSON output; missing title fails\n- Test `cupboard ready`: lists ready crumbs, filters by type, --json output\n- Test `cupboard show \u003cid\u003e`: displays crumb details, --json output\n- Test `cupboard update \u003cid\u003e`: change status, title, description, labels\n- Test `cupboard close \u003cid\u003e`: transitions to pebble state\n- Test `cupboard comments add \u003cid\u003e \"text\"`: adds metadata comment\n- Test full workflow: create → update status → add comment → close\n- Test error cases: show non-existent, close already closed, create without type\n\n## Design Decisions\n- Table-driven tests grouped by command\n- Test both human-readable and JSON output\n\n## Acceptance Criteria\n- [ ] All 7 issue-tracking commands tested\n- [ ] JSON output format verified\n- [ ] Error cases return correct exit codes\n- [ ] Full workflow end-to-end\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.934441-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:57:48.688804-05:00","closed_at":"2026-02-13T18:57:48.688804-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-e08","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.625882-05:00","created_by":"petardjukic"}],"comments":[{"id":64,"issue_id":"generation-2026-02-13-07-56-44-e08","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"},{"id":102,"issue_id":"generation-2026-02-13-07-56-44-e08","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:44:23Z\",\"duration_s\":805,\"tokens\":{\"input\":69,\"output\":34640},\"loc_before\":{\"production\":6108,\"test\":12356},\"loc_after\":{\"production\":6208,\"test\":12983},\"diff\":{\"files\":7,\"insertions\":754,\"deletions\":27}}","created_at":"2026-02-13T23:57:48Z"}]}
{"id":"generation-2026-02-13-07-56-44-e20","title":"Update road-map.yaml to mark rel02.1-uc004 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc004 status to done\n\n## Requirements\n- Change rel02.1-uc004-metadata-lifecycle status from \"not_started\" to \"done\"\n- Verify all success criteria from use case are implemented\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after metadata table implemented and tests pass\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc004-metadata-lifecycle status is \"done\" in road-map.yaml\n- [ ] Metadata table fully implemented with cascade delete\n- [ ] Integration tests pass for metadata lifecycle\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.518002-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:54:42.688926-05:00","closed_at":"2026-02-13T00:54:42.688926-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-e20","depends_on_id":"generation-2026-02-13-07-56-44-748","type":"blocks","created_at":"2026-02-12T22:15:48.549556-05:00","created_by":"petardjukic"}],"comments":[{"id":134,"issue_id":"generation-2026-02-13-07-56-44-e20","author":"petardjukic","text":"duration: 55s | tokens: in=37 out=1774 | loc: +2 -2 files=2","created_at":"2026-02-13T05:54:42Z"}]}
{"id":"generation-2026-02-13-07-56-44-e7w","title":"Add unit tests for Link and Property validation helpers (pkg/types)","description":"## Required Reading\n- pkg/types/link.go (Link struct, ValidLinkType)\n- pkg/types/property.go (Property struct, ValidValueType)\n- pkg/types/category.go (Category struct)\n- pkg/types/metadata.go (Metadata struct)\n- pkg/types/config.go (Config struct, Validate)\n- pkg/types/constants.go\n\n## Files to Create/Modify\n- pkg/types/validation_test.go (create)\n\n## Requirements\n- Test ValidLinkType: all four valid types return true (belongs_to, child_of, branches_from, scoped_to)\n- Test ValidLinkType: invalid string returns false\n- Test ValidValueType: all six valid types return true (categorical, text, integer, boolean, timestamp, list)\n- Test ValidValueType: invalid string returns false\n- Test Config.Validate: valid config passes, empty Backend fails, unknown Backend fails, empty DataDir fails\n\n## Design Decisions\n- Table-driven tests per go-style rule\n\n## Acceptance Criteria\n- [ ] All validation helpers tested for valid and invalid inputs\n- [ ] Config validation tested\n- [ ] Tests pass with `go test ./pkg/types/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.43231-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:00:32.950442-05:00","closed_at":"2026-02-13T14:00:32.950442-05:00","close_reason":"Closed","comments":[{"id":41,"issue_id":"generation-2026-02-13-07-56-44-e7w","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":80,"issue_id":"generation-2026-02-13-07-56-44-e7w","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:59:30Z\",\"duration_s\":62,\"tokens\":{\"input\":10,\"output\":2959},\"loc_before\":{\"production\":6072,\"test\":814},\"loc_after\":{\"production\":6072,\"test\":923},\"diff\":{\"files\":2,\"insertions\":110,\"deletions\":1}}","created_at":"2026-02-13T19:00:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-eow","title":"Define Crumb property methods and remaining entity structs in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R5 property methods)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail struct)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property and Category structs)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml (Metadata struct)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link struct)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash struct)\n- pkg/types/crumb.go (existing Crumb struct)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (modify) - Add property methods: SetProperty, GetProperty, GetProperties, ClearProperty\n- pkg/types/trail.go (create) - Trail struct with ID, State, CreatedAt, CompletedAt; Complete() and Abandon() methods\n- pkg/types/property.go (create) - Property struct, Category struct, value type constants, built-in property names\n- pkg/types/metadata.go (create) - Metadata struct, Schema struct, built-in schema constants\n- pkg/types/link.go (create) - Link struct, link type constants (belongs_to, child_of, branches_from, scoped_to)\n- pkg/types/stash.go (create) - Stash struct, StashHistoryEntry struct, stash type constants, stash methods\n- pkg/types/errors.go (create) - Entity-specific errors not already in table.go (ErrInvalidState, ErrInvalidTransition, ErrInvalidName, ErrPropertyNotFound, ErrTypeMismatch, ErrInvalidCategory, etc.)\n\n## Requirements\n- Crumb property methods per prd003 R5: SetProperty, GetProperty, GetProperties, ClearProperty\n- Trail struct per prd006: TrailID, State, CreatedAt, CompletedAt (*time.Time); Complete(), Abandon() methods\n- Property and Category structs per prd004\n- Metadata struct per prd005\n- Link struct with link type constants per prd007\n- Stash and StashHistoryEntry structs per prd008\n- All entity-specific sentinel errors from prd001 R7.3\n\n## Design Decisions\n- Keep entity errors centralized in errors.go for discoverability\n- Property methods on Crumb do basic checks (key exists in map); full validation deferred to Table.Set\n- Trail.Complete requires active state; Trail.Abandon requires active state per prd006\n\n## Acceptance Criteria\n- [ ] Crumb property methods compile and modify Properties map\n- [ ] Trail struct with lifecycle methods compiles\n- [ ] Property, Category, Metadata, Link, Stash structs all compile with correct fields\n- [ ] All entity-specific errors defined\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.858479-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:27:10.750698-05:00","closed_at":"2026-02-12T07:27:10.750698-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-eow","depends_on_id":"generation-2026-02-13-07-56-44-g72","type":"blocks","created_at":"2026-02-12T07:18:37.012621-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-fg1","title":"Update SPECIFICATIONS.md after completing rel02.1","description":"## Required Reading\n- docs/SPECIFICATIONS.md (current specifications summary)\n- docs/road-map.yaml (updated with rel02.1 done)\n- .claude/rules/specification-format.md (specification document format)\n- All rel02.1 use cases and test suites\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (modify) — regenerate to reflect rel02.1 completion\n\n## Requirements\n- Update roadmap summary table to show rel02.1 as done (4/4 use cases)\n- Verify all use cases in use case index reflect correct status\n- Verify traceability diagram includes all rel02.1 artifacts\n- Check for coverage gaps (should be none for rel02.1)\n- Regenerate by reading all files in specs/ and road-map.yaml\n- Do not rely on stale content from previous SPECIFICATIONS.md\n\n## Design Decisions\n- SPECIFICATIONS.md is a generated artifact, regenerate fully\n- Include all PRDs, use cases, test suites in indexes\n- Traceability diagram shows relationships between artifacts\n- Coverage gaps section lists any missing test suites or untraced PRDs\n\n## Acceptance Criteria\n- [ ] Roadmap summary shows rel02.1 as done with 4/4 use cases\n- [ ] Use case index shows all rel02.1 use cases as done\n- [ ] PRD-to-use-case mapping includes all rel02.1 touchpoints\n- [ ] Traceability diagram includes rel02.1 artifacts\n- [ ] Coverage gaps section updated (should be empty for rel02.1)\n- [ ] File follows specification-format.md structure\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:48.131317-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:06:38.27777-05:00","closed_at":"2026-02-13T01:06:38.27777-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-fg1","depends_on_id":"generation-2026-02-13-07-56-44-hcg","type":"blocks","created_at":"2026-02-12T22:15:48.998169-05:00","created_by":"petardjukic"}],"comments":[{"id":135,"issue_id":"generation-2026-02-13-07-56-44-fg1","author":"petardjukic","text":"duration: 3m28s | tokens: in=44 out=15003 | loc: +10 -10 files=2","created_at":"2026-02-13T06:06:38Z"}]}
{"id":"generation-2026-02-13-07-56-44-ftu","title":"Add unit tests for Backend lifecycle (Attach/Detach/GetTable)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (lifecycle test cases)\n- internal/sqlite/backend.go (implementation under test)\n- internal/sqlite/testutil_test.go (shared test helpers)\n- pkg/types/cupboard.go (Cupboard interface)\n- pkg/types/config.go (Config struct)\n\n## Files to Create/Modify\n- internal/sqlite/backend_test.go (create)\n\n## Requirements\n- Test Attach: valid config creates DataDir, initializes DB, returns nil\n- Test Attach: invalid config (empty backend, empty data dir) returns validation error\n- Test Attach: already attached returns ErrAlreadyAttached\n- Test Attach: creates DataDir if it does not exist\n- Test Detach: normal detach returns nil\n- Test Detach: double detach is idempotent (no error)\n- Test Detach: operations after detach return ErrCupboardDetached\n- Test GetTable: all seven standard table names return non-nil Table\n- Test GetTable: unknown table name returns ErrTableNotFound\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Reuse testutil_test.go helper for setup\n\n## Acceptance Criteria\n- [ ] Attach tests cover valid and invalid configs\n- [ ] Detach tests verify idempotency and post-detach errors\n- [ ] GetTable tests verify all standard table names and unknown name\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.244178-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:15:24.257216-05:00","closed_at":"2026-02-13T14:15:24.257216-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ftu","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.090644-05:00","created_by":"petardjukic"}],"comments":[{"id":46,"issue_id":"generation-2026-02-13-07-56-44-ftu","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":85,"issue_id":"generation-2026-02-13-07-56-44-ftu","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T19:14:00Z\",\"duration_s\":83,\"tokens\":{\"input\":14,\"output\":4955},\"loc_before\":{\"production\":6101,\"test\":2573},\"loc_after\":{\"production\":6101,\"test\":2734},\"diff\":{\"files\":2,\"insertions\":162,\"deletions\":1}}","created_at":"2026-02-13T19:15:24Z"}]}
{"id":"generation-2026-02-13-07-56-44-g72","title":"Define Crumb entity struct and state transition methods in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R1, R2, R4)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R7.3 for entity method errors)\n- pkg/types/table.go (error types already defined)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (create) - Crumb struct, state constants, state transition methods\n\n## Requirements\n- Crumb struct: CrumbID (string), Name (string), State (string), CreatedAt (time.Time), UpdatedAt (time.Time), Properties (map[string]any)\n- State constants: draft, pending, ready, taken, pebble, dust\n- Valid states set for validation\n- SetState(state string) error: validates state is valid, updates State and UpdatedAt; idempotent; returns ErrInvalidState for invalid state\n- Pebble() error: requires current state is \"taken\", sets State to pebble, updates UpdatedAt; returns ErrInvalidTransition otherwise\n- Dust() error: sets State to dust from any state, updates UpdatedAt; idempotent\n\n## Design Decisions\n- State as string (not Go enum) for JSON compatibility per prd003 R2.4\n- Entity methods modify struct in memory; caller calls Table.Set to persist\n- Use a validStates map for O(1) lookup\n\n## Acceptance Criteria\n- [ ] Crumb struct has all 6 fields per prd003 R1.1\n- [ ] 6 state constants defined\n- [ ] SetState validates and transitions correctly\n- [ ] Pebble requires \"taken\" state, returns ErrInvalidTransition otherwise\n- [ ] Dust works from any state, is idempotent\n- [ ] All methods update UpdatedAt\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:35.726714-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:22:46.725029-05:00","closed_at":"2026-02-12T07:22:46.725029-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-g72","depends_on_id":"generation-2026-02-13-07-56-44-57l","type":"blocks","created_at":"2026-02-12T07:18:36.913338-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-gi1","title":"Complete link CRUD test coverage (belongs_to, child_of)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC2-TC6)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R1-R3: Link struct, types, CRUD)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F1-F6)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (implementation to test)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S2, S3)\n\n## Requirements\nImplement integration test cases validating:\n1. belongs_to link creation and verification (success criterion S2)\n   - Create crumb and trail\n   - Create belongs_to link (from_id=crumb_id, to_id=trail_id)\n   - Verify link fields: link_type, from_id, to_id, created_at\n   - Verify link is retrievable via Table.Get\n2. child_of link creation and verification (success criterion S3)\n   - Create parent and child crumbs\n   - Create child_of link (from_id=child, to_id=parent)\n   - Verify link establishes crumb hierarchy\n   - Verify link is retrievable via Table.Get\n\nTest cases must follow table-driven pattern and validate prd007-links-interface R2 (link types and semantics).\n\n## Design Decisions\n- Use existing test helpers (newAttachedBackend, createTestCrumb, createTestTrail)\n- Follow existing test naming: TestLinkManagement_\u003cScenario\u003e\n- Each test case creates its own prerequisite entities to ensure isolation\n- Validate both successful link creation and retrieval in each test\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_BelongsToLinkAssociatesCrumbWithTrail passes\n- [ ] TestLinkManagement_ChildOfLinkEstablishesCrumbHierarchy passes\n- [ ] Both test cases verify all Link struct fields (LinkID, LinkType, FromID, ToID, CreatedAt)\n- [ ] Test cases follow table-driven pattern per go-style rule\n- [ ] Tests validate prd007-links-interface R2.1 semantics for belongs_to and child_of\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:41.867983-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:52:18.202605-05:00","closed_at":"2026-02-13T01:52:18.202605-05:00","close_reason":"Closed","comments":[{"id":136,"issue_id":"generation-2026-02-13-07-56-44-gi1","author":"petardjukic","text":"duration: 1m33s | tokens: in=27 out=4934 | loc: +77 -1 files=2","created_at":"2026-02-13T06:52:18Z"}]}
{"id":"generation-2026-02-13-07-56-44-grm","title":"Implement property auto-initialization on crumb creation","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 auto-initialization, R8 enforcement)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S4-S6 auto-init)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 4-6)\n- internal/sqlite/crumbs_table.go (Set method, lines 53-125)\n- internal/sqlite/properties_table.go (property operations, default value logic)\n- internal/sqlite/seed.go (built-in property seeding)\n- pkg/types/crumb.go (Crumb struct, Properties field)\n\n## Files to Create/Modify\n- internal/sqlite/crumbs_table.go (modify) — add auto-init in Set when creating new crumb (id == \"\")\n- internal/sqlite/crumbs_table_test.go (modify or create) — unit tests for auto-init\n\n## Requirements\n- When Set creates a new crumb (empty ID), query all defined properties\n- For each property, insert a crumb_properties row with the type default value\n- Type defaults per prd004: categorical=first category value, text=\"\", integer=0, boolean=false, timestamp=null, list=[]\n- Auto-init happens inside the Set transaction (atomic with crumb creation)\n- If crumb already has explicit property values in Properties map, do not override\n- Populate crumb.Properties map with initialized values before returning\n\n## Design Decisions\n- Auto-init runs within the same transaction as the INSERT\n- Query properties table for all defined properties, compute defaults using existing defaultValueJSON helper\n- Use INSERT OR IGNORE for crumb_properties to avoid conflicts\n- Only on create (id == \"\"), not on update\n\n## Acceptance Criteria\n- [ ] New crumb has all defined properties initialized with type defaults\n- [ ] Explicitly set property values are not overridden by defaults\n- [ ] Properties appear in Crumb.Properties map after Get\n- [ ] Unit tests verify auto-init for each value type\n- [ ] Existing crumb tests continue to pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.242959-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:16:10.083966-05:00","closed_at":"2026-02-12T18:16:10.083966-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-gzt","title":"Add unit tests for CrumbTable","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (test cases for Table CRUD)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (test cases for crumb state machine)\n- internal/sqlite/table_crumb.go (implementation under test)\n- internal/sqlite/backend.go (Backend.Attach for test setup)\n- pkg/types/crumb.go (Crumb entity)\n- .claude/rules/go-style.md (testing conventions, table-driven tests)\n\n## Files to Create/Modify\n- internal/sqlite/table_crumb_test.go (create) — Unit tests for CrumbTable\n- internal/sqlite/testutil_test.go (create) — Shared test helpers (setup backend, temp dirs)\n\n## Requirements\n- Implement table-driven tests for CrumbTable operations:\n  - Get: existing crumb, non-existent crumb\n  - Set: create new crumb (empty ID), update existing crumb, invalid state transition\n  - Delete: existing crumb, non-existent crumb, cascade (properties, metadata)\n  - Fetch: by states, by trail_id, by parent_id, limit/offset, empty results\n- Create shared test helper that creates a temporary Backend (temp dir, attach, return cleanup func)\n- Test crumb state transitions: draft→ready→taken→pebble, draft→dust, terminal state rejection\n\n## Design Decisions\n- Use table-driven tests per go-style rule\n- Shared helper in testutil_test.go creates temp dir + attached backend for each test\n- Use testify/assert for assertions\n\n## Acceptance Criteria\n- [ ] Tests cover Get, Set, Delete, Fetch operations\n- [ ] Tests cover crumb state transitions (valid and invalid)\n- [ ] Tests cover property get/set/clear on crumbs\n- [ ] All tests pass with `go test ./internal/sqlite/...`\n- [ ] Test helpers are reusable for other table tests","status":"in_progress","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:34.073551-05:00","created_by":"petardjukic","updated_at":"2026-02-13T09:01:23.250314-05:00","comments":[{"id":26,"issue_id":"generation-2026-02-13-07-56-44-gzt","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-h1u","title":"Add unit tests for CrumbTable state transitions","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (state machine test cases)\n- internal/sqlite/table_crumb.go (Set method handles state transitions)\n- pkg/types/crumb.go (SetState, Pebble, Dust)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml R2\n\n## Files to Create/Modify\n- internal/sqlite/table_crumb_state_test.go (create)\n\n## Requirements\n- Test valid state transitions via Table.Set: draft→ready, ready→taken, taken→pebble, any→dust\n- Test invalid transitions via Table.Set: pebble→anything returns error, dust→anything returns error\n- Test that state transitions update UpdatedAt timestamp\n- Test that terminal states (pebble, dust) persist correctly through Get\n\n## Design Decisions\n- Table-driven test matrix: (fromState, toState, expectError)\n- Reuse testutil_test.go helpers\n\n## Acceptance Criteria\n- [ ] All valid transitions succeed\n- [ ] All invalid transitions return correct error\n- [ ] Timestamps updated on transitions\n- [ ] Tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.115089-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:13:59.834146-05:00","closed_at":"2026-02-13T14:13:59.834146-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-h1u","depends_on_id":"generation-2026-02-13-07-56-44-q3e","type":"blocks","created_at":"2026-02-13T13:54:42.996499-05:00","created_by":"petardjukic"}],"comments":[{"id":45,"issue_id":"generation-2026-02-13-07-56-44-h1u","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":84,"issue_id":"generation-2026-02-13-07-56-44-h1u","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T19:11:37Z\",\"duration_s\":142,\"tokens\":{\"input\":17,\"output\":7760},\"loc_before\":{\"production\":6101,\"test\":2224},\"loc_after\":{\"production\":6101,\"test\":2573},\"diff\":{\"files\":2,\"insertions\":350,\"deletions\":1}}","created_at":"2026-02-13T19:13:59Z"}]}
{"id":"generation-2026-02-13-07-56-44-h6b","title":"Add scaffolding validation integration tests (rel01.0-uc004)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc004-scaffolding-validation.yaml (S1-S11 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc004-scaffolding-validation.yaml (30 test cases)\n- pkg/types/ (entity structs: crumb.go, trail.go, property.go, category.go, stash.go, metadata.go, link.go)\n- pkg/types/cupboard.go (Cupboard and Table interfaces)\n- internal/sqlite/backend.go (SQLite backend satisfies Cupboard interface)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc004_scaffolding_validation_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc004 as done\n\n## Requirements\n- S1-S2: Verify module path and go build succeeds\n- S3-S4: Verify cupboard version prints version string and lists use cases\n- S5: Compile-time checks for all 7 entity structs (Crumb, Trail, Property, Category, Stash, Metadata, Link)\n- S6-S8: Compile-time interface satisfaction (Table, Cupboard, SQLite backend)\n- S9: Standard table name constants exist for all 6 tables\n- S10-S11: GetTable succeeds for all 6 tables, returns ErrTableNotFound for unknown\n\n## Design Decisions\n- Use compile-time interface satisfaction checks (var _ Interface = (*Impl)(nil))\n- Use Go API (not CLI) for GetTable tests to complement existing CLI tests\n- Table-driven tests for entity struct compilation and GetTable\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S11 from the use case\n- [ ] All tests pass with go test ./tests/integration/... -run TestScaffoldingValidation\n- [ ] road-map.yaml updated to mark rel01.0-uc004 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.830903-05:00","created_by":"petardjukic","updated_at":"2026-02-12T17:59:12.972563-05:00","closed_at":"2026-02-12T17:59:12.972563-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-hcg","title":"Update road-map.yaml to mark rel02.1-uc003 as done","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (use case to mark done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (modify) — update rel02.1-uc003 status to done\n\n## Requirements\n- Change rel02.1-uc003-self-hosting status from \"not_started\" to \"done\"\n- Verify do-work.sh and make-work.sh scripts work end-to-end\n- Verify agent workflow documented in .claude/rules\n- Commit change with message referencing use case completion\n\n## Design Decisions\n- Only mark done after scripts validated and agent workflow documented\n- Atomic change (single use case status update)\n\n## Acceptance Criteria\n- [ ] rel02.1-uc003-self-hosting status is \"done\" in road-map.yaml\n- [ ] Scripts work end-to-end in integration test\n- [ ] Agent workflow documented\n- [ ] Change committed with descriptive message","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:47.99181-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:03:09.951243-05:00","closed_at":"2026-02-13T01:03:09.951243-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-hcg","depends_on_id":"generation-2026-02-13-07-56-44-01h","type":"blocks","created_at":"2026-02-12T22:15:48.896473-05:00","created_by":"petardjukic"}],"comments":[{"id":137,"issue_id":"generation-2026-02-13-07-56-44-hcg","author":"petardjukic","text":"duration: 1m1s | tokens: in=34 out=2353 | loc: +2 -2 files=2","created_at":"2026-02-13T06:03:09Z"}]}
{"id":"generation-2026-02-13-07-56-44-hlm","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method, existing backfill logic)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — verify and fix backfill logic in Set\n- internal/sqlite/properties_table_test.go (modify or create) — backfill-specific tests\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n- Verify existing backfill implementation handles edge cases: no crumbs exist, all crumbs already have value\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.378307-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:19:29.006387-05:00","closed_at":"2026-02-12T18:19:29.006387-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-hlm","depends_on_id":"generation-2026-02-13-07-56-44-grm","type":"blocks","created_at":"2026-02-12T17:46:33.154782-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-hq6","title":"Create go-install use case test suite and validate module installability","description":"## Required Reading\n- docs/specs/use-cases/rel01.1-uc001-go-install.yaml (S1-S5 success criteria)\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (if exists, otherwise create)\n- go.mod (module path, Go version)\n- cmd/cupboard/main.go (entry point)\n\n## Files to Create/Modify\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (create if missing)\n- tests/integration/test_rel01_1_uc001_go_install_test.go (create)\n\n## Requirements\n- Create test suite YAML if it does not exist (per test-case-format rule)\n- Implement integration tests that validate:\n  - `go build ./cmd/cupboard` succeeds (S1 proxy — go install requires published module)\n  - `cupboard --help` prints usage showing available commands (S2)\n  - `cupboard init` creates data directory with JSONL files (S3)\n  - `cupboard set crumbs` and `cupboard list crumbs` round-trips a crumb (S4)\n  - No manual steps beyond build and run (S5)\n- Since we work offline, test `go build` instead of `go install` (module not published)\n\n## Design Decisions\n- Test go build as a proxy for go install since the module is not published yet\n- Verify --help output contains expected command names\n- Reuse test helpers from existing integration tests\n\n## Acceptance Criteria\n- [ ] Test suite YAML exists at docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml\n- [ ] Integration test validates build, help, init, and round-trip\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGoInstall`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:18.483161-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:09:39.809098-05:00","closed_at":"2026-02-12T15:09:39.809098-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-hto","title":"Update SPECIFICATIONS.md roadmap summary for completed release 03.1","description":"## Required Reading\n- docs/SPECIFICATIONS.md (specifications document)\n- docs/road-map.yaml (updated roadmap, dependency)\n- .claude/rules/specification-format.md (specification format rule)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (update)\n\n## Requirements\nRegenerate the Roadmap Summary table in SPECIFICATIONS.md to reflect the completed release 03.1. Update the table row for release 03.1 from \"0 / 1\" use cases and \"not started\" status to \"1 / 1\" use cases and \"done\" status.\n\n## Design Decisions\n- Follow specification-format rule for table structure\n- Only update the Roadmap Summary table; do not modify other sections unless they reference release status\n\n## Acceptance Criteria\n- [ ] Roadmap Summary table updated with release 03.1 showing 1/1 use cases done\n- [ ] Release 03.1 status changed to \"done\"\n- [ ] Table formatting preserved\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.84759-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:31:44.519487-05:00","closed_at":"2026-02-13T01:31:44.519487-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-hto","depends_on_id":"generation-2026-02-13-07-56-44-j67","type":"blocks","created_at":"2026-02-13T01:09:08.6282-05:00","created_by":"petardjukic"}],"comments":[{"id":138,"issue_id":"generation-2026-02-13-07-56-44-hto","author":"petardjukic","text":"duration: 49s | tokens: in=18 out=1986 | loc: +3 -3 files=2","created_at":"2026-02-13T06:31:44Z"}]}
{"id":"generation-2026-02-13-07-56-44-i1a","title":"Add unit tests for Trail entity state machine (pkg/types)","description":"## Required Reading\n- pkg/types/trail.go (Trail struct, Complete, Abandon methods)\n- pkg/types/constants.go (trail states: draft, pending, active, completed, abandoned)\n- pkg/types/errors.go (ErrInvalidState, ErrInvalidTransition)\n- docs/specs/product-requirements/prd006-trails-interface.yaml R2, R5, R6\n\n## Files to Create/Modify\n- pkg/types/trail_test.go (create)\n\n## Requirements\n- Test Complete: succeeds from active state, sets CompletedAt, transitions to completed\n- Test Complete: fails from non-active states (draft, pending, completed, abandoned)\n- Test Abandon: succeeds from active state, sets CompletedAt, transitions to abandoned\n- Test Abandon: fails from non-active states\n- Test that CompletedAt is nil on creation and set after Complete/Abandon\n\n## Design Decisions\n- Table-driven tests per go-style rule\n\n## Acceptance Criteria\n- [ ] Complete and Abandon transitions tested for all source states\n- [ ] CompletedAt correctly set/unset\n- [ ] Tests pass with `go test ./pkg/types/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.17221-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:57:54.02543-05:00","closed_at":"2026-02-13T13:57:54.02543-05:00","close_reason":"Closed","comments":[{"id":39,"issue_id":"generation-2026-02-13-07-56-44-i1a","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":78,"issue_id":"generation-2026-02-13-07-56-44-i1a","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:56:48Z\",\"duration_s\":65,\"tokens\":{\"input\":11,\"output\":3012},\"loc_before\":{\"production\":6072,\"test\":372},\"loc_after\":{\"production\":6072,\"test\":473},\"diff\":{\"files\":2,\"insertions\":102,\"deletions\":1}}","created_at":"2026-02-13T18:57:53Z"}]}
{"id":"generation-2026-02-13-07-56-44-i61","title":"Create integration test harness for CLI tests","description":"## Required Reading\n- cmd/cupboard/main.go (entry point)\n- cmd/cupboard/root.go (root command, global flags)\n- .claude/rules/go-style.md (testing conventions)\n- docs/specs/test-suites/test-rel01.0-uc004-scaffolding-validation.yaml (scaffolding test cases)\n\n## Files to Create/Modify\n- tests/integration/testutil_test.go (create) - Shared CLI test helpers\n- tests/integration/scaffold_test.go (create) - Scaffolding validation tests\n\n## Requirements\n- Create helper `runCupboard(t *testing.T, args ...string) (stdout, stderr string, exitCode int)` that:\n  - Builds the cupboard binary (or uses exec.Command on `go run`)\n  - Runs with --config-dir and --data-dir pointing to temp dirs\n  - Captures stdout, stderr, and exit code\n- Create helper `initCupboard(t *testing.T) (configDir, dataDir string, cleanup func())` that:\n  - Creates temp dirs\n  - Runs `cupboard init`\n  - Returns paths and cleanup\n- Scaffolding tests: build succeeds, version command prints version, init creates config\n\n## Design Decisions\n- Use os/exec to run compiled binary for true end-to-end testing\n- Build binary once per test run with TestMain\n- Temp dirs per test for isolation\n\n## Acceptance Criteria\n- [ ] CLI test harness builds and runs cupboard commands\n- [ ] Helpers capture stdout, stderr, exit code\n- [ ] Scaffolding tests pass\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.824739-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:59:40.799136-05:00","closed_at":"2026-02-13T17:59:40.799136-05:00","close_reason":"Closed","comments":[{"id":56,"issue_id":"generation-2026-02-13-07-56-44-i61","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":94,"issue_id":"generation-2026-02-13-07-56-44-i61","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:54:31Z\",\"duration_s\":309,\"tokens\":{\"input\":25,\"output\":8086},\"loc_before\":{\"production\":6101,\"test\":8037},\"loc_after\":{\"production\":6101,\"test\":8300},\"diff\":{\"files\":3,\"insertions\":264,\"deletions\":1}}","created_at":"2026-02-13T22:59:40Z"}]}
{"id":"generation-2026-02-13-07-56-44-i9p","title":"Define Crumb entity struct and methods in pkg/types","description":"## Required Reading\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml (R1 Crumb struct, R2 state transitions, R3 property methods)\n- docs/ARCHITECTURE.md § Lifecycle of entities (crumb states)\n- pkg/types/constants.go (crumb states from task 0)\n- pkg/types/errors.go (errors from task 0)\n\n## Files to Create/Modify\n- pkg/types/crumb.go (create) - Crumb struct, state transition methods, property methods\n\n## Requirements\n- Crumb struct per prd003 R1: CrumbID (string), Name (string), State (string), CreatedAt (time.Time), UpdatedAt (time.Time), Properties (map[string]any)\n- ValidCrumbStates helper: returns list of valid states\n- IsTerminalState(state string) bool: returns true for pebble and dust\n- Crumb.SetState(state string) error per prd003 R2: validates state is recognized, rejects transitions from terminal states, updates UpdatedAt\n- Crumb.Pebble() error per prd003 R2: only from taken state, sets state to pebble, updates UpdatedAt\n- Crumb.Dust() error per prd003 R2: idempotent from any state (no-op if already dust), sets state to dust, updates UpdatedAt\n- Crumb.SetProperty(propertyID string, value any) error per prd003 R3: sets property value, updates UpdatedAt\n- Crumb.GetProperty(propertyID string) (any, error) per prd003 R3: returns ErrPropertyNotFound if not present\n- Crumb.GetProperties() map[string]any per prd003 R3: returns copy of properties map\n- Crumb.ClearProperty(propertyID string) error per prd003 R3: removes property, updates UpdatedAt\n- Add SPDX copyright header\n\n## Design Decisions\n- Properties map initialized as empty map (not nil) on creation\n- GetProperties returns a shallow copy to prevent external mutation\n- SetState does not enforce specific transition paths beyond terminal state check (per ARCHITECTURE: \"Table interface tracks state but does not enforce transitions\")\n\n## Acceptance Criteria\n- [ ] Crumb struct with all fields per prd003 R1\n- [ ] SetState validates state and rejects terminal→other transitions\n- [ ] Pebble only succeeds from taken state\n- [ ] Dust is idempotent from any state\n- [ ] Property methods work correctly\n- [ ] Copyright header present\n- [ ] go build ./pkg/types succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:20.534292-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:07:05.281045-05:00","closed_at":"2026-02-13T08:07:05.281045-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-i9p","depends_on_id":"generation-2026-02-13-07-56-44-0g8","type":"blocks","created_at":"2026-02-13T08:02:21.706078-05:00","created_by":"petardjukic"}],"comments":[{"id":3,"issue_id":"generation-2026-02-13-07-56-44-i9p","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":13,"issue_id":"generation-2026-02-13-07-56-44-i9p","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:05:57Z\",\"duration_s\":68,\"tokens\":{\"input\":10,\"output\":3631},\"loc_before\":{\"production\":220,\"test\":0},\"loc_after\":{\"production\":367,\"test\":0},\"diff\":{\"files\":2,\"insertions\":148,\"deletions\":1}}","created_at":"2026-02-13T13:07:05Z"}]}
{"id":"generation-2026-02-13-07-56-44-j51","title":"Add unit tests for Crumb entity state machine (pkg/types)","description":"## Required Reading\n- pkg/types/crumb.go (Crumb struct, SetState, Pebble, Dust methods)\n- pkg/types/constants.go (crumb states: draft, pending, ready, taken, pebble, dust)\n- pkg/types/errors.go (ErrInvalidState, ErrInvalidTransition)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml R2 (state transitions)\n- .claude/rules/go-style.md (testing conventions)\n\n## Files to Create/Modify\n- pkg/types/crumb_test.go (create)\n\n## Requirements\n- Test SetState: all valid forward transitions (draft→pending, draft→ready, ready→taken, taken→pebble, any→dust)\n- Test SetState: invalid transitions from terminal states (pebble→anything, dust→anything) return ErrInvalidTransition\n- Test SetState: invalid state string returns ErrInvalidState\n- Test Pebble: only succeeds from taken state\n- Test Dust: succeeds from any non-terminal state, idempotent from dust\n- Test SetProperty, GetProperty, GetProperties, ClearProperty\n- Test GetProperty on missing key returns ErrPropertyNotFound\n- Test GetProperties returns shallow copy (mutation safety)\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- No external dependencies needed (pure unit tests)\n\n## Acceptance Criteria\n- [ ] All valid state transitions pass\n- [ ] All invalid state transitions return correct errors\n- [ ] Property CRUD methods tested\n- [ ] Tests pass with `go test ./pkg/types/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.042116-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:56:47.901917-05:00","closed_at":"2026-02-13T13:56:47.901917-05:00","close_reason":"Closed","comments":[{"id":38,"issue_id":"generation-2026-02-13-07-56-44-j51","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":77,"issue_id":"generation-2026-02-13-07-56-44-j51","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:54:51Z\",\"duration_s\":116,\"tokens\":{\"input\":9,\"output\":6454},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":372},\"diff\":{\"files\":2,\"insertions\":373,\"deletions\":1}}","created_at":"2026-02-13T18:56:47Z"}]}
{"id":"generation-2026-02-13-07-56-44-j67","title":"Mark rel03.1-uc001-self-hosting-with-epics as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.1-uc001-self-hosting-with-epics.yaml (use case definition)\n- tests/integration/test_rel03_1_uc001_self_hosting_with_epics_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.1-uc001-self-hosting-with-epics from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.1-uc001-self-hosting-with-epics status changed to \"done\" in road-map.yaml\n- [ ] Release 03.1 use cases count updated to 1/1 done\n- [ ] Release 03.1 status changed from \"not started\" to \"done\"\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.713416-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:30:54.835107-05:00","closed_at":"2026-02-13T01:30:54.835107-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-j67","depends_on_id":"generation-2026-02-13-07-56-44-58c","type":"blocks","created_at":"2026-02-13T01:09:08.533991-05:00","created_by":"petardjukic"}],"comments":[{"id":139,"issue_id":"generation-2026-02-13-07-56-44-j67","author":"petardjukic","text":"duration: 41s | tokens: in=17 out=1534 | loc: +2 -2 files=2","created_at":"2026-02-13T06:30:54Z"}]}
{"id":"generation-2026-02-13-07-56-44-j7p","title":"Complete stash filtering, deletion, and history test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC18-TC23)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R9: Filter map, R11: Deletion, R7: History)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F18-F23)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- internal/sqlite/stashes_table.go (Fetch, Delete, FetchStashHistory implementations)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S11, S12, S13, S14, S15)\n\n## Requirements\nImplement integration test cases validating:\n1. Fetch by stash_type filter (success criterion S11)\n   - Create stashes of multiple types\n   - Fetch with filter: {\"stash_type\": \"counter\"}\n   - Verify only counter stashes returned\n2. Fetch by name filter (success criterion S12)\n   - Create stashes with different names\n   - Fetch with filter: {\"name\": \"specific-stash\"}\n   - Verify only matching stash returned\n3. Delete stash (success criterion S13)\n   - Create a stash\n   - Call Table.Delete\n   - Verify subsequent Get returns ErrNotFound\n4. Stash history tracking (success criteria S14, S15)\n   - Create a stash (operation: create)\n   - Call SetValue (operation: set)\n   - Call Increment (operation: increment)\n   - Query history via FetchStashHistory\n   - Verify all three operations recorded with correct version, value snapshots\n   - Verify history entries ordered by version ascending\n\nTest cases must validate prd008-stash-interface R9 (filter keys), R11 (deletion), and R7 (history tracking).\n\n## Design Decisions\n- Use table-driven tests for various filter combinations\n- Validate history entries have correct version sequence (1, 2, 3)\n- Test FetchStashHistory returns entries ordered by version ascending\n- Verify each history entry has HistoryID, StashID, Version, Value, Operation, CreatedAt\n\n## Acceptance Criteria\n- [ ] TestStashOperations_FetchByStashTypeReturnsMatchingStashes passes (validates S11)\n- [ ] TestStashOperations_FetchByNameReturnsMatchingStash passes (validates S12)\n- [ ] TestStashOperations_DeleteRemovesStash passes (validates S13)\n- [ ] TestStashOperations_HistoryTracksAllMutations passes (validates S14)\n- [ ] TestStashOperations_HistoryOrderedByVersionAscending passes (validates S15)\n- [ ] Tests validate prd008-stash-interface R7.6 (FetchStashHistory method)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.81564-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:04:09.185841-05:00","closed_at":"2026-02-13T02:04:09.185841-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-j7p","depends_on_id":"generation-2026-02-13-07-56-44-sdw","type":"blocks","created_at":"2026-02-13T01:50:44.070086-05:00","created_by":"petardjukic"}],"comments":[{"id":140,"issue_id":"generation-2026-02-13-07-56-44-j7p","author":"petardjukic","text":"duration: 1m49s | tokens: in=29 out=5572 | loc: +125 -22 files=2","created_at":"2026-02-13T07:04:09Z"}]}
{"id":"generation-2026-02-13-07-56-44-jkj","title":"Add unit tests for MetadataTable","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.1-uc004-metadata-lifecycle.yaml (metadata test cases)\n- internal/sqlite/table_metadata.go (implementation under test)\n- docs/specs/product-requirements/prd005-metadata-interface.yaml R4-R10\n\n## Files to Create/Modify\n- internal/sqlite/table_metadata_test.go (create)\n\n## Requirements\n- Test Get: existing metadata, non-existent returns ErrNotFound\n- Test Set (create): generates UUID v7, validates CrumbID exists, Content non-empty\n- Test Set: invalid CrumbID returns error\n- Test Set: empty Content returns ErrInvalidContent\n- Test Delete: existing metadata entry\n- Test Fetch: filter by schema (TableName), crumb_id, content_contains\n- Test Fetch: limit and offset\n- Test cascade: deleting a crumb removes its metadata entries\n\n## Design Decisions\n- Table-driven tests\n- Reuse testutil_test.go helpers\n\n## Acceptance Criteria\n- [ ] CRUD operations tested\n- [ ] Validation tested (CrumbID exists, content non-empty)\n- [ ] Fetch filters tested\n- [ ] Cascade delete verified\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.076188-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:43:11.11798-05:00","closed_at":"2026-02-13T17:43:11.11798-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-jkj","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.567785-05:00","created_by":"petardjukic"}],"comments":[{"id":51,"issue_id":"generation-2026-02-13-07-56-44-jkj","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":89,"issue_id":"generation-2026-02-13-07-56-44-jkj","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:38:53Z\",\"duration_s\":257,\"tokens\":{\"input\":33,\"output\":16634},\"loc_before\":{\"production\":6101,\"test\":5643},\"loc_after\":{\"production\":6101,\"test\":6382},\"diff\":{\"files\":2,\"insertions\":740,\"deletions\":1}}","created_at":"2026-02-13T22:43:11Z"}]}
{"id":"generation-2026-02-13-07-56-44-jt5","title":"Implement PropertyTable and CategoryTable for SQLite backend","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property and Category entities, value types, defaults, backfill)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (Table interface contract R2, R3)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (JSONL sync, write patterns)\n- internal/sqlite/table_crumb.go (reference implementation)\n- internal/sqlite/seed.go (built-in property seeding, existing property/category insert logic)\n- internal/sqlite/schema.go (properties and categories table schemas)\n- pkg/types/property.go (Property entity struct)\n- pkg/types/category.go (Category entity struct)\n\n## Files to Create/Modify\n- internal/sqlite/table_property.go (create) — PropertyTable implementation\n- internal/sqlite/table_category.go (create) — CategoryTable implementation (categories are a separate table in the schema)\n- internal/sqlite/backend.go (modify) — Wire PropertyTable and CategoryTable in GetTable map\n\n## Requirements\n- Implement PropertyTable satisfying types.Table (Get, Set, Delete, Fetch)\n- Get: retrieve property definition by ID\n- Set: create or update property definition, with backfill of default values to all existing crumbs on new property creation (prd004 R3)\n- Delete: remove property definition and all crumb_properties rows for that property\n- Fetch: return all property definitions, filter by value_type\n- Implement CategoryTable satisfying types.Table (Get, Set, Delete, Fetch)\n- Wire both into Backend.tables map\n\n## Design Decisions\n- Backfill on property creation: insert crumb_properties row with default value for every existing crumb in a single transaction\n- Follow CrumbTable pattern for JSONL sync\n\n## Acceptance Criteria\n- [ ] PropertyTable implements types.Table\n- [ ] CategoryTable implements types.Table\n- [ ] Property creation backfills default values to all existing crumbs\n- [ ] Backend.GetTable(\"properties\") and GetTable(\"categories\") work\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:33.420723-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:51:32.169135-05:00","closed_at":"2026-02-13T08:51:32.169135-05:00","close_reason":"Closed","comments":[{"id":22,"issue_id":"generation-2026-02-13-07-56-44-jt5","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":32,"issue_id":"generation-2026-02-13-07-56-44-jt5","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:46:59Z\",\"duration_s\":273,\"tokens\":{\"input\":34,\"output\":15788},\"loc_before\":{\"production\":3697,\"test\":0},\"loc_after\":{\"production\":4305,\"test\":0},\"diff\":{\"files\":7,\"insertions\":611,\"deletions\":65}}","created_at":"2026-02-13T13:51:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-kik","title":"Run full integration test suite and fix any failures","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (all test cases)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (all test cases)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (all tests)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (all tests)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (fix failures)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (fix failures)\n- internal/sqlite/links_table.go (fix implementation bugs if needed)\n- internal/sqlite/stashes_table.go (fix implementation bugs if needed)\n\n## Requirements\n1. Run full integration test suite for rel03.0-uc002 and rel03.0-uc003\n2. Identify any test failures or panics\n3. Debug root causes (implementation bugs vs test bugs)\n4. Fix implementation or test issues\n5. Verify all tests pass\n6. Document any edge cases discovered during debugging\n\n## Design Decisions\n- Run tests with -v flag for verbose output\n- Use -run flag to isolate failing tests\n- Fix implementation bugs in internal/sqlite first\n- Fix test bugs in tests/integration second\n- Add debug logging if needed to diagnose issues\n- Use go test -race to catch race conditions\n\n## Acceptance Criteria\n- [ ] All link management tests pass: go test -v ./tests/integration -run TestLinkManagement\n- [ ] All stash operations tests pass: go test -v ./tests/integration -run TestStashOperations\n- [ ] No test failures, panics, or race conditions detected\n- [ ] Success criteria S1-S15 validated for both use cases\n- [ ] Test coverage for prd007-links-interface R1-R7 complete\n- [ ] Test coverage for prd008-stash-interface R1-R12 complete\n- [ ] All tests pass with -race flag: go test -race ./tests/integration","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.072431-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:11:12.274702-05:00","closed_at":"2026-02-13T02:11:12.274702-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-kik","depends_on_id":"generation-2026-02-13-07-56-44-j7p","type":"blocks","created_at":"2026-02-13T01:50:44.165039-05:00","created_by":"petardjukic"}],"comments":[{"id":141,"issue_id":"generation-2026-02-13-07-56-44-kik","author":"petardjukic","text":"duration: 1m48s | tokens: in=38 out=2368 | loc: +1 -1 files=1","created_at":"2026-02-13T07:11:12Z"}]}
{"id":"generation-2026-02-13-07-56-44-kot","title":"Implement issue-tracking CLI commands (create, show, update, close)","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3: entity-specific commands, R4: issue-tracking commands)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (flow, success criteria)\n- cmd/cupboard/root.go (existing CLI structure)\n- cmd/cupboard/table_helpers.go (withTable helper)\n- cmd/cupboard/format.go (output formatters)\n- pkg/types/crumb.go (Crumb entity and property methods)\n- .claude/rules/cupboard-workflow.md (expected command interface)\n\n## Files to Create/Modify\n- cmd/cupboard/create.go (create) — `cupboard create` command\n- cmd/cupboard/show.go (create) — `cupboard show \u003cid\u003e` command\n- cmd/cupboard/update.go (create) — `cupboard update \u003cid\u003e` command\n- cmd/cupboard/close.go (create) — `cupboard close \u003cid\u003e` command\n- cmd/cupboard/root.go (modify) — Register new subcommands\n\n## Requirements\n- `cupboard create --type \u003ctype\u003e --title \u003ctitle\u003e [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--parent \u003cid\u003e] [--json]`\n  - Creates crumb via Table.Set, sets properties (type, description, labels), sets state to draft\n  - Prints created crumb ID (or JSON)\n- `cupboard show \u003cid\u003e [--json]`\n  - Gets crumb via Table.Get, displays all fields and properties\n- `cupboard update \u003cid\u003e [--status \u003cstate\u003e] [--title \u003ctitle\u003e] [--description \u003cdesc\u003e] [--labels \u003ccsv\u003e] [--json]`\n  - Updates crumb fields and/or properties via Table.Set\n- `cupboard close \u003cid\u003e [--json]`\n  - Transitions crumb to pebble state via SetState, persists via Table.Set\n\n## Design Decisions\n- All commands use withTable helper to attach backend and get crumbs table\n- Property values set via Crumb.SetProperty method before Table.Set\n- Output uses existing format.go formatters\n- Exit codes per prd009: 0=success, 1=user error, 2=system error\n\n## Acceptance Criteria\n- [ ] `cupboard create` creates a crumb with type and title properties\n- [ ] `cupboard show` displays crumb details\n- [ ] `cupboard update` modifies crumb fields and properties\n- [ ] `cupboard close` transitions crumb to pebble\n- [ ] All commands support --json flag\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:34.503377-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:37:32.852651-05:00","closed_at":"2026-02-13T13:37:32.852651-05:00","close_reason":"Closed","comments":[{"id":29,"issue_id":"generation-2026-02-13-07-56-44-kot","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":36,"issue_id":"generation-2026-02-13-07-56-44-kot","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:34:07Z\",\"duration_s\":205,\"tokens\":{\"input\":33,\"output\":11235},\"loc_before\":{\"production\":5539,\"test\":0},\"loc_after\":{\"production\":5867,\"test\":0},\"diff\":{\"files\":5,\"insertions\":329,\"deletions\":1}}","created_at":"2026-02-13T18:37:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-kyb","title":"Complete stash counter operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC8-TC11)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R5: Counter operations)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F8-F11)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- pkg/types/stash.go (Increment method)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S5, S6)\n\n## Requirements\nImplement integration test cases validating:\n1. Increment with positive delta (success criterion S5)\n   - Create counter stash with initial value 0\n   - Call Increment(5)\n   - Verify returns 5 and Version increments\n   - Persist via Table.Set\n   - Retrieve and verify value is 5\n2. Increment with negative delta (success criterion S6)\n   - Create counter stash with value 10\n   - Call Increment(-3)\n   - Verify returns 7 and Version increments\n   - Persist and verify value is 7\n3. Multiple increments\n   - Create counter stash\n   - Call Increment(5), Increment(10), Increment(-2)\n   - Verify accumulated value is correct (13)\n4. Increment on non-counter type\n   - Create context stash\n   - Call Increment(1)\n   - Verify ErrInvalidStashType returned\n\nTest cases must validate prd008-stash-interface R5.2 (Increment method, type validation, version tracking).\n\n## Design Decisions\n- Use table-driven tests for various delta values (positive, negative, zero)\n- Validate Version increments on each Increment call\n- Test Increment error handling for non-counter types\n- Verify counter value persists correctly via Table.Set/Get roundtrip\n\n## Acceptance Criteria\n- [ ] TestStashOperations_IncrementWithPositiveDelta passes (validates S5)\n- [ ] TestStashOperations_IncrementWithNegativeDelta passes (validates S6)\n- [ ] TestStashOperations_MultipleIncrementsAccumulate passes\n- [ ] TestStashOperations_IncrementOnNonCounterReturnsError passes\n- [ ] Tests validate prd008-stash-interface R5.2 (Increment adds delta, increments Version)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.519452-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:01:24.342696-05:00","closed_at":"2026-02-13T02:01:24.342696-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-kyb","depends_on_id":"generation-2026-02-13-07-56-44-8ku","type":"blocks","created_at":"2026-02-13T01:50:43.881118-05:00","created_by":"petardjukic"}],"comments":[{"id":142,"issue_id":"generation-2026-02-13-07-56-44-kyb","author":"petardjukic","text":"duration: 1m27s | tokens: in=29 out=2919 | loc: +1 -1 files=1","created_at":"2026-02-13T07:01:24Z"}]}
{"id":"generation-2026-02-13-07-56-44-l8y","title":"Add integration tests for generic table CLI commands","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc004-generic-table-cli.yaml (test cases to implement)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (success criteria S1-S12)\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (existing test patterns)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (existing test patterns)\n- cmd/cupboard/get.go, set.go, list.go, delete.go (commands under test)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc004_generic_table_cli_test.go (create)\n\n## Requirements\n- Implement table-driven tests exercising the cupboard CLI binary via os/exec\n- Build cupboard binary in TestMain or test setup, use temp directory for data\n- Test cases per test suite YAML:\n  - Get: valid entity returns JSON (S1), missing entity exit 1 (S2), unknown table exit 1 with valid names (S3)\n  - Set: create with empty ID returns JSON with generated ID (S4), update with existing ID (S5), invalid JSON exit 1 (S6)\n  - List: all entities returns JSON array (S7), with State=draft filter (S8), invalid filter exit 1 (S9)\n  - Delete: removes entity prints confirmation (S10), missing entity exit 1 (S11)\n  - Cross-table: commands work for crumbs, trails, links (S12)\n- Each test case uses a fresh cupboard init in a temp directory\n\n## Design Decisions\n- Use os/exec.Command to run the built binary (true CLI integration test)\n- Build binary once in TestMain, store path in package-level var\n- Helper: runCupboard(t, args...) (stdout, stderr, exitCode) for clean test assertions\n\n## Acceptance Criteria\n- [ ] All 12 success criteria (S1-S12) have at least one test case\n- [ ] Tests use table-driven pattern\n- [ ] Tests build and run the cupboard binary via os/exec\n- [ ] Tests pass with `go test ./tests/integration/... -run TestGenericTableCLI`\n- [ ] Each test case is independent (uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T12:08:17.826149-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:36:29.82977-05:00","closed_at":"2026-02-12T12:36:29.82977-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-l8y","depends_on_id":"generation-2026-02-13-07-56-44-6rc","type":"blocks","created_at":"2026-02-12T12:08:18.937576-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-l9m","title":"Add integration tests for link management (rel03.0-uc002)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (create)\n\n## Requirements\n- Test: create belongs_to link (crumb→trail)\n- Test: create child_of link (crumb→crumb)\n- Test: create branches_from link (trail→crumb)\n- Test: create scoped_to link (stash→trail)\n- Test: duplicate link returns error\n- Test: delete link\n- Test: fetch links by link_type, from_id, to_id\n- Test: invalid link type returns error\n\n## Design Decisions\n- Use generic table CLI for all link operations\n- Create prerequisite entities (crumbs, trails, stashes) for each link type\n\n## Acceptance Criteria\n- [ ] All 4 link types tested\n- [ ] Uniqueness constraint tested\n- [ ] Fetch filters tested\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.319036-05:00","created_by":"petardjukic","updated_at":"2026-02-13T19:13:37.87225-05:00","closed_at":"2026-02-13T19:13:37.87225-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-l9m","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.983801-05:00","created_by":"petardjukic"}],"comments":[{"id":67,"issue_id":"generation-2026-02-13-07-56-44-l9m","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"},{"id":105,"issue_id":"generation-2026-02-13-07-56-44-l9m","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-14T00:09:10Z\",\"duration_s\":267,\"tokens\":{\"input\":21,\"output\":11608},\"loc_before\":{\"production\":6208,\"test\":14088},\"loc_after\":{\"production\":6208,\"test\":14611},\"diff\":{\"files\":2,\"insertions\":524,\"deletions\":1}}","created_at":"2026-02-14T00:13:37Z"}]}
{"id":"generation-2026-02-13-07-56-44-lgd","title":"Complete link update, deletion, and uniqueness test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (test cases TC15-TC18)\n- docs/specs/product-requirements/prd007-links-interface.yaml (R3.5: Delete, R5: Uniqueness, R1.5: Immutability)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (flow F15-F18)\n- tests/integration/test_rel03_0_uc002_link_management_test.go (existing test structure)\n- internal/sqlite/links_table.go (Delete implementation, uniqueness check)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc002_link_management_test.go (add test cases for S9, S10, uniqueness)\n\n## Requirements\nImplement integration test cases validating:\n1. Link update (idempotent Set)\n   - Create a link\n   - Call Set with existing LinkID and updated fields\n   - Verify link is updated (prd007-links-interface R1.5: links are immutable after creation, but Set should be idempotent)\n2. Link deletion (success criterion S9)\n   - Create a link\n   - Call Table.Delete with link ID\n   - Verify subsequent Get returns ErrNotFound\n3. Delete nonexistent link (success criterion S10)\n   - Call Table.Delete with nonexistent ID\n   - Verify ErrNotFound returned\n4. Uniqueness constraint validation\n   - Create a link with (link_type, from_id, to_id)\n   - Attempt to create duplicate link with same (link_type, from_id, to_id)\n   - Verify error returned (prd007-links-interface R5.1, R5.2)\n\nTest cases must validate prd007-links-interface R5 (uniqueness constraint) and R7 (error handling).\n\n## Design Decisions\n- Use table-driven tests for delete scenarios\n- Validate error types with errors.Is per prd007-links-interface R7.2\n- Test uniqueness constraint for each link type\n- Verify Delete returns ErrInvalidID when id is empty\n\n## Acceptance Criteria\n- [ ] TestLinkManagement_SetWithExistingIDUpdatesLink passes (or verifies immutability error)\n- [ ] TestLinkManagement_DeleteRemovesLink passes\n- [ ] TestLinkManagement_DeleteNonexistentReturnsNotFound passes\n- [ ] TestLinkManagement_UniquenessConstraintEnforced passes\n- [ ] Tests validate prd007-links-interface R5.1 (unique link_type + from_id + to_id)\n- [ ] Tests validate prd007-links-interface R7 (error types: ErrNotFound, ErrInvalidID)\n- [ ] All tests pass: go test -v ./tests/integration -run TestLinkManagement","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.26211-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:58:51.4643-05:00","closed_at":"2026-02-13T01:58:51.4643-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-lgd","depends_on_id":"generation-2026-02-13-07-56-44-5n8","type":"blocks","created_at":"2026-02-13T01:50:43.78596-05:00","created_by":"petardjukic"}],"comments":[{"id":143,"issue_id":"generation-2026-02-13-07-56-44-lgd","author":"petardjukic","text":"duration: 1m47s | tokens: in=38 out=5296 | loc: +158 -1 files=2","created_at":"2026-02-13T06:58:51Z"}]}
{"id":"generation-2026-02-13-07-56-44-li7","title":"Add integration tests for crumb lifecycle (rel01.0-uc003)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (test cases)\n- docs/specs/use-cases/rel01.0-uc003-crumb-lifecycle.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc003_crumb_lifecycle_test.go (create)\n\n## Requirements\n- Test state transitions via CLI: draft→ready, ready→taken, taken→pebble, any→dust\n- Test invalid transitions: pebble→ready fails, dust→ready fails\n- Test crumb creation defaults to draft state\n- Test Pebble and Dust convenience transitions\n- Test state-based filtering: list crumbs by state\n\n## Design Decisions\n- Use issue-tracking CLI commands (cupboard create, update, show)\n- Table-driven test matrix for state transitions\n\n## Acceptance Criteria\n- [ ] All valid state transitions verified via CLI\n- [ ] Invalid transitions return non-zero exit code\n- [ ] State filtering works\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.211243-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:20:39.879898-05:00","closed_at":"2026-02-13T18:20:39.879898-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-li7","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.150205-05:00","created_by":"petardjukic"}],"comments":[{"id":59,"issue_id":"generation-2026-02-13-07-56-44-li7","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":97,"issue_id":"generation-2026-02-13-07-56-44-li7","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:15:22Z\",\"duration_s\":317,\"tokens\":{\"input\":22,\"output\":17026},\"loc_before\":{\"production\":6101,\"test\":9562},\"loc_after\":{\"production\":6101,\"test\":9980},\"diff\":{\"files\":2,\"insertions\":419,\"deletions\":1}}","created_at":"2026-02-13T23:20:39Z"}]}
{"id":"generation-2026-02-13-07-56-44-lkj","title":"Implement StashTable for SQLite backend","description":"## Required Reading\n- docs/specs/product-requirements/prd008-stash-interface.yaml (Stash types, versioning, history, counters, locks)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (Table interface contract)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (JSONL sync)\n- internal/sqlite/table_crumb.go (reference implementation)\n- internal/sqlite/schema.go (stashes and stash_history table schemas)\n- pkg/types/stash.go (Stash entity struct)\n\n## Files to Create/Modify\n- internal/sqlite/table_stash.go (create) — StashTable implementation\n- internal/sqlite/backend.go (modify) — Wire StashTable in GetTable map\n\n## Requirements\n- Implement StashTable satisfying types.Table (Get, Set, Delete, Fetch)\n- Get: retrieve stash by ID, include current version\n- Set: create (UUID v7) or update stash, increment version on every mutation, record StashHistoryEntry, sync to stashes.jsonl and stash_history.jsonl\n- Delete: remove stash and its history\n- Fetch: filter by stash_type, trail scope (via scoped_to links)\n- Wire into Backend.tables map\n\n## Design Decisions\n- Every Set increments version and appends to stash_history table\n- History entries synced to stash_history.jsonl alongside stash updates\n- Stash scope determined by scoped_to links (read from links table during Fetch)\n\n## Acceptance Criteria\n- [ ] StashTable implements types.Table\n- [ ] Set increments version and records history\n- [ ] Get returns stash with current version\n- [ ] Backend.GetTable(\"stashes\") returns StashTable\n- [ ] Builds without errors","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:33.860936-05:00","created_by":"petardjukic","updated_at":"2026-02-13T09:01:22.625936-05:00","closed_at":"2026-02-13T09:01:22.625936-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-lkj","depends_on_id":"generation-2026-02-13-07-56-44-bfe","type":"blocks","created_at":"2026-02-13T08:43:34.743552-05:00","created_by":"petardjukic"}],"comments":[{"id":25,"issue_id":"generation-2026-02-13-07-56-44-lkj","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"},{"id":35,"issue_id":"generation-2026-02-13-07-56-44-lkj","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:57:29Z\",\"duration_s\":233,\"tokens\":{\"input\":26,\"output\":13140},\"loc_before\":{\"production\":4989,\"test\":0},\"loc_after\":{\"production\":5539,\"test\":0},\"diff\":{\"files\":5,\"insertions\":551,\"deletions\":63}}","created_at":"2026-02-13T14:01:22Z"}]}
{"id":"generation-2026-02-13-07-56-44-m6s","title":"Add unit tests for TrailTable and LinkTable","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc001-trail-exploration.yaml (trail test cases)\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (link test cases)\n- internal/sqlite/table_trail.go (implementation under test)\n- internal/sqlite/table_link.go (implementation under test)\n- internal/sqlite/testutil_test.go (shared test helpers from task 5)\n\n## Files to Create/Modify\n- internal/sqlite/table_trail_test.go (create) — Unit tests for TrailTable\n- internal/sqlite/table_link_test.go (create) — Unit tests for LinkTable\n\n## Requirements\n- TrailTable tests: Get, Set (create/update), Delete, Fetch by state, trail state transitions\n- LinkTable tests: Get, Set (create with uniqueness), Delete, Fetch by link_type/from_id/to_id, duplicate link rejection\n- Use shared test helpers from testutil_test.go\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Reuse testutil_test.go helper for backend setup\n\n## Acceptance Criteria\n- [ ] TrailTable tests cover CRUD and state transitions\n- [ ] LinkTable tests cover CRUD and uniqueness enforcement\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:34.215874-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:43:34.215874-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-m6s","depends_on_id":"generation-2026-02-13-07-56-44-gzt","type":"blocks","created_at":"2026-02-13T08:43:34.858754-05:00","created_by":"petardjukic"}],"comments":[{"id":27,"issue_id":"generation-2026-02-13-07-56-44-m6s","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-mdx","title":"Validate built-in property seeding on backend attach","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R3 built-in properties, R3.1-R3.5)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R3 startup, R3.4 built-in property seeding)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S3 built-in properties exist after attach)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-3)\n- internal/sqlite/backend.go (Attach method)\n- internal/sqlite/properties_table.go (property operations)\n- pkg/types/property.go (Property struct)\n\n## Files to Create/Modify\n- internal/sqlite/seed.go (create) — built-in property seeding logic\n- internal/sqlite/seed_test.go (create) — unit tests for seeding\n\n## Requirements\n- On Attach, seed built-in properties if they do not already exist: priority (categorical), type (categorical), description (text), owner (text), labels (list)\n- Seed built-in categories for priority (highest, high, medium, low, lowest) and type (task, epic, bug, chore)\n- Seeding must be idempotent (re-attach does not duplicate properties)\n- Verify seeded properties are retrievable via GetTable(\"properties\").Fetch(nil)\n\n## Design Decisions\n- Extract seeding into seed.go to keep backend.go focused on lifecycle\n- Use Table.Set operations for seeding (dogfood the interface)\n- Check existence before inserting to ensure idempotency\n\n## Acceptance Criteria\n- [ ] After Attach, properties table contains 5 built-in properties\n- [ ] After Attach, categories exist for priority and type\n- [ ] Re-attach does not duplicate properties or categories\n- [ ] Unit tests cover seed and idempotency\n- [ ] go build ./cmd/cupboard succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.400236-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:26:04.288553-05:00","closed_at":"2026-02-12T15:26:04.288553-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-mdx","depends_on_id":"generation-2026-02-13-07-56-44-2ys","type":"blocks","created_at":"2026-02-12T14:57:07.581003-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-n46","title":"Add integration tests for metadata lifecycle (rel02.1-uc004)","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.1-uc004-metadata-lifecycle.yaml (test cases)\n- docs/specs/use-cases/rel02.1-uc004-metadata-lifecycle.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc004_metadata_lifecycle_test.go (create)\n\n## Requirements\n- Test: create metadata entry via `cupboard set metadata`\n- Test: get metadata entry by ID\n- Test: list metadata entries, filter by crumb_id and schema\n- Test: delete metadata entry\n- Test: cascade delete when parent crumb is deleted\n- Test: add comment via `cupboard comments add` and verify via metadata list\n\n## Design Decisions\n- Use both generic table CLI and issue-tracking comments command\n- Verify cascade via crumb deletion\n\n## Acceptance Criteria\n- [ ] Metadata CRUD via CLI tested\n- [ ] Cascade delete verified\n- [ ] Comments add verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.063232-05:00","created_by":"petardjukic","updated_at":"2026-02-13T19:02:47.910457-05:00","closed_at":"2026-02-13T19:02:47.910457-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-n46","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.763811-05:00","created_by":"petardjukic"}],"comments":[{"id":65,"issue_id":"generation-2026-02-13-07-56-44-n46","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"},{"id":103,"issue_id":"generation-2026-02-13-07-56-44-n46","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:57:49Z\",\"duration_s\":298,\"tokens\":{\"input\":24,\"output\":13279},\"loc_before\":{\"production\":6208,\"test\":12983},\"loc_after\":{\"production\":6208,\"test\":13515},\"diff\":{\"files\":2,\"insertions\":533,\"deletions\":1}}","created_at":"2026-02-14T00:02:47Z"}]}
{"id":"generation-2026-02-13-07-56-44-ni2","title":"Add integration tests for trail exploration (rel03.0-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc001-trail-exploration.yaml (test cases)\n- docs/specs/use-cases/rel03.0-uc001-trail-exploration.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (create)\n\n## Requirements\n- Test: create trail via `cupboard set trails`\n- Test: add crumbs to trail via belongs_to link\n- Test: complete trail removes belongs_to links, crumbs survive\n- Test: abandon trail deletes crumbs that belong to it\n- Test: trail state transitions via CLI\n- Test: list trails, filter by state\n\n## Design Decisions\n- Use generic table CLI for trail and link operations\n- Verify cascade effects by checking crumb and link counts\n\n## Acceptance Criteria\n- [ ] Trail creation and state transitions tested\n- [ ] Complete cascade verified\n- [ ] Abandon cascade verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.191691-05:00","created_by":"petardjukic","updated_at":"2026-02-13T19:09:09.429872-05:00","closed_at":"2026-02-13T19:09:09.429872-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ni2","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.887988-05:00","created_by":"petardjukic"}],"comments":[{"id":66,"issue_id":"generation-2026-02-13-07-56-44-ni2","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"},{"id":104,"issue_id":"generation-2026-02-13-07-56-44-ni2","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-14T00:02:48Z\",\"duration_s\":380,\"tokens\":{\"input\":12064,\"output\":15496},\"loc_before\":{\"production\":6208,\"test\":13515},\"loc_after\":{\"production\":6208,\"test\":14088},\"diff\":{\"files\":2,\"insertions\":574,\"deletions\":1}}","created_at":"2026-02-14T00:09:09Z"}]}
{"id":"generation-2026-02-13-07-56-44-ny0","title":"Add integration tests for JSONL git roundtrip (rel01.1-uc002)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc002-jsonl-git-roundtrip.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc002-jsonl-git-roundtrip.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (create)\n\n## Requirements\n- Test: create crumbs and trails, verify JSONL files written\n- Test: delete cupboard.db, re-init, verify all entities restored from JSONL\n- Test: JSONL files are human-readable (valid JSON per line)\n- Test: JSONL files contain expected number of lines after operations\n\n## Design Decisions\n- Use CLI commands to create entities\n- Directly read JSONL files for verification\n- Delete DB file between attach cycles\n\n## Acceptance Criteria\n- [ ] Entities survive DB deletion and re-attach\n- [ ] JSONL files contain valid JSON lines\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.339254-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:27:32.419991-05:00","closed_at":"2026-02-13T18:27:32.419991-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ny0","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.245209-05:00","created_by":"petardjukic"}],"comments":[{"id":60,"issue_id":"generation-2026-02-13-07-56-44-ny0","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":98,"issue_id":"generation-2026-02-13-07-56-44-ny0","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:20:40Z\",\"duration_s\":411,\"tokens\":{\"input\":24,\"output\":25964},\"loc_before\":{\"production\":6101,\"test\":9980},\"loc_after\":{\"production\":6101,\"test\":10737},\"diff\":{\"files\":2,\"insertions\":758,\"deletions\":1}}","created_at":"2026-02-13T23:27:32Z"}]}
{"id":"generation-2026-02-13-07-56-44-ny9","title":"Implement trails, links, and properties table accessors","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R5.5-R5.7 trail cascade, R12 table routing)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity)\n- docs/specs/product-requirements/prd007-links-interface.yaml (Link entity, types, uniqueness)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (Property, Category entities)\n- internal/sqlite/crumbs_table.go (existing pattern)\n- internal/sqlite/jsonl.go (JSONL helpers)\n\n## Files to Create/Modify\n- internal/sqlite/trails_table.go (create) - trailsTable implementing Table; Get, Set (with cascade on state change: completed removes belongs_to links, abandoned cascades crumb deletion), Delete, Fetch\n- internal/sqlite/links_table.go (create) - linksTable implementing Table; Get, Set (validate uniqueness constraint link_type+from_id+to_id), Delete, Fetch (filter by link_type, from_id, to_id)\n- internal/sqlite/properties_table.go (create) - propertiesTable implementing Table; Get, Set (with backfill: creating property seeds defaults for all existing crumbs), Delete, Fetch\n\n## Requirements\n- trailsTable: hydrate/dehydrate Trail per prd002 R14.3; Set detects state change to completed (remove belongs_to links) or abandoned (cascade delete crumbs + their properties/metadata/links) per prd002 R5.6-R5.7\n- linksTable: hydrate/dehydrate Link per prd002 R14.6; Set validates uniqueness of (link_type, from_id, to_id); Fetch supports filter by link_type, from_id, to_id\n- propertiesTable: hydrate/dehydrate Property per prd002 R14.4; Set triggers backfill of crumb_properties for all existing crumbs when creating a new property\n- Each table persists to its JSONL file atomically\n\n## Design Decisions\n- Trail cascade runs inside the same SQLite transaction as the state update\n- Link uniqueness enforced at SQL level (UNIQUE constraint) and returned as appropriate error\n- Property backfill queries all crumbs and inserts default property values\n\n## Acceptance Criteria\n- [ ] trailsTable implements Table; cascade on completed/abandoned works\n- [ ] linksTable implements Table; uniqueness enforced\n- [ ] propertiesTable implements Table; backfill on creation works\n- [ ] All tables persist to JSONL atomically\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.260855-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:40:40.849524-05:00","closed_at":"2026-02-12T07:40:40.849524-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ny9","depends_on_id":"generation-2026-02-13-07-56-44-a1t","type":"blocks","created_at":"2026-02-12T07:18:37.306381-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-p57","title":"Add integration tests for property enforcement (S1-S9)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S1-S9 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 1-9)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (integration test patterns)\n- internal/sqlite/seed.go (built-in property seeding)\n- internal/sqlite/crumbs_table.go (auto-init on creation)\n- internal/sqlite/properties_table.go (backfill on definition)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc001_property_enforcement_test.go (create)\n\n## Requirements\n- Test built-in properties exist after attach (S1-S3): priority, type, description, owner, labels all present with correct value types\n- Test auto-initialization on crumb creation (S4-S6): new crumb has all properties initialized with type defaults\n- Test backfill on property definition (S7-S9): defining new property backfills all existing crumbs\n- Use table-driven tests mapping to YAML test cases\n- Test via Go API (Cupboard.GetTable, Table.Set/Get/Fetch)\n\n## Design Decisions\n- Integration tests use real SQLite backend with temp directories\n- Each test case starts from preconditions (fresh cupboard)\n- Verify property values by getting crumb and checking Properties map\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S9 from the use case\n- [ ] Tests use table-driven pattern\n- [ ] All tests pass with go test ./tests/integration/... -run TestPropertyEnforcement\n- [ ] Tests are independent (each uses its own temp directory)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.514036-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:25:20.578965-05:00","closed_at":"2026-02-12T18:25:20.578965-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-p57","depends_on_id":"generation-2026-02-13-07-56-44-hlm","type":"blocks","created_at":"2026-02-12T17:46:33.255441-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-p85","title":"Add unit tests for Stash entity methods (pkg/types)","description":"## Required Reading\n- pkg/types/stash.go (Stash struct, SetValue, GetValue, Increment, Acquire, Release)\n- pkg/types/constants.go (stash types: resource, artifact, context, counter, lock)\n- pkg/types/errors.go (ErrLockHeld, ErrNotLockHolder, ErrInvalidHolder, ErrInvalidStashType)\n- docs/specs/product-requirements/prd008-stash-interface.yaml R4-R7\n\n## Files to Create/Modify\n- pkg/types/stash_test.go (create)\n\n## Requirements\n- Test SetValue: updates value and increments version for non-lock stashes\n- Test SetValue: rejects lock-type stashes with error\n- Test GetValue: returns current value\n- Test Increment: adds delta to counter, increments version, returns new value\n- Test Increment: rejects non-counter stash types\n- Test Acquire: sets lock for holder, reentrant for same holder, returns ErrLockHeld for different holder\n- Test Release: clears lock, returns ErrNotLockHolder if not held by caller\n- Test Release: empty holder returns ErrInvalidHolder\n\n## Design Decisions\n- Table-driven tests per go-style rule\n\n## Acceptance Criteria\n- [ ] All value methods tested with valid and invalid inputs\n- [ ] Counter increment tested with positive and negative deltas\n- [ ] Lock acquire/release tested including reentrancy and contention\n- [ ] Tests pass with `go test ./pkg/types/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.303061-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:59:30.195063-05:00","closed_at":"2026-02-13T13:59:30.195063-05:00","close_reason":"Closed","comments":[{"id":40,"issue_id":"generation-2026-02-13-07-56-44-p85","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":79,"issue_id":"generation-2026-02-13-07-56-44-p85","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T18:57:54Z\",\"duration_s\":95,\"tokens\":{\"input\":10,\"output\":5985},\"loc_before\":{\"production\":6072,\"test\":473},\"loc_after\":{\"production\":6072,\"test\":814},\"diff\":{\"files\":2,\"insertions\":342,\"deletions\":1}}","created_at":"2026-02-13T18:59:30Z"}]}
{"id":"generation-2026-02-13-07-56-44-q3e","title":"Add unit tests for CrumbTable CRUD operations","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (test cases for Table CRUD)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (test cases for crumb state machine)\n- internal/sqlite/table_crumb.go (implementation under test)\n- internal/sqlite/backend.go (Backend.Attach for test setup)\n- pkg/types/crumb.go (Crumb entity)\n- .claude/rules/go-style.md (testing conventions, table-driven tests)\n\n## Files to Create/Modify\n- internal/sqlite/table_crumb_test.go (create)\n\n## Requirements\n- Test Get: existing crumb returns correct data, non-existent crumb returns ErrNotFound\n- Test Set (create): empty ID generates UUID v7, sets state to draft, returns generated ID\n- Test Set (update): existing crumb updates fields, preserves ID\n- Test Set: invalid state transition returns error\n- Test Delete: existing crumb removed, non-existent returns ErrNotFound\n- Test Delete: cascade removes properties, metadata, links for deleted crumb\n- Test Fetch: filter by states, trail_id, parent_id, limit, offset\n- Test Fetch: empty filter returns all crumbs\n- Test Fetch: no matches returns empty slice\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Reuse testutil_test.go helpers\n- Use testify/assert for assertions\n\n## Acceptance Criteria\n- [ ] Tests cover Get, Set (create and update), Delete, Fetch\n- [ ] Cascade delete verified (properties, metadata, links removed)\n- [ ] Filter combinations tested\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.851194-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:07:53.470669-05:00","closed_at":"2026-02-13T14:07:53.470669-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-q3e","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:42.644593-05:00","created_by":"petardjukic"}],"comments":[{"id":43,"issue_id":"generation-2026-02-13-07-56-44-q3e","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":82,"issue_id":"generation-2026-02-13-07-56-44-q3e","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T19:02:39Z\",\"duration_s\":313,\"tokens\":{\"input\":145,\"output\":19850},\"loc_before\":{\"production\":6072,\"test\":1001},\"loc_after\":{\"production\":6072,\"test\":1681},\"diff\":{\"files\":2,\"insertions\":681,\"deletions\":1}}","created_at":"2026-02-13T19:07:53Z"}]}
{"id":"generation-2026-02-13-07-56-44-qg7","title":"Extract shared CLI helpers: attachBackend and entity JSON parsing","description":"## Required Reading\n- cmd/cupboard/get.go (after task 0 — backend initialization pattern)\n- cmd/cupboard/set.go (after task 1 — parseEntityJSON pattern)\n- cmd/cupboard/list.go (after task 2 — shared patterns)\n- cmd/cupboard/delete.go (after task 3 — shared patterns)\n- pkg/types/cupboard.go (standard table name constants)\n- pkg/types/*.go (all entity structs)\n\n## Files to Create/Modify\n- cmd/cupboard/helpers.go (create) — shared helper functions\n- cmd/cupboard/get.go (modify) — use shared helpers\n- cmd/cupboard/set.go (modify) — use shared helpers\n- cmd/cupboard/list.go (modify) — use shared helpers\n- cmd/cupboard/delete.go (modify) — use shared helpers\n\n## Requirements\n- Extract `attachBackend() (*sqlite.Backend, error)` that resolves data dir, creates backend, attaches with sqlite config\n- Extract `parseEntityJSON(tableName string, data []byte) (any, error)` that unmarshals JSON into the correct entity type based on table name\n- Extract `validTableNames` constant string for error messages listing valid tables\n- Deduplicate any repeated patterns across the four command files\n- Follow go-style rule: no duplicated code, extract when pattern appears twice\n\n## Acceptance Criteria\n- [ ] helpers.go contains attachBackend, parseEntityJSON, and validTableNames\n- [ ] All four commands (get, set, list, delete) use shared helpers\n- [ ] No duplicated backend initialization code across command files\n- [ ] All existing tests still pass\n- [ ] Each command file focuses on its specific logic only","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.259742-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:11:49.759987-05:00","closed_at":"2026-02-12T12:11:49.759987-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-qg7","depends_on_id":"generation-2026-02-13-07-56-44-vc2","type":"blocks","created_at":"2026-02-12T08:33:20.351836-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-qjr","title":"Add unit tests for JSONL roundtrip (write, delete DB, re-attach)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc002-jsonl-git-roundtrip.yaml (roundtrip test cases)\n- internal/sqlite/jsonl.go (ReadJSONL, WriteJSONL, EnsureJSONLFiles, SyncManager)\n- internal/sqlite/backend.go (Attach loads JSONL, Detach flushes)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml R1, R2, R4, R5\n\n## Files to Create/Modify\n- internal/sqlite/jsonl_test.go (create)\n\n## Requirements\n- Test ReadJSONL: reads well-formed JSONL, skips malformed lines\n- Test WriteJSONL: atomic write pattern (file exists after write, content matches)\n- Test EnsureJSONLFiles: creates all 9 files if missing, no-op if they exist\n- Test roundtrip: attach, create crumbs/trails/links, detach (flushes JSONL), delete cupboard.db, re-attach, verify all entities restored from JSONL\n- Test SyncManager immediate strategy: marks dirty, flush writes files\n\n## Design Decisions\n- Table-driven tests for ReadJSONL edge cases (empty file, malformed lines, valid lines)\n- Roundtrip test uses real Backend attach/detach cycle\n\n## Acceptance Criteria\n- [ ] ReadJSONL handles well-formed and malformed input\n- [ ] WriteJSONL produces correct file content\n- [ ] Roundtrip test verifies persistence survives DB deletion\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"in_progress","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.372042-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:15:24.797847-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-qjr","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.186577-05:00","created_by":"petardjukic"}],"comments":[{"id":47,"issue_id":"generation-2026-02-13-07-56-44-qjr","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"}]}
{"id":"generation-2026-02-13-07-56-44-r5w","title":"Update road-map.yaml to mark rel03.0 complete","description":"## Required Reading\n- docs/road-map.yaml (current roadmap)\n- docs/specs/use-cases/rel03.0-uc002-link-management.yaml (now done)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (now done)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update release 03.0 use case status)\n\n## Requirements\nUpdate road-map.yaml to reflect completion of release 03.0:\n1. Change rel03.0-uc002 status from \"not_started\" to \"done\"\n2. Change rel03.0-uc003 status from \"not_started\" to \"done\"\n3. Verify all four use cases in release 03.0 are now marked \"done\"\n4. Verify done_when condition is met (\"An agent can explore implementation approaches with trails, abandoning failed attempts and completing successful ones\")\n\n## Design Decisions\n- Only update status fields (not descriptions or deliverables)\n- Verify no other changes needed in road-map.yaml\n- Follow YAML syntax per roadmap schema\n\n## Acceptance Criteria\n- [ ] rel03.0-uc002-link-management status: done\n- [ ] rel03.0-uc003-stash-operations status: done\n- [ ] All four use cases in release 03.0 marked done\n- [ ] YAML syntax valid (no parse errors)\n- [ ] File saved as docs/road-map.yaml","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.33117-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:13:26.403709-05:00","closed_at":"2026-02-13T02:13:26.403709-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-r5w","depends_on_id":"generation-2026-02-13-07-56-44-kik","type":"blocks","created_at":"2026-02-13T01:50:44.359137-05:00","created_by":"petardjukic"}],"comments":[{"id":144,"issue_id":"generation-2026-02-13-07-56-44-r5w","author":"petardjukic","text":"duration: 57s | tokens: in=28 out=2332 | loc: +1 -1 files=1","created_at":"2026-02-13T07:13:26Z"}]}
{"id":"generation-2026-02-13-07-56-44-rh1","title":"Create do-work.sh script for agent workflow (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F5 do-work.sh script)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (do-work test cases)\n- docs/engineering/eng01-git-integration.md (git conventions)\n- docs/engineering/eng02-generation-workflow.md (generation lifecycle)\n- .claude/rules/beads-workflow.md (workflow reference)\n\n## Files to Create/Modify\n- scripts/do-work.sh (create) — agent workflow automation script\n\n## Requirements\n- Pick task: run `cupboard ready -n 1 --json --type task` and parse JSON to get task ID\n- Validate task exists and is in ready state\n- Create git worktree for the task (eng01 pattern)\n- Transition task to taken: `cupboard update \u003cid\u003e --status taken`\n- Invoke Claude Code or other agent with context\n- After agent completes, verify changes\n- Merge worktree back to main branch\n- Close task: `cupboard close \u003cid\u003e`\n- Clean up worktree\n- Handle errors at each step with meaningful messages\n- Exit 0 on success, non-zero on failure\n\n## Design Decisions\n- Script uses cupboard CLI commands, not library calls\n- All cupboard commands use --json for machine-readable output\n- Git worktree pattern per eng01-git-integration\n- Script is idempotent (can be re-run after failure)\n- Cleanup happens even on error (trap EXIT)\n\n## Acceptance Criteria\n- [ ] Script picks a ready task via cupboard ready\n- [ ] Script creates git worktree for task\n- [ ] Script transitions task to taken state\n- [ ] Script can invoke agent (placeholder for now)\n- [ ] Script merges worktree after completion\n- [ ] Script closes task on success\n- [ ] Script cleans up worktree on exit\n- [ ] Script handles errors and exits non-zero\n- [ ] Script uses --json flag for all cupboard commands","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.509891-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:39:28.084206-05:00","closed_at":"2026-02-13T00:39:28.084206-05:00","close_reason":"Closed","comments":[{"id":145,"issue_id":"generation-2026-02-13-07-56-44-rh1","author":"petardjukic","text":"duration: 1m51s | tokens: in=48 out=5158 | loc: +279 -1 files=2","created_at":"2026-02-13T05:39:27Z"}]}
{"id":"generation-2026-02-13-07-56-44-rpi","title":"Implement configuration loading with platform defaults and precedence chain","description":"## Required Reading\n- docs/specs/product-requirements/prd010-configuration-directories.yaml (R1-R2 directory structure, R8 precedence)\n- docs/specs/use-cases/rel01.1-uc003-configuration-loading.yaml (flow F1-F7, success criteria S1-S9)\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R6 global flags)\n- cmd/cupboard/root.go (existing resolveDataDir, global flags)\n\n## Files to Create/Modify\n- internal/paths/paths.go (create) — platform-specific default paths and resolution functions\n- internal/paths/paths_test.go (create) — unit tests for path resolution\n- cmd/cupboard/root.go (modify) — replace resolveDataDir with paths.ResolveDataDir, add resolveConfigDir\n\n## Requirements\n- Implement DefaultConfigDir() and DefaultDataDir() per prd010 R1.2 and R2.2:\n  - Linux: XDG_CONFIG_HOME/crumbs and XDG_DATA_HOME/crumbs (fallback ~/.config/crumbs and ~/.local/share/crumbs)\n  - macOS: ~/Library/Application Support/crumbs (both config and data)\n  - Windows: %APPDATA%/crumbs (both config and data)\n- Implement ResolveConfigDir(flag, env string) string: flag \u003e CRUMBS_CONFIG_DIR env \u003e DefaultConfigDir()\n- Implement ResolveDataDir(flag, configYAMLValue, env string) string: flag \u003e config.yaml data_dir \u003e CRUMBS_DATA_DIR env \u003e DefaultDataDir()\n- For CWD-relative defaults: when --data-dir is empty and no config or env override, use $(CWD)/.crumbs-db (current behavior preserved)\n\n## Design Decisions\n- Use runtime.GOOS for platform detection\n- Use os.UserHomeDir() and os.UserConfigDir() for cross-platform home paths\n- Keep CWD-relative defaults as the primary mode (matching current behavior); platform defaults are used only when env/flag overrides are provided\n\n## Acceptance Criteria\n- [ ] DefaultConfigDir returns correct path per platform\n- [ ] DefaultDataDir returns correct path per platform\n- [ ] ResolveConfigDir follows flag \u003e env \u003e default precedence\n- [ ] ResolveDataDir follows flag \u003e config \u003e env \u003e default precedence\n- [ ] Unit tests verify each precedence level\n- [ ] root.go resolveDataDir uses the new paths package","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.528459-05:00","created_by":"petardjukic","updated_at":"2026-02-12T12:20:28.056822-05:00","closed_at":"2026-02-12T12:20:28.056822-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-rrd","title":"Add unit tests for PropertyTable and CategoryTable","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (property test cases)\n- internal/sqlite/table_property.go (PropertyTable implementation)\n- internal/sqlite/table_category.go (CategoryTable implementation)\n- docs/specs/product-requirements/prd004-properties-interface.yaml R4-R8\n\n## Files to Create/Modify\n- internal/sqlite/table_property_test.go (create)\n- internal/sqlite/table_category_test.go (create)\n\n## Requirements\n- PropertyTable Get: existing property, non-existent returns ErrNotFound\n- PropertyTable Set (create): generates UUID v7, validates name uniqueness, validates value type\n- PropertyTable Set (create): backfills default value to all existing crumbs\n- PropertyTable Set: duplicate name returns ErrDuplicateName\n- PropertyTable Delete: cascade removes crumb_properties and categories\n- PropertyTable Fetch: filter by value_type\n- CategoryTable Get: existing category, non-existent returns ErrNotFound\n- CategoryTable Set (create): validates PropertyID references categorical property\n- CategoryTable Set: name uniqueness scoped per property\n- CategoryTable Fetch: filter by property_id, ordered by ordinal\n\n## Design Decisions\n- Table-driven tests\n- Property backfill test: create crumbs first, then create property, verify all crumbs have default value\n\n## Acceptance Criteria\n- [ ] Property CRUD and validation tested\n- [ ] Property backfill verified\n- [ ] Category CRUD and validation tested\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.898169-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:38:52.523735-05:00","closed_at":"2026-02-13T17:38:52.523735-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-rrd","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.473124-05:00","created_by":"petardjukic"}],"comments":[{"id":50,"issue_id":"generation-2026-02-13-07-56-44-rrd","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":88,"issue_id":"generation-2026-02-13-07-56-44-rrd","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:34:04Z\",\"duration_s\":288,\"tokens\":{\"input\":18,\"output\":15970},\"loc_before\":{\"production\":6101,\"test\":4511},\"loc_after\":{\"production\":6101,\"test\":5643},\"diff\":{\"files\":3,\"insertions\":1133,\"deletions\":1}}","created_at":"2026-02-13T22:38:52Z"}]}
{"id":"generation-2026-02-13-07-56-44-rsn","title":"Add integration tests for table CRUD (rel01.0-uc002)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (test cases)\n- docs/specs/use-cases/rel01.0-uc002-table-crud.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (create)\n\n## Requirements\n- Test Set on crumbs: create new crumb with empty ID, update existing crumb\n- Test Get on crumbs: retrieve by ID, non-existent returns error\n- Test Fetch on crumbs: list all, filter by state\n- Test Delete on crumbs: remove crumb, verify gone\n- Test CRUD on trails: create, get, update state, list, delete\n- Test CRUD on links: create belongs_to link, get, list by type, delete\n- Test JSONL persistence: entities survive detach/re-attach cycle\n\n## Design Decisions\n- Use generic table CLI commands (cupboard set, get, list, delete)\n- Table-driven tests per entity type\n\n## Acceptance Criteria\n- [ ] CRUD tested for crumbs, trails, links\n- [ ] JSONL persistence verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:40.082659-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:15:21.787091-05:00","closed_at":"2026-02-13T18:15:21.787091-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-rsn","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:44.054499-05:00","created_by":"petardjukic"}],"comments":[{"id":58,"issue_id":"generation-2026-02-13-07-56-44-rsn","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":96,"issue_id":"generation-2026-02-13-07-56-44-rsn","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T23:07:50Z\",\"duration_s\":451,\"tokens\":{\"input\":36,\"output\":30943},\"loc_before\":{\"production\":6101,\"test\":8707},\"loc_after\":{\"production\":6101,\"test\":9562},\"diff\":{\"files\":2,\"insertions\":856,\"deletions\":1}}","created_at":"2026-02-13T23:15:21Z"}]}
{"id":"generation-2026-02-13-07-56-44-s96","title":"Add integration tests for cupboard lifecycle (rel01.0-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (12 test cases)\n- docs/specs/use-cases/rel01.0-uc001-cupboard-lifecycle.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (create)\n\n## Requirements\n- Implement test cases from test-rel01.0-uc001-cupboard-lifecycle.yaml:\n  - Initialize cupboard, verify JSONL files created\n  - Create single trail, verify ID and state\n  - Create multiple trails, verify unique IDs\n  - Complete trail, verify state transition\n  - Abandon trail, verify state transition\n  - Link crumb to trail via belongs_to\n  - Link multiple crumbs to different trails\n  - Trails persisted to JSONL\n  - Full lifecycle workflow: crumbs + trails + links + complete + abandon with cascade\n\n## Design Decisions\n- Use CLI test harness (runCupboard helper)\n- Parse JSON output for assertions\n- Table-driven where test cases share structure\n\n## Acceptance Criteria\n- [ ] All 12 test cases from YAML spec implemented\n- [ ] Cascade operations verified (complete removes links, abandon deletes crumbs)\n- [ ] JSONL persistence verified\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.9538-05:00","created_by":"petardjukic","updated_at":"2026-02-13T18:07:49.525587-05:00","closed_at":"2026-02-13T18:07:49.525587-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-s96","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:43.959091-05:00","created_by":"petardjukic"}],"comments":[{"id":57,"issue_id":"generation-2026-02-13-07-56-44-s96","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":95,"issue_id":"generation-2026-02-13-07-56-44-s96","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:59:41Z\",\"duration_s\":488,\"tokens\":{\"input\":63,\"output\":24525},\"loc_before\":{\"production\":6101,\"test\":8300},\"loc_after\":{\"production\":6101,\"test\":8707},\"diff\":{\"files\":2,\"insertions\":408,\"deletions\":1}}","created_at":"2026-02-13T23:07:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-s9b","title":"Add integration tests for regeneration compatibility (rel02.0-uc002)","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n\n## Requirements\n- Test: create entities with one version, write JSONL, load with same version\n- Test: JSONL files written by current version are valid JSON\n- Test: entities round-trip through JSONL serialization without data loss\n- Test: all 9 JSONL file types round-trip correctly\n\n## Design Decisions\n- Create entities, detach, re-attach, verify all data intact\n- Compare entity counts and field values before and after\n\n## Acceptance Criteria\n- [ ] All entity types round-trip through JSONL\n- [ ] No data loss on re-attach\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:42.023591-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:42.023591-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-s9b","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.463379-05:00","created_by":"petardjukic"}],"comments":[{"id":72,"issue_id":"generation-2026-02-13-07-56-44-s9b","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-sdw","title":"Complete stash lock operations test coverage","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (test cases TC12-TC17)\n- docs/specs/product-requirements/prd008-stash-interface.yaml (R6: Lock operations)\n- docs/specs/use-cases/rel03.0-uc003-stash-operations.yaml (flow F12-F17)\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (existing test structure)\n- pkg/types/stash.go (Acquire and Release methods)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc003_stash_operations_test.go (add test cases for S7, S8, S9)\n\n## Requirements\nImplement integration test cases validating:\n1. Acquire lock (success criterion S7)\n   - Create lock stash with nil value\n   - Call Acquire('worker-1')\n   - Verify success, Version increments, Value contains holder and acquired_at\n   - Persist via Table.Set\n2. Reentrant acquire (success criterion S8)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Acquire('worker-1') again\n   - Verify success without error (reentrant)\n3. Lock contention (success criterion S7)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Acquire('worker-2')\n   - Verify ErrLockHeld returned\n4. Release lock (success criterion S9)\n   - Create lock stash, acquire by 'worker-1'\n   - Call Release('worker-1')\n   - Verify success, Value is nil, Version increments\n5. Wrong holder release\n   - Create lock stash, acquire by 'worker-1'\n   - Call Release('worker-2')\n   - Verify ErrNotLockHolder returned\n\nTest cases must validate prd008-stash-interface R6.2, R6.3 (Acquire/Release semantics, reentrant, error handling).\n\n## Design Decisions\n- Use table-driven tests for various lock scenarios\n- Validate Version increments on Acquire and Release\n- Test reentrant acquire (same holder)\n- Test lock contention (different holder)\n- Validate error types with errors.Is\n\n## Acceptance Criteria\n- [ ] TestStashOperations_AcquireSetsHolderAndIncrementsVersion passes (validates S7)\n- [ ] TestStashOperations_AcquireByCurrentHolderSucceeds passes (validates S8, reentrant)\n- [ ] TestStashOperations_AcquireByDifferentHolderReturnsLockHeld passes (validates S7)\n- [ ] TestStashOperations_ReleaseUnsetsLockAndIncrementsVersion passes (validates S9)\n- [ ] TestStashOperations_ReleaseByWrongHolderReturnsNotLockHolder passes\n- [ ] Tests validate prd008-stash-interface R6.2, R6.3 (Acquire/Release, reentrant, errors)\n- [ ] All tests pass: go test -v ./tests/integration -run TestStashOperations","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:42.685173-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:02:19.912764-05:00","closed_at":"2026-02-13T02:02:19.912764-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-sdw","depends_on_id":"generation-2026-02-13-07-56-44-kyb","type":"blocks","created_at":"2026-02-13T01:50:43.975705-05:00","created_by":"petardjukic"}],"comments":[{"id":146,"issue_id":"generation-2026-02-13-07-56-44-sdw","author":"petardjukic","text":"duration: 55s | tokens: in=21 out=2675 | loc: +1 -1 files=1","created_at":"2026-02-13T07:02:19Z"}]}
{"id":"generation-2026-02-13-07-56-44-u5h","title":"Implement issue-tracking CLI ready and show commands","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R4.2 ready, R4.5 show commands)\n- docs/specs/use-cases/rel02.1-uc001-issue-tracking-cli.yaml (F2 ready, F5 show, S3-S4, S7)\n- docs/specs/test-suites/test-rel02.1-uc001-issue-tracking-cli.yaml (test cases 4-5, 8)\n- cmd/cupboard/list.go (list command for reference)\n- cmd/cupboard/get.go (get command for reference)\n\n## Files to Create/Modify\n- cmd/cupboard/ready.go (create) — ready command (list open crumbs)\n- cmd/cupboard/show.go (create) — show command (display crumb details with properties)\n- cmd/cupboard/root.go (modify) — register ready and show commands\n\n## Requirements\n- `cupboard ready [--type \u003ctype\u003e] [--json]` — list crumbs in ready state, optionally filtered by type\n- `cupboard show \u003cid\u003e [--json]` — display crumb with all properties, metadata, and links\n- ready outputs table format by default (id, type, title, priority) or JSON with --json\n- show outputs human-readable detail by default or JSON with --json\n- Exit 1 if show receives nonexistent ID\n\n## Design Decisions\n- ready filters by state=ready using Table.Fetch\n- show combines data from crumbs table, properties, and metadata\n- Reuse attachBackend helper\n\n## Acceptance Criteria\n- [ ] `cupboard ready` lists crumbs in ready state\n- [ ] `cupboard ready --type task` filters by type property\n- [ ] `cupboard show \u003cid\u003e` displays crumb details with properties\n- [ ] `cupboard show \u003cinvalid-id\u003e` exits 1\n- [ ] Both commands support --json flag\n- [ ] Commands registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:07.481002-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:16:13.895338-05:00","closed_at":"2026-02-12T23:16:13.895338-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-u5h","depends_on_id":"generation-2026-02-13-07-56-44-0c8","type":"blocks","created_at":"2026-02-12T14:57:08.383706-05:00","created_by":"petardjukic"}],"comments":[{"id":147,"issue_id":"generation-2026-02-13-07-56-44-u5h","author":"petardjukic","text":"duration: 3m1s | tokens: in=73 out=8324 | loc: +307 -1 files=5","created_at":"2026-02-13T04:16:13Z"}]}
{"id":"generation-2026-02-13-07-56-44-ugq","title":"Mark rel03.0-uc001-trail-exploration as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.0-uc001-trail-exploration.yaml (use case definition)\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.0-uc001-trail-exploration from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.0-uc001-trail-exploration status changed to \"done\" in road-map.yaml\n- [ ] Release 03.0 use cases count updated to 3/4 done\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.192413-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:23:23.840455-05:00","closed_at":"2026-02-13T01:23:23.840455-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ugq","depends_on_id":"generation-2026-02-13-07-56-44-z5j","type":"blocks","created_at":"2026-02-13T01:09:08.057258-05:00","created_by":"petardjukic"}],"comments":[{"id":148,"issue_id":"generation-2026-02-13-07-56-44-ugq","author":"petardjukic","text":"duration: 43s | tokens: in=22 out=1558 | loc: +2 -2 files=2","created_at":"2026-02-13T06:23:23Z"}]}
{"id":"generation-2026-02-13-07-56-44-ukh","title":"Mark rel03.0-uc004-trail-crumb-lifecycle as done in road-map.yaml","description":"## Required Reading\n- docs/road-map.yaml (roadmap status)\n- docs/specs/use-cases/rel03.0-uc004-trail-crumb-lifecycle.yaml (use case definition)\n- tests/integration/test_rel03_0_uc004_trail_crumb_lifecycle_test.go (completed tests, dependency)\n\n## Files to Create/Modify\n- docs/road-map.yaml (update)\n\n## Requirements\nUpdate the status of rel03.0-uc004-trail-crumb-lifecycle from \"not_started\" to \"done\" in road-map.yaml after all tests pass.\n\n## Design Decisions\nN/A - simple status update\n\n## Acceptance Criteria\n- [ ] rel03.0-uc004-trail-crumb-lifecycle status changed to \"done\" in road-map.yaml\n- [ ] Release 03.0 use cases count updated to 4/4 done\n- [ ] Release 03.0 status changed from \"in progress\" to \"done\"\n- [ ] File saved and committed","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:07.321456-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:24:12.173515-05:00","closed_at":"2026-02-13T01:24:12.173515-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-ukh","depends_on_id":"generation-2026-02-13-07-56-44-bul","type":"blocks","created_at":"2026-02-13T01:09:08.167996-05:00","created_by":"petardjukic"}],"comments":[{"id":149,"issue_id":"generation-2026-02-13-07-56-44-ukh","author":"petardjukic","text":"duration: 48s | tokens: in=23 out=1875 | loc: +2 -2 files=2","created_at":"2026-02-13T06:24:12Z"}]}
{"id":"generation-2026-02-13-07-56-44-uss","title":"Implement generic table CLI delete command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.3 delete command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S10-S11 success criteria for delete)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n\n## Files to Create/Modify\n- cmd/cupboard/delete.go (create) — delete command implementation\n- cmd/cupboard/root.go (modify) — register delete command\n\n## Requirements\n- Implement `cupboard delete \u003ctable\u003e \u003cid\u003e` per prd009-cupboard-cli R3.3\n- Accept table name and entity ID as positional arguments (cobra.ExactArgs(2))\n- Call Table.Delete(id) and output \"Deleted \u003ctable\u003e/\u003cid\u003e\" on success\n- Exit 1 with \"entity not found\" for missing entity\n- Exit 1 with \"unknown table\" for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Reuse attachBackend() helper from get command\n- Simple command: no JSON output needed for delete (human message only, unless --json flag added later)\n\n## Acceptance Criteria\n- [ ] `cupboard delete crumbs \u003cvalid-id\u003e` removes entity, prints confirmation, exit 0\n- [ ] `cupboard delete crumbs \u003cnonexistent-id\u003e` returns exit 1 with not-found message\n- [ ] `cupboard delete unknown-table \u003cid\u003e` returns exit 1 with valid table names\n- [ ] Cascade delete works (deleting crumb removes its properties, metadata, links)\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:19.125864-05:00","created_by":"petardjukic","updated_at":"2026-02-12T15:18:28.818797-05:00","closed_at":"2026-02-12T15:18:28.818797-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-uss","depends_on_id":"generation-2026-02-13-07-56-44-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.253722-05:00","created_by":"petardjukic"}],"comments":[{"id":150,"issue_id":"generation-2026-02-13-07-56-44-uss","author":"petardjukic","text":"Duplicate of generation-2026-02-13-07-56-44-dc3 which already implemented the delete command. cmd/cupboard/delete.go exists and tests pass. Closing as stale.","created_at":"2026-02-12T20:18:25Z"}]}
{"id":"generation-2026-02-13-07-56-44-uvq","title":"Add unit tests for Backend lifecycle (Attach/Detach/GetTable)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (lifecycle test cases)\n- internal/sqlite/backend.go (implementation under test)\n- internal/sqlite/testutil_test.go (shared test helpers)\n- pkg/types/cupboard.go (Cupboard interface)\n- pkg/types/config.go (Config struct)\n\n## Files to Create/Modify\n- internal/sqlite/backend_test.go (create) — Unit tests for Backend\n\n## Requirements\n- Test Attach: valid config, invalid config (empty backend, empty data dir), directory creation\n- Test Detach: normal detach, double detach (idempotent), operations after detach return errors\n- Test GetTable: all six standard table names return non-nil, unknown table returns ErrTableNotFound\n- Test JSONL roundtrip: attach, create crumbs, detach, delete cupboard.db, re-attach, verify crumbs persist\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Reuse testutil_test.go helper\n\n## Acceptance Criteria\n- [ ] Attach tests cover valid and invalid configs\n- [ ] Detach tests verify idempotency and post-detach errors\n- [ ] GetTable tests verify all standard table names\n- [ ] JSONL roundtrip test verifies persistence survives DB deletion\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:43:34.354503-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:43:34.354503-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-uvq","depends_on_id":"generation-2026-02-13-07-56-44-gzt","type":"blocks","created_at":"2026-02-13T08:43:35.17674-05:00","created_by":"petardjukic"}],"comments":[{"id":28,"issue_id":"generation-2026-02-13-07-56-44-uvq","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T13:36:00Z\",\"duration_s\":452,\"tokens\":{\"input\":16,\"output\":8612},\"loc_before\":{\"production\":3105,\"test\":0},\"loc_after\":{\"production\":3105,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:43:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-vc2","title":"Implement generic table CLI set command","description":"## Required Reading\n- docs/specs/product-requirements/prd009-cupboard-cli.yaml (R3.2 set command specification)\n- docs/specs/product-requirements/prd001-cupboard-core.yaml (R3 Table interface)\n- docs/specs/use-cases/rel01.1-uc004-generic-table-cli.yaml (S4-S6 success criteria for set)\n- cmd/cupboard/get.go (pattern from get command, shared helpers)\n- internal/sqlite/crumbs_table.go (Set behavior: empty ID creates, existing ID updates)\n\n## Files to Create/Modify\n- cmd/cupboard/set.go (create) — set command implementation\n- cmd/cupboard/root.go (modify) — register set command\n\n## Requirements\n- Implement `cupboard set \u003ctable\u003e \u003cid\u003e \u003cjson\u003e` per prd009-cupboard-cli R3.2\n- Accept table name, ID, and JSON payload as positional arguments (cobra.ExactArgs(3))\n- Empty string ID (\"\") creates a new entity; non-empty ID updates existing\n- Parse JSON payload into appropriate entity struct based on table name\n- Call Table.Set(id, entity) and output the result as pretty-printed JSON\n- Exit 1 with parse error details for invalid JSON\n- Exit 1 with \"unknown table\" message for invalid table name\n- Error messages to stderr\n\n## Design Decisions\n- Need a `parseEntityJSON(tableName string, data []byte) (any, error)` function that unmarshals JSON into the correct entity type (*types.Crumb, *types.Trail, etc.) based on table name\n- Reuse attachBackend() helper from get command\n\n## Acceptance Criteria\n- [ ] `cupboard set crumbs \"\" '{\"Name\":\"Test\",\"State\":\"draft\"}'` creates crumb, returns JSON with CrumbID\n- [ ] `cupboard set crumbs \u003cid\u003e \u003cjson\u003e` updates existing crumb\n- [ ] `cupboard set crumbs \"\" '{invalid}'` returns exit 1 with parse error\n- [ ] `cupboard set unknown-table \"\" '{}'` returns exit 1 with valid table names\n- [ ] Works across table types: crumbs, trails, links, properties, metadata, stashes\n- [ ] Command registered in root.go init()","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T08:33:18.85488-05:00","created_by":"petardjukic","updated_at":"2026-02-12T08:38:54.810489-05:00","closed_at":"2026-02-12T08:38:54.810489-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-vc2","depends_on_id":"generation-2026-02-13-07-56-44-9eh","type":"blocks","created_at":"2026-02-12T08:33:20.056952-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-vjo","title":"Add unit tests for CrumbTable property operations","description":"## Required Reading\n- internal/sqlite/table_crumb.go (loadProperties, saveProperties, serialize/deserializePropertyValue)\n- docs/specs/product-requirements/prd003-crumbs-interface.yaml R5 (property operations)\n- docs/specs/product-requirements/prd004-properties-interface.yaml R4 (property always present)\n- internal/sqlite/seed.go (built-in properties)\n\n## Files to Create/Modify\n- internal/sqlite/table_crumb_properties_test.go (create)\n\n## Requirements\n- Test that new crumbs have all built-in properties initialized to defaults\n- Test SetProperty via crumb Set: categorical, text, integer, boolean, timestamp, list types\n- Test GetProperty via crumb Get: values round-trip correctly through serialize/deserialize\n- Test ClearProperty: resets to type-appropriate default\n- Test property value type serialization: each of the 6 value types\n\n## Design Decisions\n- Table-driven tests with one row per value type\n- Reuse testutil_test.go helpers\n\n## Acceptance Criteria\n- [ ] Built-in properties auto-initialized on crumb creation\n- [ ] All 6 value types round-trip through Set/Get\n- [ ] ClearProperty resets to default\n- [ ] Tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.985739-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:11:36.693285-05:00","closed_at":"2026-02-13T14:11:36.693285-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-vjo","depends_on_id":"generation-2026-02-13-07-56-44-q3e","type":"blocks","created_at":"2026-02-13T13:54:42.854941-05:00","created_by":"petardjukic"}],"comments":[{"id":44,"issue_id":"generation-2026-02-13-07-56-44-vjo","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":83,"issue_id":"generation-2026-02-13-07-56-44-vjo","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T19:07:54Z\",\"duration_s\":222,\"tokens\":{\"input\":26,\"output\":12100},\"loc_before\":{\"production\":6072,\"test\":1681},\"loc_after\":{\"production\":6101,\"test\":2224},\"diff\":{\"files\":3,\"insertions\":573,\"deletions\":1}}","created_at":"2026-02-13T19:11:36Z"}]}
{"id":"generation-2026-02-13-07-56-44-vqw","title":"Add unit tests for TrailTable CRUD and cascade operations","description":"## Required Reading\n- docs/specs/test-suites/test-rel03.0-uc001-trail-exploration.yaml (trail test cases)\n- docs/specs/test-suites/test-rel03.0-uc004-trail-crumb-lifecycle.yaml (cascade test cases)\n- internal/sqlite/table_trail.go (implementation under test)\n- docs/specs/product-requirements/prd006-trails-interface.yaml R3-R6\n\n## Files to Create/Modify\n- internal/sqlite/table_trail_test.go (create)\n\n## Requirements\n- Test Get: existing trail, non-existent trail\n- Test Set (create): empty ID generates UUID v7, default state draft\n- Test Set (update): state transitions (draft→active, active→completed, active→abandoned)\n- Test Delete: existing trail, non-existent trail\n- Test Fetch: filter by states, limit, offset\n- Test Complete cascade: completing trail removes all belongs_to links where to_id is trail; linked crumbs survive\n- Test Abandon cascade: abandoning trail deletes all crumbs that belong to trail (including their properties, metadata, links)\n\n## Design Decisions\n- Table-driven tests per go-style rule\n- Cascade tests require setting up crumbs, links, then transitioning trail\n- Reuse testutil_test.go helpers\n\n## Acceptance Criteria\n- [ ] CRUD operations tested\n- [ ] Complete cascade removes belongs_to links, keeps crumbs\n- [ ] Abandon cascade deletes crumbs, their properties, metadata, and links\n- [ ] All tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:38.501468-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:31:01.217938-05:00","closed_at":"2026-02-13T17:31:01.217938-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-vqw","depends_on_id":"generation-2026-02-13-07-56-44-wc2","type":"blocks","created_at":"2026-02-13T13:54:43.281838-05:00","created_by":"petardjukic"}],"comments":[{"id":48,"issue_id":"generation-2026-02-13-07-56-44-vqw","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:47Z"},{"id":86,"issue_id":"generation-2026-02-13-07-56-44-vqw","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:27:02Z\",\"duration_s\":239,\"tokens\":{\"input\":17,\"output\":14770},\"loc_before\":{\"production\":6101,\"test\":2734},\"loc_after\":{\"production\":6101,\"test\":3660},\"diff\":{\"files\":2,\"insertions\":927,\"deletions\":1}}","created_at":"2026-02-13T22:31:01Z"}]}
{"id":"generation-2026-02-13-07-56-44-wc2","title":"Create shared test helpers for SQLite backend tests","description":"## Required Reading\n- internal/sqlite/backend.go (Backend, Attach, Detach)\n- pkg/types/cupboard.go (Cupboard interface)\n- pkg/types/config.go (Config struct)\n- .claude/rules/go-style.md (testing conventions, reusable test helpers)\n\n## Files to Create/Modify\n- internal/sqlite/testutil_test.go (create)\n\n## Requirements\n- Create helper function `setupTestBackend(t *testing.T) (*Backend, func())` that:\n  - Creates a temporary directory\n  - Constructs a valid Config with Backend=\"sqlite\" and DataDir pointing to temp dir\n  - Calls Attach\n  - Returns the attached Backend and a cleanup function that calls Detach and removes temp dir\n- Create helper `mustSetCrumb(t *testing.T, table types.Table, name, state string) string` that creates a crumb and returns its ID\n- Create helper `mustSetTrail(t *testing.T, table types.Table, state string) string` that creates a trail and returns its ID\n- Create helper `mustSetLink(t *testing.T, table types.Table, linkType, fromID, toID string) string` that creates a link and returns its ID\n\n## Design Decisions\n- Use t.TempDir() for automatic cleanup\n- Use testify/require for helpers (fail fast on setup errors)\n- All helpers use testing.T for error reporting\n\n## Acceptance Criteria\n- [ ] setupTestBackend creates and attaches a backend in a temp dir\n- [ ] Helper functions create entities and return IDs\n- [ ] Cleanup function releases all resources\n- [ ] Helpers are importable by all internal/sqlite test files","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:37.564243-05:00","created_by":"petardjukic","updated_at":"2026-02-13T14:02:39.159361-05:00","closed_at":"2026-02-13T14:02:39.159361-05:00","close_reason":"Closed","comments":[{"id":42,"issue_id":"generation-2026-02-13-07-56-44-wc2","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:46Z"},{"id":81,"issue_id":"generation-2026-02-13-07-56-44-wc2","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T19:00:33Z\",\"duration_s\":125,\"tokens\":{\"input\":22,\"output\":5015},\"loc_before\":{\"production\":6072,\"test\":923},\"loc_after\":{\"production\":6072,\"test\":1001},\"diff\":{\"files\":3,\"insertions\":83,\"deletions\":1}}","created_at":"2026-02-13T19:02:39Z"}]}
{"id":"generation-2026-02-13-07-56-44-x1u","title":"Add unit tests for SQLite schema creation","description":"## Required Reading\n- internal/sqlite/schema.go (CreateSchema, DDL statements)\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml R3\n\n## Files to Create/Modify\n- internal/sqlite/schema_test.go (create)\n\n## Requirements\n- Test CreateSchema: creates all 9 tables (crumbs, trails, links, properties, categories, crumb_properties, metadata, stashes, stash_history)\n- Test CreateSchema: creates all expected indexes\n- Test CreateSchema: idempotent (calling twice does not error, uses IF NOT EXISTS)\n- Test unique constraints: properties.name uniqueness, links(link_type, from_id, to_id) uniqueness\n\n## Design Decisions\n- Use in-memory SQLite database for fast tests\n- Query sqlite_master to verify tables and indexes exist\n\n## Acceptance Criteria\n- [ ] All 9 tables verified\n- [ ] Key indexes verified\n- [ ] Idempotency verified\n- [ ] Tests pass with `go test ./internal/sqlite/...`","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:39.462813-05:00","created_by":"petardjukic","updated_at":"2026-02-13T17:52:16.789211-05:00","closed_at":"2026-02-13T17:52:16.789211-05:00","close_reason":"Closed","comments":[{"id":54,"issue_id":"generation-2026-02-13-07-56-44-x1u","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:48Z"},{"id":92,"issue_id":"generation-2026-02-13-07-56-44-x1u","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T22:50:01Z\",\"duration_s\":135,\"tokens\":{\"input\":25,\"output\":6911},\"loc_before\":{\"production\":6101,\"test\":7610},\"loc_after\":{\"production\":6101,\"test\":7760},\"diff\":{\"files\":3,\"insertions\":173,\"deletions\":23}}","created_at":"2026-02-13T22:52:16Z"}]}
{"id":"generation-2026-02-13-07-56-44-xa1","title":"Add integration tests for regeneration compatibility (S1-S8)","description":"## Required Reading\n- docs/specs/use-cases/rel02.0-uc002-regeneration-compatibility.yaml (S1-S8 success criteria)\n- docs/specs/test-suites/test-rel02.0-uc002-regeneration-compatibility.yaml (test cases)\n- internal/sqlite/loader.go (JSONL loading with forward compat)\n- internal/sqlite/loader_test.go (unit-level forward compat tests from task 6)\n- tests/integration/test_rel01_1_uc002_jsonl_git_roundtrip_test.go (roundtrip test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_0_uc002_regeneration_compatibility_test.go (create)\n- docs/road-map.yaml (modify) — mark rel02.0-uc002 as done\n\n## Requirements\n- Test JSONL files with unknown fields load without error (S1-S2)\n- Test crumb data survives simulated regeneration cycle (S3-S4)\n- Test adding a new property to existing JSONL data works (S5)\n- Test removing a field from struct still loads old JSONL (S6)\n- Test JSONL files remain valid after write-back with new struct version (S8)\n\n## Design Decisions\n- Simulate regeneration by creating JSONL files with extra fields, then loading via Cupboard.Attach\n- Use real SQLite backend with temp directories\n- Test both loader.go directly and via full Cupboard.Attach cycle\n\n## Acceptance Criteria\n- [ ] Tests cover S1-S8 from the use case\n- [ ] Tests pass with go test ./tests/integration/... -run TestRegenerationCompatibility\n- [ ] road-map.yaml updated to mark rel02.0-uc002 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:32.783514-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:33:37.420193-05:00","closed_at":"2026-02-12T18:33:37.420193-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-xa1","depends_on_id":"generation-2026-02-13-07-56-44-7gs","type":"blocks","created_at":"2026-02-12T17:46:33.353106-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-xgh","title":"Update SPECIFICATIONS.md with rel03.0 status","description":"## Required Reading\n- docs/SPECIFICATIONS.md (current content)\n- docs/specs/test-suites/test-rel03.0-uc002-link-management.yaml (now complete)\n- docs/specs/test-suites/test-rel03.0-uc003-stash-operations.yaml (now complete)\n- docs/road-map.yaml (release 03.0 status)\n- .claude/rules/specification-format.md (SPECIFICATIONS format rules)\n\n## Files to Create/Modify\n- docs/SPECIFICATIONS.md (regenerate)\n\n## Requirements\nRegenerate SPECIFICATIONS.md to reflect completion of rel03.0-uc002 and rel03.0-uc003:\n1. Update Roadmap Summary table (release 03.0: 4/4 use cases done)\n2. Verify Use Case Index reflects correct status for rel03.0-uc002 and rel03.0-uc003 (done)\n3. Verify Test Suite Index includes test-rel03.0-uc002 and test-rel03.0-uc003\n4. Update PRD-to-Use-Case Mapping for prd007 and prd008\n5. Update Traceability Diagram to include rel03.0-uc002 and rel03.0-uc003\n6. Check Coverage Gaps section (should be empty if all use cases have test suites)\n\n## Design Decisions\n- Follow specification-format rule for structure and tables\n- Read all files in docs/specs/* to build accurate tables\n- Use PlantUML inline format for Traceability Diagram\n- Verify all links are relative paths from docs/\n\n## Acceptance Criteria\n- [ ] Roadmap Summary shows release 03.0 as 4/4 use cases done\n- [ ] Use Case Index shows rel03.0-uc002 and rel03.0-uc003 as done\n- [ ] Test Suite Index includes test-rel03.0-uc002 and test-rel03.0-uc003 with correct trace references\n- [ ] PRD-to-Use-Case Mapping includes prd007→rel03.0-uc002 and prd008→rel03.0-uc003\n- [ ] Traceability Diagram shows all PRDs, use cases, and test suites in release 03.0\n- [ ] Coverage Gaps section is empty or lists only unscheduled use cases\n- [ ] File follows specification-format rule (all required sections present)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:50:43.202012-05:00","created_by":"petardjukic","updated_at":"2026-02-13T02:12:28.555572-05:00","closed_at":"2026-02-13T02:12:28.555572-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-xgh","depends_on_id":"generation-2026-02-13-07-56-44-kik","type":"blocks","created_at":"2026-02-13T01:50:44.265032-05:00","created_by":"petardjukic"}],"comments":[{"id":151,"issue_id":"generation-2026-02-13-07-56-44-xgh","author":"petardjukic","text":"duration: 1m16s | tokens: in=29 out=3172 | loc: +3 -3 files=2","created_at":"2026-02-13T07:12:28Z"}]}
{"id":"generation-2026-02-13-07-56-44-xka","title":"Create make-work.sh script for issue creation (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (F6 make-work.sh script)\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (make-work test cases)\n- .claude/rules/crumb-format.md (issue format)\n- scripts/do-work.sh (workflow script reference)\n\n## Files to Create/Modify\n- scripts/make-work.sh (create) — issue creation script\n\n## Requirements\n- Accept JSON file path as argument containing proposed issues\n- Read JSON file with array of issue objects (index, title, description, dependency)\n- For each issue, create crumb via `cupboard create --type task --title \"...\" --description \"...\"`\n- Parse JSON output to get created crumb ID\n- Store mapping of index to crumb ID for dependency resolution\n- If issue has dependency (dependency != -1), create child_of link\n- List existing issues: `cupboard list --json`\n- Display summary of created issues\n- Commit JSONL changes to git per eng01-git-integration\n- Exit 0 on success\n\n## Design Decisions\n- Script uses cupboard CLI commands via --json flag\n- Dependencies reference by index in input JSON, resolved to IDs\n- child_of links created via cupboard commands (or direct table access)\n- Script validates input JSON before processing\n- Dry-run mode supported with --dry-run flag\n\n## Acceptance Criteria\n- [ ] Script reads JSON file with proposed issues\n- [ ] Script creates crumbs via cupboard create for each issue\n- [ ] Script resolves dependencies and creates child_of links\n- [ ] Script lists created issues with IDs\n- [ ] Script commits JSONL files to git\n- [ ] Script validates JSON structure before processing\n- [ ] Script supports --dry-run mode\n- [ ] Script exits 0 on success, non-zero on error","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T22:15:46.824966-05:00","created_by":"petardjukic","updated_at":"2026-02-13T00:43:38.052841-05:00","closed_at":"2026-02-13T00:43:38.052841-05:00","close_reason":"Closed","comments":[{"id":152,"issue_id":"generation-2026-02-13-07-56-44-xka","author":"petardjukic","text":"duration: 4m9s | tokens: in=50 out=12144 | loc: +434 -1 files=2","created_at":"2026-02-13T05:43:37Z"}]}
{"id":"generation-2026-02-13-07-56-44-xxi","title":"Integration tests for SQLite backend: Cupboard lifecycle and crumbs CRUD","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.0-uc001-cupboard-lifecycle.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc002-table-crud.yaml (all test cases)\n- docs/specs/test-suites/test-rel01.0-uc003-crumb-lifecycle.yaml (all test cases)\n- internal/sqlite/backend.go (SQLiteBackend)\n- internal/sqlite/crumbs_table.go (crumbsTable)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc001_cupboard_lifecycle_test.go (create) - Table-driven tests: Attach with valid config, Attach with invalid config, Detach idempotent, GetTable for all standard names, GetTable for unknown name, operations after Detach return ErrCupboardDetached\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (create) - Table-driven tests: Set creates crumb with UUID v7, Get retrieves by ID, Get returns ErrNotFound, Delete removes crumb, Delete cascades, Fetch with empty filter, Fetch with state filter, Fetch with limit/offset, JSONL persistence after Set/Delete\n- tests/integration/test_rel01_0_uc003_crumb_lifecycle_test.go (create) - Table-driven tests: create draft crumb, transition through states, Pebble from taken, Pebble from non-taken fails, Dust from any state, persist and reload state\n\n## Requirements\n- Use t.TempDir() for DataDir isolation\n- Each test creates a fresh SQLiteBackend, Attaches, runs test cases, Detaches\n- Verify JSONL files are written correctly (read back and parse)\n- Test JSONL roundtrip: Attach, write data, Detach, delete cupboard.db, re-Attach, verify data loaded from JSONL\n- Use testify for assertions\n\n## Design Decisions\n- Integration tests in tests/integration/ per project layout\n- Each test suite file maps to one use case YAML\n- Table-driven tests with shared setup/teardown\n\n## Acceptance Criteria\n- [ ] Cupboard lifecycle tests cover attach/detach/error paths\n- [ ] CRUD tests cover all Table operations\n- [ ] Crumb lifecycle tests cover state machine\n- [ ] JSONL roundtrip test verifies data survives db deletion\n- [ ] All tests pass: go test ./tests/integration/...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T07:18:36.681468-05:00","created_by":"petardjukic","updated_at":"2026-02-12T07:56:58.226051-05:00","closed_at":"2026-02-12T07:56:58.226051-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-xxi","depends_on_id":"generation-2026-02-13-07-56-44-6dx","type":"blocks","created_at":"2026-02-12T07:18:37.614696-05:00","created_by":"petardjukic"}]}
{"id":"generation-2026-02-13-07-56-44-yj0","title":"Implement Backend startup sequence (JSONL load, schema seed, table wiring)","description":"## Required Reading\n- docs/specs/product-requirements/prd002-sqlite-backend.yaml (R3 startup sequence, R11-R14 built-in properties)\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R4 built-in properties: priority, type, description, owner, labels)\n- docs/specs/use-cases/rel01.0-uc001-cupboard-lifecycle.yaml (Attach flow)\n- internal/sqlite/backend.go (Backend from task 4)\n- internal/sqlite/jsonl.go (JSONL from task 5)\n- internal/sqlite/table_crumb.go (CrumbTable from task 6)\n\n## Files to Create/Modify\n- internal/sqlite/backend.go (modify) - Wire table accessors, implement full Attach startup sequence\n- internal/sqlite/seed.go (create) - Built-in property definitions and seeding logic\n\n## Requirements\n- Attach startup sequence per prd002 R3: (1) create DataDir if not exists, (2) create empty JSONL files if not exist, (3) delete cupboard.db if exists, (4) create fresh cupboard.db with schema, (5) load each JSONL file into SQLite, (6) seed built-in properties if properties.jsonl is empty.\n- Built-in properties per prd004 R4: priority (categorical: highest/high/medium/low/lowest), type (categorical: task/epic/bug/chore), description (text), owner (text), labels (list).\n- Wire GetTable to return CrumbTable for \"crumbs\" table name (other tables remain ErrTableNotFound for now).\n- JSONL loading: for each JSONL file, read all records, insert into corresponding SQLite table.\n- Track attached state: Attach sets attached=true, Detach sets attached=false.\n\n## Design Decisions\n- Seeding only happens when properties.jsonl is empty (first run)\n- Seed writes both to SQLite and JSONL (via SyncManager)\n- GetTable uses a map[string]Table initialized during Attach\n- Backend.Attach is not safe for concurrent calls (caller responsibility)\n\n## Acceptance Criteria\n- [ ] Attach creates DataDir, JSONL files, DB, schema in correct order\n- [ ] JSONL files loaded into SQLite on startup\n- [ ] Built-in properties seeded on first run (empty properties.jsonl)\n- [ ] GetTable(\"crumbs\") returns working CrumbTable\n- [ ] GetTable for unknown name returns ErrTableNotFound\n- [ ] Detach closes DB and deletes cupboard.db\n- [ ] Copyright header present\n- [ ] go build ./internal/sqlite succeeds","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T08:02:21.202692-05:00","created_by":"petardjukic","updated_at":"2026-02-13T08:25:19.03437-05:00","closed_at":"2026-02-13T08:25:19.03437-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-yj0","depends_on_id":"generation-2026-02-13-07-56-44-4ie","type":"blocks","created_at":"2026-02-13T08:02:22.192884-05:00","created_by":"petardjukic"}],"comments":[{"id":8,"issue_id":"generation-2026-02-13-07-56-44-yj0","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T12:56:53Z\",\"duration_s\":326,\"tokens\":{\"input\":17,\"output\":10656},\"loc_before\":{\"production\":14,\"test\":0},\"loc_after\":{\"production\":14,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T13:02:23Z"},{"id":18,"issue_id":"generation-2026-02-13-07-56-44-yj0","author":"petardjukic","text":"{\"caller\":\"stitch\",\"started_at\":\"2026-02-13T13:20:01Z\",\"duration_s\":318,\"tokens\":{\"input\":33,\"output\":20750},\"loc_before\":{\"production\":1920,\"test\":0},\"loc_after\":{\"production\":2435,\"test\":0},\"diff\":{\"files\":3,\"insertions\":537,\"deletions\":22}}","created_at":"2026-02-13T13:25:18Z"}]}
{"id":"generation-2026-02-13-07-56-44-yzx","title":"Implement property backfill on property definition","description":"## Required Reading\n- docs/specs/product-requirements/prd004-properties-interface.yaml (R5 backfill)\n- docs/specs/use-cases/rel02.0-uc001-property-enforcement.yaml (S7-S9 backfill)\n- docs/specs/test-suites/test-rel02.0-uc001-property-enforcement.yaml (test cases 7-9)\n- internal/sqlite/properties_table.go (Set method)\n- internal/sqlite/crumbs_table.go (Fetch for all crumbs)\n\n## Files to Create/Modify\n- internal/sqlite/properties_table.go (modify) — add backfill logic in Set when creating new property\n- internal/sqlite/properties_table_test.go (modify or create) — tests for backfill\n\n## Requirements\n- When Table.Set creates a new property (empty ID), backfill all existing crumbs with the property's type default\n- Insert crumb_properties row for each existing crumb that lacks a value for this property\n- Backfill must be atomic (within same transaction as property creation)\n- Backfill must not override existing values if a crumb already has this property\n\n## Design Decisions\n- Backfill runs inside the property Set transaction\n- Use INSERT OR IGNORE to avoid overriding existing crumb_properties rows\n- Fetch all crumb IDs and batch-insert crumb_properties in one SQL statement\n\n## Acceptance Criteria\n- [ ] Defining a new property backfills all existing crumbs with type default\n- [ ] Existing property values are not overridden during backfill\n- [ ] Backfill is atomic with property creation\n- [ ] Unit tests verify backfill with multiple existing crumbs\n- [ ] Unit tests verify no override of existing values","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T14:57:06.671983-05:00","created_by":"petardjukic","updated_at":"2026-02-12T23:02:25.258436-05:00","closed_at":"2026-02-12T23:02:25.258436-05:00","close_reason":"Closed","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-yzx","depends_on_id":"generation-2026-02-13-07-56-44-bpu","type":"blocks","created_at":"2026-02-12T14:57:07.780688-05:00","created_by":"petardjukic"}],"comments":[{"id":153,"issue_id":"generation-2026-02-13-07-56-44-yzx","author":"petardjukic","text":"duration: 2m15s | tokens: in=46 out=4419 | loc: +92 -1 files=2","created_at":"2026-02-13T04:02:25Z"}]}
{"id":"generation-2026-02-13-07-56-44-z0q","title":"Add crumbs table benchmark tests (rel01.0-uc005)","description":"## Required Reading\n- docs/specs/use-cases/rel01.0-uc005-crumbs-table-benchmarks.yaml (S1-S10 success criteria)\n- docs/specs/test-suites/test-rel01.0-uc005-crumbs-table-benchmarks.yaml (16 test cases)\n- internal/sqlite/crumbs_table.go (Get, Set, Delete, Fetch implementations)\n- internal/sqlite/backend.go (Attach for setup)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (test patterns)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_0_uc005_crumbs_table_benchmarks_test.go (create)\n- docs/road-map.yaml (modify) — mark rel01.0-uc005 as done\n\n## Requirements\n- Benchmark Get at 4 scales: 10, 100, 1000, 10000 crumbs (S5)\n- Benchmark Set create at 2 scales: 10, 1000 existing crumbs (S6)\n- Benchmark Set update at 2 scales: 10, 1000 crumbs (S7)\n- Benchmark Delete at 2 scales: 10, 1000 crumbs (S8)\n- Benchmark Fetch all at 2 scales: 100, 1000 crumbs (S9)\n- Benchmark Fetch with state filter at 2 scales: 100, 1000 crumbs (S10)\n- Each benchmark reports ns/op, B/op, allocs/op (S1-S4)\n\n## Design Decisions\n- Use Go benchmark framework (testing.B) with -benchmem\n- Use StopTimer/StartTimer for Delete to exclude setup cost\n- Random ID selection for Get/Update benchmarks\n- Each benchmark function creates a fresh cupboard with temp directory\n\n## Acceptance Criteria\n- [ ] 16 benchmark functions covering all operations and scales\n- [ ] Benchmarks run with go test ./tests/integration/... -bench=BenchmarkCrumbs -benchmem\n- [ ] road-map.yaml updated to mark rel01.0-uc005 as done","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-12T17:46:31.968722-05:00","created_by":"petardjukic","updated_at":"2026-02-12T18:04:53.362107-05:00","closed_at":"2026-02-12T18:04:53.362107-05:00","close_reason":"Closed"}
{"id":"generation-2026-02-13-07-56-44-z5j","title":"Implement integration tests for rel03.0-uc001-trail-exploration","description":"## Required Reading\n- docs/specs/use-cases/rel03.0-uc001-trail-exploration.yaml (use case definition)\n- docs/specs/test-suites/test-rel03.0-uc001-trail-exploration.yaml (test cases to implement)\n- docs/specs/product-requirements/prd006-trails-interface.yaml (Trail entity contract)\n- docs/specs/product-requirements/prd007-links-interface.yaml (links semantics)\n- pkg/types/trail.go (Trail entity and Complete/Abandon methods)\n- internal/sqlite/trails_table.go (cascade implementation)\n- tests/integration/test_rel01_0_uc002_table_crud_test.go (table-driven test pattern example)\n\n## Files to Create/Modify\n- tests/integration/test_rel03_0_uc001_trail_exploration_test.go (create)\n\n## Requirements\nImplement the 26 test cases from test-rel03.0-uc001-trail-exploration.yaml that validate:\n- Trail creation via Table.Set starts in draft state by default (TC01)\n- Trail state transitions from draft to active (TC02)\n- belongs_to links associate crumbs with trails (TC03-TC05)\n- Querying links table returns crumbs on that trail (TC06-TC07)\n- Deleting belongs_to link disassociates without deleting the crumb (TC08-TC10)\n- Trail.Abandon() then Table.Set deletes trail crumbs atomically (TC11-TC16)\n- Crumbs removed from trail before abandon survive (TC17-TC18)\n- Trail.Complete() then Table.Set removes belongs_to links (TC19-TC21)\n- Completed trail crumbs remain queryable (TC22-TC23)\n- Trail state is completed or abandoned after respective operations (TC24-TC26)\n\n## Design Decisions\n- Use Go table-driven tests per test-case-format rule: one TestTrailExploration function with subtests for each YAML test case\n- Each test case row has: name, setup (trail/crumb creation), operation (Complete/Abandon/query), and assertions\n- Share cupboard setup across test cases: create fresh temp dir, attach backend, get tables\n- Use testify/assert for assertions to match existing tests\n- Follow the pattern from test_rel01_0_uc002_table_crud_test.go for table-driven structure\n\n## Acceptance Criteria\n- [ ] All 26 test cases from test-rel03.0-uc001-trail-exploration.yaml implemented\n- [ ] Table-driven test structure with one row per test case\n- [ ] Tests pass: go test -v ./tests/integration -run TestTrailExploration\n- [ ] Test file saved as test_rel03_0_uc001_trail_exploration_test.go\n- [ ] Assertions verify success criteria S1-S10 from use case","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T01:09:06.92422-05:00","created_by":"petardjukic","updated_at":"2026-02-13T01:15:05.124872-05:00","closed_at":"2026-02-13T01:15:05.124872-05:00","close_reason":"Closed","comments":[{"id":154,"issue_id":"generation-2026-02-13-07-56-44-z5j","author":"petardjukic","text":"duration: 5m56s | tokens: in=38 out=24609 | loc: +1387 -1 files=2","created_at":"2026-02-13T06:15:05Z"}]}
{"id":"generation-2026-02-13-07-56-44-zbn","title":"Add integration test for go install (rel01.1-uc001)","description":"## Required Reading\n- docs/specs/test-suites/test-rel01.1-uc001-go-install.yaml (test cases)\n- docs/specs/use-cases/rel01.1-uc001-go-install.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel01_1_uc001_go_install_test.go (create)\n\n## Requirements\n- Test: `go build ./cmd/cupboard` succeeds\n- Test: built binary runs `cupboard version` and prints version string\n- Test: built binary runs `cupboard init` and creates config directory\n- Test: binary exit code 0 for valid commands, non-zero for invalid\n\n## Design Decisions\n- Use os/exec to build and run binary\n- Skip `go install` in CI (needs GOPATH); test `go build` instead\n\n## Acceptance Criteria\n- [ ] Binary builds successfully\n- [ ] Version command works\n- [ ] Init command creates config\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:41.894299-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:41.894299-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-zbn","depends_on_id":"generation-2026-02-13-07-56-44-i61","type":"blocks","created_at":"2026-02-13T13:54:45.366682-05:00","created_by":"petardjukic"}],"comments":[{"id":71,"issue_id":"generation-2026-02-13-07-56-44-zbn","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:49Z"}]}
{"id":"generation-2026-02-13-07-56-44-zvo","title":"Add integration tests for self-hosting (rel02.1-uc003)","description":"## Required Reading\n- docs/specs/test-suites/test-rel02.1-uc003-self-hosting.yaml (test cases)\n- docs/specs/use-cases/rel02.1-uc003-self-hosting.yaml (use case flow)\n- tests/integration/testutil_test.go (CLI test harness)\n\n## Files to Create/Modify\n- tests/integration/test_rel02_1_uc003_self_hosting_test.go (create)\n\n## Requirements\n- Test: full issue-tracking workflow simulating self-hosting\n  - Create tasks for crumbs development\n  - Set priorities and labels\n  - Transition through states (draft→ready→taken→pebble)\n  - Add comments with token counts\n  - Close completed tasks\n  - Verify final state\n\n## Design Decisions\n- End-to-end CLI test simulating real usage\n- Use issue-tracking commands (create, ready, update, comments add, close)\n\n## Acceptance Criteria\n- [ ] Full self-hosting workflow executes without errors\n- [ ] State transitions correct\n- [ ] Comments persisted\n- [ ] Tests pass with `go test ./tests/integration/...`","status":"open","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-13T13:54:42.152399-05:00","created_by":"petardjukic","updated_at":"2026-02-13T13:54:42.152399-05:00","dependencies":[{"issue_id":"generation-2026-02-13-07-56-44-zvo","depends_on_id":"generation-2026-02-13-07-56-44-e08","type":"blocks","created_at":"2026-02-13T13:54:45.561551-05:00","created_by":"petardjukic"}],"comments":[{"id":73,"issue_id":"generation-2026-02-13-07-56-44-zvo","author":"petardjukic","text":"{\"caller\":\"measure\",\"started_at\":\"2026-02-13T18:43:02Z\",\"duration_s\":694,\"tokens\":{\"input\":13,\"output\":18913},\"loc_before\":{\"production\":6072,\"test\":0},\"loc_after\":{\"production\":6072,\"test\":0},\"diff\":{\"files\":0,\"insertions\":0,\"deletions\":0}}","created_at":"2026-02-13T18:54:50Z"}]}
